2026-01-16 13:08:06,391 - shipping_chatbot - INFO - User_Query: What is starlink, consignee_code: ['0000866']
2026-01-16 14:35:40,799 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-16 14:35:40,799 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-16 14:35:40,799 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-16 14:36:39,146 - shipping_chatbot - INFO - User_Query: What is starlink, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-16 14:36:39,147 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-16 14:36:53,570 - shipping_chatbot - INFO - Fetched 19279 rows
2026-01-16 14:36:53,572 - shipping_chatbot - INFO - Starting preprocessing on 19279 rows
2026-01-16 14:36:53,658 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-16 14:36:54,200 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-16 14:36:54,350 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-16 14:36:54,886 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-16 14:36:54,890 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-16 14:36:54,890 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-16 14:36:54,917 - shipping_chatbot - INFO - Pre-processing finished - 19279 rows remain
2026-01-16 14:37:02,503 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Handle Non-shipping queries | Tool Input: {'query': 'What is Starlink?'}
2026-01-16 14:43:13,385 - shipping_chatbot - INFO - User_Query: and mcs, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-16 14:43:21,725 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Handle Non-shipping queries | Tool Input: {'query': 'What is MCS?'}
2026-01-16 14:43:58,998 - shipping_chatbot - INFO - User_Query: Can you quickly share its website, please, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-16 14:44:05,268 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Handle Non-shipping queries | Tool Input: {'query': 'What is the website of MOL Consolidation Service (MCS)?'}
2026-01-16 14:44:54,340 - shipping_chatbot - INFO - User_Query: what is there business offerings, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-16 14:45:07,030 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Handle Non-shipping queries | Tool Input: {'query': 'What are the business offerings of MOL Consolidation Service (MCS)?'}
2026-01-16 14:49:24,646 - shipping_chatbot - INFO - User_Query: What is status of 5302997239?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-16 14:49:26,994 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302997239
2026-01-16 14:49:27,041 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-16 14:49:27,050 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Get Container Milestones | Tool Input: PO 5302997239
2026-01-16 14:50:03,878 - shipping_chatbot - INFO - User_Query: What is status of the PO 5302850125?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-16 14:50:06,195 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302850125
2026-01-16 14:50:06,240 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 4 rows found
2026-01-16 14:50:06,246 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Get Container Milestones | Tool Input: PO 5302850125
2026-01-16 14:50:32,278 - shipping_chatbot - INFO - User_Query: What are the POs in the container TCLU4703170?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-16 14:50:34,655 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Get Container Milestones | Tool Input: container TCLU4703170
2026-01-16 14:51:24,831 - shipping_chatbot - INFO - User_Query: What is the container carrying the PO 5302997239?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-16 14:51:27,166 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302997239
2026-01-16 14:51:27,217 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-16 14:51:27,224 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Get Container Milestones | Tool Input: PO 5302997239
2026-01-16 14:52:15,978 - shipping_chatbot - INFO - User_Query: What are the POs arriving in Los Angeles?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-16 14:52:19,575 - shipping_chatbot - INFO - Analyst Engine processing query: filter rows where hot_container_flag is TRUE and (discharge_port or vehicle_arrival_lcn) contains (USLAX) and ata_dp is not null; select distinct po_number_multiple
2026-01-16 14:52:23,847 - shipping_chatbot - INFO - ========================================
2026-01-16 14:52:23,847 - shipping_chatbot - INFO - ANALYST ENGINE DEBUG MODE
2026-01-16 14:52:23,847 - shipping_chatbot - INFO - QUERY: filter rows where hot_container_flag is TRUE and (discharge_port or vehicle_arrival_lcn) contains (USLAX) and ata_dp is not null; select distinct po_number_multiple
2026-01-16 14:52:23,847 - shipping_chatbot - INFO - GENERATED CODE:
# Normalize hot_container_flag to boolean True
hot_flags = ['TRUE', 'Y', 'YES', 1, True]
mask_hot = df['hot_container_flag'].fillna('').astype(str).str.upper().isin([str(x).upper() for x in hot_flags])

# Filter rows where discharge_port or vehicle_arrival_lcn contains 'USLAX'
mask_port = df['discharge_port'].fillna('').str.contains('USLAX', na=False) | df['vehicle_arrival_lcn'].fillna('').str.contains('USLAX', na=False)

# Filter rows where ata_dp is not null
mask_ata = df['ata_dp'].notna()

# Apply all filters
filtered_df = df[mask_hot & mask_port & mask_ata]

# Select distinct po_number_multiple values
distinct_pos = filtered_df['po_number_multiple'].dropna().unique()

# Format result as a comma-separated string of POs
result = ', '.join(sorted(distinct_pos))
2026-01-16 14:52:23,847 - shipping_chatbot - INFO - ========================================
2026-01-16 14:52:23,865 - shipping_chatbot - INFO - ANALYST ENGINE SUCCESS: Result obtained (length: 17463)
2026-01-16 14:54:38,383 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: filter rows where hot_container_flag is TRUE and (discharge_port or vehicle_arrival_lcn) contains (USLAX) and ata_dp is not null; select distinct po_number_multiple
2026-01-16 14:56:21,135 - shipping_chatbot - INFO - User_Query: give for wilson sporting goods co only, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-16 14:56:24,711 - shipping_chatbot - INFO - Analyst Engine processing query: Filter data where hot_container_flag is TRUE and consignee_code_multiple contains '0009633' (Wilson Sporting Goods Co). Return distinct po_number_multiple values for containers arriving at Los Angeles (USLAX) with ata_dp NOT NULL.
2026-01-16 14:56:30,703 - shipping_chatbot - INFO - ========================================
2026-01-16 14:56:30,703 - shipping_chatbot - INFO - ANALYST ENGINE DEBUG MODE
2026-01-16 14:56:30,704 - shipping_chatbot - INFO - QUERY: Filter data where hot_container_flag is TRUE and consignee_code_multiple contains '0009633' (Wilson Sporting Goods Co). Return distinct po_number_multiple values for containers arriving at Los Angeles (USLAX) with ata_dp NOT NULL.
2026-01-16 14:56:30,704 - shipping_chatbot - INFO - GENERATED CODE:
# Normalize hot_container_flag to boolean True
hot_flags = ['TRUE', 'Y', 'YES', 1, True]
mask_hot = df['hot_container_flag'].astype(str).str.upper().isin([str(f).upper() for f in hot_flags])

# Filter for consignee_code_multiple containing '0009633'
mask_consignee = df['consignee_code_multiple'].str.contains('0009633', na=False)

# Filter for discharge_port containing 'USLAX'
mask_port = df['discharge_port'].str.contains('USLAX', na=False)

# Filter for ata_dp not null
mask_ata = df['ata_dp'].notna()

# Apply all filters
filtered_df = df[mask_hot & mask_consignee & mask_port & mask_ata]

# Extract distinct po_number_multiple values, split by comma, strip spaces, and get unique
po_series = filtered_df['po_number_multiple'].dropna().str.split(',')

# Flatten list of lists and strip spaces
po_list = [po.strip() for sublist in po_series for po in sublist]

# Get unique POs
unique_pos = sorted(set(po_list))

result = ', '.join(unique_pos)
2026-01-16 14:56:30,704 - shipping_chatbot - INFO - ========================================
2026-01-16 14:56:30,714 - shipping_chatbot - INFO - ANALYST ENGINE SUCCESS: Result obtained (length: 0)
2026-01-16 14:56:35,700 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: Filter data where hot_container_flag is TRUE and consignee_code_multiple contains '0009633' (Wilson Sporting Goods Co). Return distinct po_number_multiple values for containers arriving at Los Angeles (USLAX) with ata_dp NOT NULL.
2026-01-16 14:57:02,629 - shipping_chatbot - INFO - User_Query: give fro 00008666, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-16 14:58:05,515 - shipping_chatbot - INFO - User_Query: What are the POs arriving in Los Angeles?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-16 14:58:13,521 - shipping_chatbot - INFO - Analyst Engine processing query: List distinct po_number_multiple where hot_container_flag is TRUE and ata_dp is not null and (discharge_port like '%(USLAX)%' or vehicle_arrival_lcn like '%(USLAX)%') and consignee_code_multiple in ('0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392')
2026-01-16 14:58:22,308 - shipping_chatbot - INFO - ========================================
2026-01-16 14:58:22,309 - shipping_chatbot - INFO - ANALYST ENGINE DEBUG MODE
2026-01-16 14:58:22,309 - shipping_chatbot - INFO - QUERY: List distinct po_number_multiple where hot_container_flag is TRUE and ata_dp is not null and (discharge_port like '%(USLAX)%' or vehicle_arrival_lcn like '%(USLAX)%') and consignee_code_multiple in ('0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392')
2026-01-16 14:58:22,309 - shipping_chatbot - INFO - GENERATED CODE:
# Normalize hot_container_flag to boolean True
hot_flags = ['TRUE', 'Y', 'YES', 1, True]

# Filter conditions
mask_hot = df['hot_container_flag'].isin(hot_flags)
mask_ata = df['ata_dp'].notna()
mask_port = df['discharge_port'].str.contains(r'\(USLAX\)', na=False) | df['vehicle_arrival_lcn'].str.contains(r'\(USLAX\)', na=False)
authorized_consignees = ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
mask_consignee = df['consignee_code_multiple'].apply(lambda x: any(code in x.split(',') for code in authorized_consignees) if pd.notna(x) else False)

filtered_df = df[mask_hot & mask_ata & mask_port & mask_consignee]

# Extract distinct PO numbers from po_number_multiple (comma-separated)
# Split and explode to get distinct POs
po_series = filtered_df['po_number_multiple'].dropna().str.split(',').explode().str.strip().drop_duplicates()

result = ', '.join(po_series.tolist())
2026-01-16 14:58:22,309 - shipping_chatbot - INFO - ========================================
2026-01-16 14:58:22,318 - shipping_chatbot - ERROR - Analyst Engine failed: name 'pd' is not defined
Traceback (most recent call last):
  File "C:\Users\CHOWDHURYRaju\Desktop\roshan\StlnkWebNprdChatV2\agents\analytics_engine.py", line 113, in analyze
    exec(code, {}, local_vars)
  File "<string>", line 9, in <module>
  File "C:\Python311\Lib\site-packages\pandas\core\series.py", line 4935, in apply
    ).apply()
      ^^^^^^^
  File "C:\Python311\Lib\site-packages\pandas\core\apply.py", line 1422, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\site-packages\pandas\core\apply.py", line 1502, in apply_standard
    mapped = obj._map_values(
             ^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\site-packages\pandas\core\base.py", line 925, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\site-packages\pandas\core\algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2999, in pandas._libs.lib.map_infer
  File "<string>", line 9, in <lambda>
NameError: name 'pd' is not defined
2026-01-16 14:58:22,475 - shipping_chatbot - ERROR - FAILED CODE:
# Normalize hot_container_flag to boolean True
hot_flags = ['TRUE', 'Y', 'YES', 1, True]

# Filter conditions
mask_hot = df['hot_container_flag'].isin(hot_flags)
mask_ata = df['ata_dp'].notna()
mask_port = df['discharge_port'].str.contains(r'\(USLAX\)', na=False) | df['vehicle_arrival_lcn'].str.contains(r'\(USLAX\)', na=False)
authorized_consignees = ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
mask_consignee = df['consignee_code_multiple'].apply(lambda x: any(code in x.split(',') for code in authorized_consignees) if pd.notna(x) else False)

filtered_df = df[mask_hot & mask_ata & mask_port & mask_consignee]

# Extract distinct PO numbers from po_number_multiple (comma-separated)
# Split and explode to get distinct POs
po_series = filtered_df['po_number_multiple'].dropna().str.split(',').explode().str.strip().drop_duplicates()

result = ', '.join(po_series.tolist())
2026-01-16 14:58:35,100 - shipping_chatbot - INFO - Analyst Engine processing query: List distinct po_number_multiple where hot_container_flag in ('Y', 'YES', 'TRUE', '1', 'HOT') and ata_dp is not null and (discharge_port like '%(USLAX)%' or vehicle_arrival_lcn like '%(USLAX)%') and consignee_code_multiple in ('0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392')
2026-01-16 14:58:45,681 - shipping_chatbot - INFO - ========================================
2026-01-16 14:58:45,682 - shipping_chatbot - INFO - ANALYST ENGINE DEBUG MODE
2026-01-16 14:58:45,682 - shipping_chatbot - INFO - QUERY: List distinct po_number_multiple where hot_container_flag in ('Y', 'YES', 'TRUE', '1', 'HOT') and ata_dp is not null and (discharge_port like '%(USLAX)%' or vehicle_arrival_lcn like '%(USLAX)%') and consignee_code_multiple in ('0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392')
2026-01-16 14:58:45,683 - shipping_chatbot - INFO - GENERATED CODE:
# Normalize hot_container_flag values to uppercase string for consistent filtering
hot_flags = {'Y', 'YES', 'TRUE', '1', 'HOT'}

# Filter for authorized consignee codes
authorized_consignees = {
    '0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569',
    '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052',
    '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360',
    '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453',
    '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359',
    '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'
}

# Create a mask for hot_container_flag
hot_mask = df['hot_container_flag'].astype(str).str.upper().isin(hot_flags)

# Create a mask for ata_dp not null
ata_mask = df['ata_dp'].notna()

# Create a mask for discharge_port or vehicle_arrival_lcn containing '(USLAX)'
port_mask = (
    df['discharge_port'].str.contains(r'\(USLAX\)', na=False) |
    df['vehicle_arrival_lcn'].str.contains(r'\(USLAX\)', na=False)
)

# Create a mask for authorized consignee codes in consignee_code_multiple (comma-separated)
# We check if any authorized code is contained in the string
consignee_mask = df['consignee_code_multiple'].apply(
    lambda x: any(code in str(x).split(',') for code in authorized_consignees)
)

# Combine all masks
final_mask = hot_mask & ata_mask & port_mask & consignee_mask

# Filter dataframe
filtered_df = df.loc[final_mask, 'po_number_multiple'].dropna().unique()

# Convert numpy array to sorted list and join by comma
po_list = sorted(filtered_df)
result = ', '.join(po_list)
2026-01-16 14:58:45,684 - shipping_chatbot - INFO - ========================================
2026-01-16 14:58:45,693 - shipping_chatbot - ERROR - Analyst Engine failed: name 'authorized_consignees' is not defined
Traceback (most recent call last):
  File "C:\Users\CHOWDHURYRaju\Desktop\roshan\StlnkWebNprdChatV2\agents\analytics_engine.py", line 113, in analyze
    exec(code, {}, local_vars)
  File "<string>", line 28, in <module>
  File "C:\Python311\Lib\site-packages\pandas\core\series.py", line 4935, in apply
    ).apply()
      ^^^^^^^
  File "C:\Python311\Lib\site-packages\pandas\core\apply.py", line 1422, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\site-packages\pandas\core\apply.py", line 1502, in apply_standard
    mapped = obj._map_values(
             ^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\site-packages\pandas\core\base.py", line 925, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\site-packages\pandas\core\algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2999, in pandas._libs.lib.map_infer
  File "<string>", line 29, in <lambda>
NameError: name 'authorized_consignees' is not defined
2026-01-16 14:58:45,693 - shipping_chatbot - ERROR - FAILED CODE:
# Normalize hot_container_flag values to uppercase string for consistent filtering
hot_flags = {'Y', 'YES', 'TRUE', '1', 'HOT'}

# Filter for authorized consignee codes
authorized_consignees = {
    '0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569',
    '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052',
    '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360',
    '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453',
    '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359',
    '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'
}

# Create a mask for hot_container_flag
hot_mask = df['hot_container_flag'].astype(str).str.upper().isin(hot_flags)

# Create a mask for ata_dp not null
ata_mask = df['ata_dp'].notna()

# Create a mask for discharge_port or vehicle_arrival_lcn containing '(USLAX)'
port_mask = (
    df['discharge_port'].str.contains(r'\(USLAX\)', na=False) |
    df['vehicle_arrival_lcn'].str.contains(r'\(USLAX\)', na=False)
)

# Create a mask for authorized consignee codes in consignee_code_multiple (comma-separated)
# We check if any authorized code is contained in the string
consignee_mask = df['consignee_code_multiple'].apply(
    lambda x: any(code in str(x).split(',') for code in authorized_consignees)
)

# Combine all masks
final_mask = hot_mask & ata_mask & port_mask & consignee_mask

# Filter dataframe
filtered_df = df.loc[final_mask, 'po_number_multiple'].dropna().unique()

# Convert numpy array to sorted list and join by comma
po_list = sorted(filtered_df)
result = ', '.join(po_list)
2026-01-16 14:58:52,843 - shipping_chatbot - INFO - Analyst Engine processing query: List distinct po_number_multiple where hot_container_flag in ('Y', 'YES', 'TRUE', '1', 'HOT') and ata_dp is not null and (discharge_port like '%(USLAX)%' or vehicle_arrival_lcn like '%(USLAX)%') and consignee_code_multiple in ('0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392')
2026-01-16 14:59:02,057 - shipping_chatbot - INFO - ========================================
2026-01-16 14:59:02,059 - shipping_chatbot - INFO - ANALYST ENGINE DEBUG MODE
2026-01-16 14:59:02,060 - shipping_chatbot - INFO - QUERY: List distinct po_number_multiple where hot_container_flag in ('Y', 'YES', 'TRUE', '1', 'HOT') and ata_dp is not null and (discharge_port like '%(USLAX)%' or vehicle_arrival_lcn like '%(USLAX)%') and consignee_code_multiple in ('0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392')
2026-01-16 14:59:02,060 - shipping_chatbot - INFO - GENERATED CODE:
# Normalize hot_container_flag to uppercase string for consistent filtering
hot_flags = {'Y', 'YES', 'TRUE', '1', 'HOT'}

# Filter for authorized consignee codes
authorized_consignees = {
    '0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569',
    '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052',
    '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360',
    '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453',
    '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359',
    '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'
}

# Create a mask for hot_container_flag
hot_mask = df['hot_container_flag'].astype(str).str.upper().isin(hot_flags)

# Create a mask for ata_dp not null
ata_mask = df['ata_dp'].notna()

# Create a mask for discharge_port or vehicle_arrival_lcn containing (USLAX)
port_mask = (
    df['discharge_port'].str.contains(r'\(USLAX\)', na=False) |
    df['vehicle_arrival_lcn'].str.contains(r'\(USLAX\)', na=False)
)

# Create a mask for authorized consignee codes in consignee_code_multiple
# Since consignee_code_multiple is multiple codes comma separated, use str.contains for each authorized code
# But to optimize, create a regex pattern joining all authorized codes separated by '|'
import re
pattern = '|'.join(authorized_consignees)
consignee_mask = df['consignee_code_multiple'].str.contains(pattern, na=False)

# Combine all masks
final_mask = hot_mask & ata_mask & port_mask & consignee_mask

# Filter dataframe
filtered_df = df.loc[final_mask, 'po_number_multiple']

# Extract distinct PO numbers from the comma-separated strings
# Split by comma, strip spaces, flatten and get unique
po_series = filtered_df.dropna().str.split(',').explode().str.strip().drop_duplicates()

# Convert to list and join by comma for readable output
result = ', '.join(po_series.tolist())
2026-01-16 14:59:02,062 - shipping_chatbot - INFO - ========================================
2026-01-16 14:59:02,119 - shipping_chatbot - INFO - ANALYST ENGINE SUCCESS: Result obtained (length: 17062)
2026-01-16 15:01:03,862 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: List distinct po_number_multiple where hot_container_flag is TRUE and ata_dp is not null and (discharge_port like '%(USLAX)%' or vehicle_arrival_lcn like '%(USLAX)%') and consignee_code_multiple in ('0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392')
2026-01-16 15:01:03,862 - shipping_chatbot - INFO - AGENT_STEP: 2 | Tool Used: _Exception | Tool Input: Invalid or incomplete response
2026-01-16 15:01:03,862 - shipping_chatbot - INFO - AGENT_STEP: 3 | Tool Used: Analyze Data with Pandas | Tool Input: List distinct po_number_multiple where hot_container_flag in ('Y', 'YES', 'TRUE', '1', 'HOT') and ata_dp is not null and (discharge_port like '%(USLAX)%' or vehicle_arrival_lcn like '%(USLAX)%') and consignee_code_multiple in ('0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392')
2026-01-16 15:01:03,862 - shipping_chatbot - INFO - AGENT_STEP: 4 | Tool Used: Analyze Data with Pandas | Tool Input: List distinct po_number_multiple where hot_container_flag in ('Y', 'YES', 'TRUE', '1', 'HOT') and ata_dp is not null and (discharge_port like '%(USLAX)%' or vehicle_arrival_lcn like '%(USLAX)%') and consignee_code_multiple in ('0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392')
2026-01-16 15:10:48,628 - shipping_chatbot - INFO - User_Query: Please provide the shipment status of 5302970007, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-16 15:10:51,504 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302970007
2026-01-16 15:10:51,548 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-16 15:10:51,554 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Get Container Milestones | Tool Input: PO 5302970007
2026-01-16 15:11:10,119 - shipping_chatbot - INFO - User_Query: List out any delay shipments in Augest, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-16 15:11:13,611 - shipping_chatbot - INFO - Analyst Engine processing query: Find shipments with hot_container_flag TRUE, ata_dp NOT NULL, delay_days > 0, and ata_dp in August 2025.
2026-01-16 15:11:21,284 - shipping_chatbot - INFO - ========================================
2026-01-16 15:11:21,284 - shipping_chatbot - INFO - ANALYST ENGINE DEBUG MODE
2026-01-16 15:11:21,285 - shipping_chatbot - INFO - QUERY: Find shipments with hot_container_flag TRUE, ata_dp NOT NULL, delay_days > 0, and ata_dp in August 2025.
2026-01-16 15:11:21,285 - shipping_chatbot - INFO - GENERATED CODE:
# Filter for hot containers
hot_flags = ['TRUE', 'Y', 'YES', 1, True]
df['hot_flag_bool'] = df['hot_container_flag'].astype(str).str.upper().isin(['TRUE', 'Y', 'YES']) | (df['hot_container_flag'] == 1) | (df['hot_container_flag'] == True)

# Convert ata_dp to datetime if not already
df['ata_dp'] = pd.to_datetime(df['ata_dp'], errors='coerce')

# Define August 2025 date range
start_date = pd.Timestamp('2025-08-01')
end_date = pd.Timestamp('2025-08-31')

# Filter conditions
cond = (
    df['hot_flag_bool'] &
    df['ata_dp'].notna() &
    (df['delay_days'] > 0) &
    (df['ata_dp'] >= start_date) &
    (df['ata_dp'] <= end_date)
)

# Select relevant columns for output
filtered = df.loc[cond, ['container_number', 'po_number_multiple', 'ata_dp', 'delay_days']]

# Format result as readable string list
if filtered.empty:
    result = "No shipments found with hot_container_flag TRUE, ata_dp in August 2025, and delay_days > 0."
else:
    lines = []
    for _, row in filtered.iterrows():
        lines.append(f"Container: {row['container_number']}, POs: {row['po_number_multiple']}, Arrival: {row['ata_dp'].date()}, Delay Days: {row['delay_days']}")
    result = "\n".join(lines)
2026-01-16 15:11:21,285 - shipping_chatbot - INFO - ========================================
2026-01-16 15:11:21,304 - shipping_chatbot - INFO - ANALYST ENGINE SUCCESS: Result obtained (length: 3757)
2026-01-16 15:11:49,836 - shipping_chatbot - ERROR - Agent failed: 2 validation errors for AIMessage
content
  str type expected (type=type_error.str)
content
  value is not a valid list (type=type_error.list)
Traceback (most recent call last):
  File "C:\Users\CHOWDHURYRaju\Desktop\roshan\StlnkWebNprdChatV2\api\main.py", line 212, in ask
    SESSION_HISTORY[session_id].add_ai_message(result.get("output", ""))
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\chat_history.py", line 139, in add_ai_message
    self.add_message(AIMessage(content=message))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\messages\base.py", line 47, in __init__
    return super().__init__(content=content, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\pydantic\v1\main.py", line 347, in __init__
    raise validation_error
pydantic.v1.error_wrappers.ValidationError: 2 validation errors for AIMessage
content
  str type expected (type=type_error.str)
content
  value is not a valid list (type=type_error.list)
2026-01-16 15:11:49,896 - shipping_chatbot - INFO - Router: Set context (codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'], has_history: True) for query: List out any delay shipments in Augest
2026-01-16 15:11:49,960 - shipping_chatbot - INFO - Consignee filtering validated: 12915 rows for codes ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-20 12:20:19,375 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 12:20:19,378 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-20 12:20:19,378 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 12:22:12,331 - shipping_chatbot - INFO - User_Query: let me know vendor name for 5302842571, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-20 12:22:12,331 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-20 12:22:25,787 - shipping_chatbot - INFO - Fetched 18991 rows
2026-01-20 12:22:25,792 - shipping_chatbot - INFO - Starting preprocessing on 18991 rows
2026-01-20 12:22:26,005 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-20 12:22:27,238 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-20 12:22:27,631 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-20 12:22:28,529 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-20 12:22:28,531 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-20 12:22:28,536 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-20 12:22:28,657 - shipping_chatbot - INFO - Pre-processing finished - 18991 rows remain
2026-01-20 12:22:32,661 - shipping_chatbot - INFO - Analyst Engine processing query: select supplier_vendor_name from dataset where po_number_multiple like '%5302842571%' and hot_container_flag in ('Y', 'YES', 'TRUE', '1', 'HOT')
2026-01-20 12:22:35,660 - shipping_chatbot - INFO - ========================================
2026-01-20 12:22:35,661 - shipping_chatbot - INFO - ANALYST ENGINE DEBUG MODE
2026-01-20 12:22:35,661 - shipping_chatbot - INFO - QUERY: select supplier_vendor_name from dataset where po_number_multiple like '%5302842571%' and hot_container_flag in ('Y', 'YES', 'TRUE', '1', 'HOT')
2026-01-20 12:22:35,661 - shipping_chatbot - INFO - GENERATED CODE:
authorized_consignees = df['consignee_code_multiple'].dropna().unique().tolist()
hot_flags = ['Y', 'YES', 'TRUE', '1', 'HOT']

filtered_df = df[
    df['po_number_multiple'].str.contains('5302842571', na=False) &
    df['hot_container_flag'].astype(str).str.upper().isin(hot_flags) &
    df['consignee_code_multiple'].apply(lambda x: any(consignee in x for consignee in authorized_consignees) if pd.notna(x) else False)
]

result = filtered_df['supplier_vendor_name'].dropna().unique().tolist()
result = str(result)
2026-01-20 12:22:35,661 - shipping_chatbot - INFO - ========================================
2026-01-20 12:22:35,672 - shipping_chatbot - ERROR - Analyst Engine failed: name 'pd' is not defined
Traceback (most recent call last):
  File "C:\Users\CHOWDHURYRaju\Desktop\roshan\StlnkWebNprdChatV2\agents\analytics_engine.py", line 118, in analyze
    exec(code, {}, local_vars)
  File "<string>", line 7, in <module>
  File "C:\Python311\Lib\site-packages\pandas\core\series.py", line 4935, in apply
    ).apply()
      ^^^^^^^
  File "C:\Python311\Lib\site-packages\pandas\core\apply.py", line 1422, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\site-packages\pandas\core\apply.py", line 1502, in apply_standard
    mapped = obj._map_values(
             ^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\site-packages\pandas\core\base.py", line 925, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\site-packages\pandas\core\algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 2999, in pandas._libs.lib.map_infer
  File "<string>", line 7, in <lambda>
NameError: name 'pd' is not defined
2026-01-20 12:22:35,734 - shipping_chatbot - ERROR - FAILED CODE:
authorized_consignees = df['consignee_code_multiple'].dropna().unique().tolist()
hot_flags = ['Y', 'YES', 'TRUE', '1', 'HOT']

filtered_df = df[
    df['po_number_multiple'].str.contains('5302842571', na=False) &
    df['hot_container_flag'].astype(str).str.upper().isin(hot_flags) &
    df['consignee_code_multiple'].apply(lambda x: any(consignee in x for consignee in authorized_consignees) if pd.notna(x) else False)
]

result = filtered_df['supplier_vendor_name'].dropna().unique().tolist()
result = str(result)
2026-01-20 12:22:36,767 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302842571
2026-01-20 12:22:36,812 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-20 12:22:36,824 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: select supplier_vendor_name from dataset where po_number_multiple like '%5302842571%' and hot_container_flag in ('Y', 'YES', 'TRUE', '1', 'HOT')
2026-01-20 12:22:36,824 - shipping_chatbot - INFO - AGENT_STEP: 2 | Tool Used: Get Container Milestones | Tool Input: 5302842571
2026-01-20 13:02:50,546 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 13:02:50,546 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-20 13:02:50,546 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 14:14:24,677 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 14:14:24,679 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-20 14:14:24,679 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 14:23:04,905 - shipping_chatbot - INFO - User_Query: cargo ready date for PO#6300146311, consignee_code: ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 14:23:04,905 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-20 14:23:18,264 - shipping_chatbot - INFO - Fetched 18991 rows
2026-01-20 14:23:18,267 - shipping_chatbot - INFO - Starting preprocessing on 18991 rows
2026-01-20 14:23:18,341 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-20 14:23:18,864 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-20 14:23:19,010 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-20 14:23:19,465 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-20 14:23:19,466 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-20 14:23:19,467 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-20 14:23:19,494 - shipping_chatbot - INFO - Pre-processing finished - 18991 rows remain
2026-01-20 14:23:21,696 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 6300146311
2026-01-20 14:23:21,719 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-20 14:23:21,732 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Get Container Milestones | Tool Input: PO 6300146311
2026-01-20 14:24:21,728 - shipping_chatbot - INFO - User_Query: cargo ready date for PO#6300146311, consignee_code: ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 14:24:24,261 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 6300146311
2026-01-20 14:24:24,288 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-20 14:24:24,293 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Get Container Milestones | Tool Input: PO 6300146311
2026-01-20 14:25:34,807 - shipping_chatbot - INFO - User_Query: please check the vendor name of 6300146311, consignee_code: ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 14:25:38,361 - shipping_chatbot - INFO - Analyst Engine processing query: select supplier_vendor_name from dataset where '6300146311' in po_number_multiple and hot_container_flag in ('Y', 'YES', 'TRUE', '1', 'HOT')
2026-01-20 14:25:43,163 - shipping_chatbot - INFO - ========================================
2026-01-20 14:25:43,163 - shipping_chatbot - INFO - ANALYST ENGINE DEBUG MODE
2026-01-20 14:25:43,163 - shipping_chatbot - INFO - QUERY: select supplier_vendor_name from dataset where '6300146311' in po_number_multiple and hot_container_flag in ('Y', 'YES', 'TRUE', '1', 'HOT')
2026-01-20 14:25:43,163 - shipping_chatbot - INFO - GENERATED CODE:
# Normalize hot_container_flag to string uppercase for consistent filtering
hot_flags = ['Y', 'YES', 'TRUE', '1', 'HOT']

# Filter rows where po_number_multiple contains '6300146311' and hot_container_flag is in hot_flags
filtered_df = df[
    df['po_number_multiple'].str.contains('6300146311', na=False) &
    df['hot_container_flag'].astype(str).str.upper().isin(hot_flags)
]

# Extract unique supplier_vendor_name values, dropna to avoid nulls
supplier_names = filtered_df['supplier_vendor_name'].dropna().unique()

# Format result as a comma-separated string or indicate no results
if len(supplier_names) > 0:
    result = ", ".join(supplier_names)
else:
    result = "No supplier_vendor_name found for PO#6300146311 with hot container flag."
2026-01-20 14:25:43,165 - shipping_chatbot - INFO - ========================================
2026-01-20 14:25:43,169 - shipping_chatbot - INFO - ANALYST ENGINE SUCCESS: Result obtained (length: 72)
2026-01-20 14:25:46,557 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: select supplier_vendor_name from dataset where '6300146311' in po_number_multiple and hot_container_flag in ('Y', 'YES', 'TRUE', '1', 'HOT')
2026-01-20 14:33:17,456 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 14:33:17,456 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-20 14:33:17,456 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 14:33:30,404 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 14:33:30,404 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-20 14:33:30,407 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 14:34:12,433 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 14:34:12,433 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-20 14:34:12,433 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 14:52:07,958 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 14:52:07,959 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-20 14:52:07,959 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 14:54:11,484 - shipping_chatbot - INFO - User_Query: who is the supplier for FBIU0348756, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-20 14:54:11,484 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-20 14:54:25,519 - shipping_chatbot - INFO - Fetched 18991 rows
2026-01-20 14:54:25,525 - shipping_chatbot - INFO - Starting preprocessing on 18991 rows
2026-01-20 14:54:25,690 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-20 14:54:26,951 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-20 14:54:27,319 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-20 14:54:28,208 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-20 14:54:28,210 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-20 14:54:28,211 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-20 14:54:28,283 - shipping_chatbot - INFO - Pre-processing finished - 18991 rows remain
2026-01-20 14:54:28,643 - shipping_chatbot - ERROR - Agent failed: "Input to ChatPromptTemplate is missing variables {'Y, YES, TRUE, 1, HOT'}.  Expected: ['Y, YES, TRUE, 1, HOT', 'agent_scratchpad', 'chat_history', 'consignee_code', 'input'] Received: ['input', 'chat_history', 'consignee_code', 'intermediate_steps', 'agent_scratchpad']"
Traceback (most recent call last):
  File "C:\Users\CHOWDHURYRaju\Desktop\roshan\StlnkWebNprdChatV2\api\main.py", line 201, in ask
    result = AGENT.invoke(
             ^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\chains\base.py", line 166, in invoke
    raise e
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\chains\base.py", line 156, in invoke
    self._call(inputs, run_manager=run_manager)
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\agents\agent.py", line 1433, in _call
    next_step_output = self._take_next_step(
                       ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\agents\agent.py", line 1139, in _take_next_step
    [
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\agents\agent.py", line 1139, in <listcomp>
    [
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\agents\agent.py", line 1167, in _iter_next_step
    output = self.agent.plan(
             ^^^^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\agents\agent.py", line 398, in plan
    for chunk in self.runnable.stream(inputs, config={"callbacks": callbacks}):
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\runnables\base.py", line 2775, in stream
    yield from self.transform(iter([input]), config, **kwargs)
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\runnables\base.py", line 2762, in transform
    yield from self._transform_stream_with_config(
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\runnables\base.py", line 1778, in _transform_stream_with_config
    chunk: Output = context.run(next, iterator)  # type: ignore
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\runnables\base.py", line 2726, in _transform
    for output in final_pipeline:
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\runnables\base.py", line 1154, in transform
    for ichunk in input:
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\runnables\base.py", line 4644, in transform
    yield from self.bound.transform(
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\runnables\base.py", line 1154, in transform
    for ichunk in input:
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\runnables\base.py", line 1172, in transform
    yield from self.stream(final, config, **kwargs)
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\runnables\base.py", line 814, in stream
    yield self.invoke(input, config, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\prompts\base.py", line 128, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\runnables\base.py", line 1509, in _call_with_config
    context.run(
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\runnables\config.py", line 365, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\prompts\base.py", line 111, in _format_prompt_with_error_handling
    _inner_input = self._validate_input(inner_input)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\prompts\base.py", line 103, in _validate_input
    raise KeyError(
KeyError: "Input to ChatPromptTemplate is missing variables {'Y, YES, TRUE, 1, HOT'}.  Expected: ['Y, YES, TRUE, 1, HOT', 'agent_scratchpad', 'chat_history', 'consignee_code', 'input'] Received: ['input', 'chat_history', 'consignee_code', 'intermediate_steps', 'agent_scratchpad']"
2026-01-20 14:54:28,864 - shipping_chatbot - INFO - Router: Set context (codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'], has_history: False) for query: who is the supplier for FBIU0348756
2026-01-20 14:54:29,029 - shipping_chatbot - INFO - Consignee filtering validated: 12583 rows for codes ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 11:20:42,616 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 11:20:42,616 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-21 11:20:42,616 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 11:22:56,150 - shipping_chatbot - INFO - User_Query: Please provide the shipment status of 5302970007, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 11:22:56,150 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 11:23:12,584 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 11:23:12,588 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 11:23:12,670 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 11:23:13,188 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 11:23:13,331 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 11:23:13,866 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 11:23:13,869 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 11:23:13,870 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 11:23:13,893 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
2026-01-21 11:23:16,116 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302970007
2026-01-21 11:23:16,161 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-21 11:23:16,171 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Get Container Milestones | Tool Input: PO 5302970007
2026-01-21 11:25:07,763 - shipping_chatbot - INFO - User_Query: What is status of 5302997239?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 11:25:10,118 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302997239
2026-01-21 11:25:10,160 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-21 11:25:10,166 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Get Container Milestones | Tool Input: PO 5302997239
2026-01-21 11:26:06,825 - shipping_chatbot - INFO - User_Query: What is status of 5303015586?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 11:26:09,222 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5303015586
2026-01-21 11:26:09,266 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 2 rows found
2026-01-21 11:26:09,270 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Get Container Milestones | Tool Input: PO 5303015586
2026-01-21 11:29:43,870 - shipping_chatbot - INFO - User_Query: What is status of the PO 5303017676?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 11:29:46,270 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5303017676
2026-01-21 11:29:46,314 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-21 11:29:46,322 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Get Container Milestones | Tool Input: PO 5303017676
2026-01-21 11:30:33,945 - shipping_chatbot - INFO - User_Query: What are the POs in the container MSKU1452171?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 11:30:36,282 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Get Container Milestones | Tool Input: container MSKU1452171
2026-01-21 11:30:51,979 - shipping_chatbot - INFO - User_Query: What are the POs in the container MSKU1452171?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 11:31:28,005 - shipping_chatbot - INFO - User_Query: what are the po in MSKU1452171?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 11:31:30,326 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Get Container Milestones | Tool Input: container MSKU1452171
2026-01-21 11:32:28,768 - shipping_chatbot - INFO - User_Query: What is the container carrying the PO 5303009456?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 11:32:31,028 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5303009456
2026-01-21 11:32:31,072 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 2 rows found
2026-01-21 11:32:31,077 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Get Container Milestones | Tool Input: PO 5303009456
2026-01-21 12:04:14,490 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:04:14,491 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-21 12:04:14,491 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:04:24,933 - shipping_chatbot - INFO - User_Query: What is the container carrying the PO 5303009456?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 12:04:24,933 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 12:04:36,389 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 12:04:36,393 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 12:04:36,465 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 12:04:36,977 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 12:04:37,125 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 12:04:37,584 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 12:04:37,584 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 12:04:37,584 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 12:04:37,610 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
2026-01-21 12:04:40,670 - shipping_chatbot - INFO - Analyst Engine processing query: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple is in authorized consignee codes list; select container_number
2026-01-21 12:04:40,675 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:04:42,600 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:04:47,543 - shipping_chatbot - INFO - Analyst Engine processing query: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:04:47,543 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:04:48,703 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:04:53,766 - shipping_chatbot - INFO - Analyst Engine processing query: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:04:53,769 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:04:55,764 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:05:01,888 - shipping_chatbot - INFO - Analyst Engine processing query: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:05:01,889 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:05:03,725 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:05:08,877 - shipping_chatbot - INFO - Analyst Engine processing query: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:05:08,877 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:05:11,050 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:05:15,474 - shipping_chatbot - INFO - Analyst Engine processing query: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:05:15,475 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:05:16,478 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:05:22,091 - shipping_chatbot - INFO - Analyst Engine processing query: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:05:22,091 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:05:24,034 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:05:29,583 - shipping_chatbot - INFO - Analyst Engine processing query: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:05:29,583 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:05:31,446 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:05:36,711 - shipping_chatbot - INFO - Analyst Engine processing query: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:05:36,711 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:05:38,720 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:05:44,646 - shipping_chatbot - INFO - Analyst Engine processing query: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:05:44,650 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:05:46,846 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:05:52,543 - shipping_chatbot - INFO - Analyst Engine processing query: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:05:52,544 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:05:54,596 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:05:59,343 - shipping_chatbot - INFO - Analyst Engine processing query: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:05:59,343 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:06:00,406 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:06:05,405 - shipping_chatbot - INFO - Analyst Engine processing query: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:06:05,406 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:06:07,506 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:06:13,146 - shipping_chatbot - INFO - Analyst Engine processing query: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:06:13,146 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:06:14,938 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:06:20,044 - shipping_chatbot - INFO - Analyst Engine processing query: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:06:20,044 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:06:21,925 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:06:21,934 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple is in authorized consignee codes list; select container_number
2026-01-21 12:06:21,934 - shipping_chatbot - INFO - AGENT_STEP: 2 | Tool Used: Analyze Data with Pandas | Tool Input: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:06:21,934 - shipping_chatbot - INFO - AGENT_STEP: 3 | Tool Used: Analyze Data with Pandas | Tool Input: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:06:21,934 - shipping_chatbot - INFO - AGENT_STEP: 4 | Tool Used: Analyze Data with Pandas | Tool Input: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:06:21,936 - shipping_chatbot - INFO - AGENT_STEP: 5 | Tool Used: Analyze Data with Pandas | Tool Input: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:06:21,936 - shipping_chatbot - INFO - AGENT_STEP: 6 | Tool Used: Analyze Data with Pandas | Tool Input: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:06:21,936 - shipping_chatbot - INFO - AGENT_STEP: 7 | Tool Used: Analyze Data with Pandas | Tool Input: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:06:21,937 - shipping_chatbot - INFO - AGENT_STEP: 8 | Tool Used: Analyze Data with Pandas | Tool Input: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:06:21,937 - shipping_chatbot - INFO - AGENT_STEP: 9 | Tool Used: Analyze Data with Pandas | Tool Input: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:06:21,937 - shipping_chatbot - INFO - AGENT_STEP: 10 | Tool Used: Analyze Data with Pandas | Tool Input: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:06:21,938 - shipping_chatbot - INFO - AGENT_STEP: 11 | Tool Used: Analyze Data with Pandas | Tool Input: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:06:21,938 - shipping_chatbot - INFO - AGENT_STEP: 12 | Tool Used: Analyze Data with Pandas | Tool Input: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:06:21,938 - shipping_chatbot - INFO - AGENT_STEP: 13 | Tool Used: Analyze Data with Pandas | Tool Input: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:06:21,938 - shipping_chatbot - INFO - AGENT_STEP: 14 | Tool Used: Analyze Data with Pandas | Tool Input: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:06:21,938 - shipping_chatbot - INFO - AGENT_STEP: 15 | Tool Used: Analyze Data with Pandas | Tool Input: Filter rows where po_number_multiple contains '5303009456' and consignee_code_multiple in ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'] select container_number
2026-01-21 12:06:21,940 - shipping_chatbot - INFO - Router: Set context (codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'], has_history: False) for query: What is the container carrying the PO 5303009456?
2026-01-21 12:06:22,006 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 12:12:13,481 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:12:13,481 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-21 12:12:13,482 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:12:56,569 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:12:56,570 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-21 12:12:56,570 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:13:09,661 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:13:09,662 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-21 12:13:09,662 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:13:14,282 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:13:14,283 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-21 12:13:14,283 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:14:28,437 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:14:28,438 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-21 12:14:28,439 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:15:28,582 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:15:28,582 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-21 12:15:28,584 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:15:36,488 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:15:36,489 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-21 12:15:36,489 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:22:00,409 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:22:00,410 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-21 12:22:00,411 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:23:45,981 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:23:45,989 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-21 12:23:46,005 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:23:59,802 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:23:59,808 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-21 12:23:59,815 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:24:41,773 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:24:41,774 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-21 12:24:41,775 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:25:21,289 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:25:21,290 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-21 12:25:21,290 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:31:58,640 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:31:58,640 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-21 12:31:58,640 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:32:04,463 - shipping_chatbot - INFO - User_Query: What is the container carrying the PO 5303009456?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 12:32:04,464 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 12:32:18,187 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 12:32:18,189 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 12:32:18,265 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 12:32:18,766 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 12:32:18,916 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 12:32:19,361 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 12:32:19,363 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 12:32:19,363 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 12:32:19,390 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
2026-01-21 12:32:22,500 - shipping_chatbot - INFO - Analyst Engine processing query: select container_number from dataset where po_number_multiple like '%5303009456%'
2026-01-21 12:32:22,506 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:32:24,640 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:32:24,649 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'po number multiple' (from 'po_number_multiple') not found
2026-01-21 12:32:26,131 - shipping_chatbot - INFO - Analyst Engine processing query: select container_number from dataset where po_number_multiple is not null and po_number_multiple like '%5303009456%'
2026-01-21 12:32:26,131 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:32:27,124 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:32:27,133 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'po number multiple' (from 'po_number_multiple') not found
2026-01-21 12:32:28,303 - shipping_chatbot - INFO - Analyst Engine processing query: select container_number from dataset where po_number_multiple_multiple is not null and po_number_multiple_multiple like '%5303009456%'
2026-01-21 12:32:28,303 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:32:29,289 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:32:29,296 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'po number multiple' (from 'po_number_multiple') not found
2026-01-21 12:32:30,499 - shipping_chatbot - INFO - Analyst Engine processing query: select container_number from dataset where po_number_multiple is not null and po_number_multiple like '%5303009456%'
2026-01-21 12:32:30,499 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:32:31,366 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:32:31,376 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'po number multiple' (from 'po_number_multiple') not found
2026-01-21 12:32:33,247 - shipping_chatbot - INFO - Analyst Engine processing query: select container_number from dataset where po_number_multiple like '%5303009456%' or po_number like '%5303009456%'
2026-01-21 12:32:33,250 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:32:34,146 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:32:34,160 - shipping_chatbot - INFO - QUERY_BANK: attribute_lookup found 2 records for '5303009456' (col: container_number)
2026-01-21 12:32:35,269 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: select container_number from dataset where po_number_multiple like '%5303009456%' | Observation: Attribute field 'po_number_multiple' not found in the dataset.
2026-01-21 12:32:35,269 - shipping_chatbot - INFO - AGENT_STEP: 2 | Tool Used: Analyze Data with Pandas | Tool Input: select container_number from dataset where po_number_multiple is not null and po_number_multiple like '%5303009456%' | Observation: Attribute field 'po_number_multiple' not found in the dataset.
2026-01-21 12:32:35,270 - shipping_chatbot - INFO - AGENT_STEP: 3 | Tool Used: Analyze Data with Pandas | Tool Input: select container_number from dataset where po_number_multiple_multiple is not null and po_number_multiple_multiple like '%5303009456%' | Observation: Attribute field 'po_number_multiple' not found in the dataset.
2026-01-21 12:32:35,270 - shipping_chatbot - INFO - AGENT_STEP: 4 | Tool Used: Analyze Data with Pandas | Tool Input: select container_number from dataset where po_number_multiple is not null and po_number_multiple like '%5303009456%' | Observation: Attribute field 'po_number_multiple' not found in the dataset.
2026-01-21 12:32:35,270 - shipping_chatbot - INFO - AGENT_STEP: 5 | Tool Used: Analyze Data with Pandas | Tool Input: select container_number from dataset where po_number_multiple like '%5303009456%' or po_number like '%5303009456%' | Observation: | container_number   | po_number_multiple               |
|:-------------------|:---------------------------------|
| TRHU4994230        | 5303009252,5303009456,5303018990 |
| ONEU0782272        | 5303009456                       |
2026-01-21 12:33:46,779 - shipping_chatbot - INFO - User_Query: What are the POs in the container TCLU4703170?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 12:33:50,209 - shipping_chatbot - INFO - Analyst Engine processing query: select distinct po_number_multiple from dataset where container_number = 'TCLU4703170'
2026-01-21 12:33:50,209 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:33:52,003 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:33:52,016 - shipping_chatbot - INFO - QUERY_BANK: attribute_lookup found 1 records for 'TCLU4703170' (col: container_number)
2026-01-21 12:33:53,106 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: select distinct po_number_multiple from dataset where container_number = 'TCLU4703170' | Observation: | container_number   |   po_number_multiple |
|:-------------------|---------------------:|
| TCLU4703170        |           5302850124 |
2026-01-21 12:34:41,216 - shipping_chatbot - INFO - User_Query: What is the container carrying the PO 5000031058?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 12:34:43,868 - shipping_chatbot - INFO - Analyst Engine processing query: select container_number from dataset where po_number_multiple like '%5000031058%'
2026-01-21 12:34:43,868 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:34:45,764 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:34:45,775 - shipping_chatbot - INFO - QUERY_BANK: attribute_lookup found NO records for '5000031058'
2026-01-21 12:34:46,993 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: select container_number from dataset where po_number_multiple like '%5000031058%' | Observation: No records found matching identifier '5000031058'.
2026-01-21 12:36:16,799 - shipping_chatbot - INFO - User_Query: What is the container carrying the PO 5302999796?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 12:36:19,593 - shipping_chatbot - INFO - Analyst Engine processing query: select container_number from data where po_number_multiple like '%5302999796%'
2026-01-21 12:36:19,593 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:36:21,325 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:36:21,334 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'po number multiple' (from 'po_number_multiple') not found
2026-01-21 12:36:23,363 - shipping_chatbot - INFO - Analyst Engine processing query: select container_number from data where po_number_multiple like '%5302999796%'
2026-01-21 12:36:23,363 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:36:24,126 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:36:24,133 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'po number multiple' (from 'po_number_multiple') not found
2026-01-21 12:36:25,161 - shipping_chatbot - INFO - Analyst Engine processing query: select container_number from data where po_number_multiple like '%5302999796%'
2026-01-21 12:36:25,161 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:36:26,738 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:36:26,747 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'po number multiple' (from 'po_number_multiple') not found
2026-01-21 12:36:27,830 - shipping_chatbot - INFO - Analyst Engine processing query: select container_number from data where po_number_multiple like '%5302999796%'
2026-01-21 12:36:27,831 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:36:28,730 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:36:28,740 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'po number multiple' (from 'po_number_multiple') not found
2026-01-21 12:36:29,840 - shipping_chatbot - INFO - Analyst Engine processing query: select container_number from data where po_number_multiple like '%5302999796%'
2026-01-21 12:36:29,841 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:36:30,720 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:36:30,731 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'po number multiple' (from 'po_number_multiple') not found
2026-01-21 12:36:32,066 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: select container_number from data where po_number_multiple like '%5302999796%' | Observation: Attribute field 'po_number_multiple' not found in the dataset.
2026-01-21 12:36:32,068 - shipping_chatbot - INFO - AGENT_STEP: 2 | Tool Used: Analyze Data with Pandas | Tool Input: select container_number from data where po_number_multiple like '%5302999796%' | Observation: Attribute field 'po_number_multiple' not found in the dataset.
2026-01-21 12:36:32,068 - shipping_chatbot - INFO - AGENT_STEP: 3 | Tool Used: Analyze Data with Pandas | Tool Input: select container_number from data where po_number_multiple like '%5302999796%' | Observation: Attribute field 'po_number_multiple' not found in the dataset.
2026-01-21 12:36:32,068 - shipping_chatbot - INFO - AGENT_STEP: 4 | Tool Used: Analyze Data with Pandas | Tool Input: select container_number from data where po_number_multiple like '%5302999796%' | Observation: Attribute field 'po_number_multiple' not found in the dataset.
2026-01-21 12:36:32,068 - shipping_chatbot - INFO - AGENT_STEP: 5 | Tool Used: Analyze Data with Pandas | Tool Input: select container_number from data where po_number_multiple like '%5302999796%' | Observation: Attribute field 'po_number_multiple' not found in the dataset.
2026-01-21 12:38:07,733 - shipping_chatbot - INFO - User_Query: What are the POs in the container MSBU4216984?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 12:38:10,513 - shipping_chatbot - INFO - Analyst Engine processing query: select distinct po_number_multiple from dataset where container_number = 'MSBU4216984'
2026-01-21 12:38:10,513 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:38:12,180 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:38:12,193 - shipping_chatbot - INFO - QUERY_BANK: attribute_lookup found 1 records for 'MSBU4216984' (col: container_number)
2026-01-21 12:38:13,333 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: select distinct po_number_multiple from dataset where container_number = 'MSBU4216984' | Observation: | container_number   | po_number_multiple    |
|:-------------------|:----------------------|
| MSBU4216984        | 5302999796,5303014497 |
2026-01-21 12:39:01,713 - shipping_chatbot - INFO - User_Query: What is status of the PO 5302999796?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 12:39:04,327 - shipping_chatbot - INFO - Analyst Engine processing query: select container_number, discharge_port, eta_dp, ata_dp, case when ata_dp is not null then datediff(day, eta_dp, ata_dp) else null end as delay_days, current_arrival_status from shipments where po_number_multiple like '%5302999796%'
2026-01-21 12:39:04,327 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:39:06,092 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:39:06,101 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'po number multiple' (from 'po_number_multiple') not found
2026-01-21 12:39:07,457 - shipping_chatbot - INFO - Analyst Engine processing query: select container_number, discharge_port, eta_dp, ata_dp, case when ata_dp is not null then datediff(day, eta_dp, ata_dp) else null end as delay_days, current_arrival_status from shipments where po_number_multiple like '%5302999796%'
2026-01-21 12:39:07,457 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:39:08,314 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:39:08,325 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'po number multiple' (from 'po_number_multiple') not found
2026-01-21 12:39:09,856 - shipping_chatbot - INFO - Analyst Engine processing query: select container_number, discharge_port, eta_dp, ata_dp, case when ata_dp is not null then datediff(day, eta_dp, ata_dp) else null end as delay_days, current_arrival_status from shipments where po_number_multiple like '%5302999796%' or po_number like '%5302999796%'
2026-01-21 12:39:09,860 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:39:10,789 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:39:10,799 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'po number multiple' (from 'po_number_multiple') not found
2026-01-21 12:39:11,843 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: select container_number, discharge_port, eta_dp, ata_dp, case when ata_dp is not null then datediff(day, eta_dp, ata_dp) else null end as delay_days, current_arrival_status from shipments where po_number_multiple like '%5302999796%' | Observation: Attribute field 'po_number_multiple' not found in the dataset.
2026-01-21 12:39:11,843 - shipping_chatbot - INFO - AGENT_STEP: 2 | Tool Used: Analyze Data with Pandas | Tool Input: select container_number, discharge_port, eta_dp, ata_dp, case when ata_dp is not null then datediff(day, eta_dp, ata_dp) else null end as delay_days, current_arrival_status from shipments where po_number_multiple like '%5302999796%' | Observation: Attribute field 'po_number_multiple' not found in the dataset.
2026-01-21 12:39:11,843 - shipping_chatbot - INFO - AGENT_STEP: 3 | Tool Used: Analyze Data with Pandas | Tool Input: select container_number, discharge_port, eta_dp, ata_dp, case when ata_dp is not null then datediff(day, eta_dp, ata_dp) else null end as delay_days, current_arrival_status from shipments where po_number_multiple like '%5302999796%' or po_number like '%5302999796%' | Observation: Attribute field 'po_number_multiple' not found in the dataset.
2026-01-21 12:39:20,334 - shipping_chatbot - INFO - User_Query: What is status of the PO 5302999796?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 12:39:23,046 - shipping_chatbot - INFO - Analyst Engine processing query: select po_number_multiple, current_arrival_status, late_arrival_status, delivery_date_to_consignee from dataset where po_number_multiple like '%5302999796%'
2026-01-21 12:39:23,046 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:39:24,696 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:39:24,725 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'po number multiple' (from 'po_number_multiple') not found
2026-01-21 12:39:26,314 - shipping_chatbot - INFO - Analyst Engine processing query: select po_number_multiple, current_arrival_status, late_arrival_status, delivery_date_to_consignee from dataset where '5302999796' in po_number_multiple
2026-01-21 12:39:26,316 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 12:39:27,202 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 12:39:27,238 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'po number multiple' (from 'po_number_multiple') not found
2026-01-21 12:39:28,269 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: select po_number_multiple, current_arrival_status, late_arrival_status, delivery_date_to_consignee from dataset where po_number_multiple like '%5302999796%' | Observation: Attribute field 'po_number_multiple' not found in the dataset.
2026-01-21 12:39:28,269 - shipping_chatbot - INFO - AGENT_STEP: 2 | Tool Used: Analyze Data with Pandas | Tool Input: select po_number_multiple, current_arrival_status, late_arrival_status, delivery_date_to_consignee from dataset where '5302999796' in po_number_multiple | Observation: Attribute field 'po_number_multiple' not found in the dataset.
2026-01-21 13:04:31,654 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 13:06:04,393 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 13:06:04,396 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 13:06:04,500 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 13:06:05,601 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 13:06:05,866 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 13:06:06,877 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 13:06:06,881 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 13:06:06,883 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 13:06:06,951 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
2026-01-21 13:06:33,746 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 13:06:33,746 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-21 13:06:33,748 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 13:06:43,897 - shipping_chatbot - INFO - User_Query: What is status of 5302997239?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:06:43,897 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 13:06:56,120 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 13:06:56,123 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 13:06:56,193 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 13:06:56,713 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 13:06:56,866 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 13:06:57,305 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 13:06:57,308 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 13:06:57,309 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 13:06:57,333 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
2026-01-21 13:06:59,657 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:06:59,674 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302997239
2026-01-21 13:06:59,716 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-21 13:06:59,725 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Get Container Milestones | Tool Input: 5302997239 | Observation: The Container <con>16002432894</con> is associated with the PO <po>5302997239</po> . Status is in below : 

The Container <con>16002432894</con> <strong>Delivered at</strong> MOUNT JULIET, TN(USMJB) on 2025-10-20

 <MILESTONE>                 <strong>Departed From</strong>     XIAMEN, FUJIAN(CNXMN) 2025-10-21
   <strong>Arrived at Final Load Port</strong>          HONG KONG(HKHKG) 2025-10-12
<strong>Departed from Final Load Port</strong>          HONG KONG(HKHKG) 2025-10-14
   <strong>Expected a... [TRUNCATED]
2026-01-21 13:07:21,527 - shipping_chatbot - INFO - User_Query: What is the container carrying the PO 5302997239?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:07:24,656 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:07:24,661 - shipping_chatbot - INFO - Analyst Engine processing query: SELECT container_number FROM dataset WHERE po_number_multiple LIKE '%5302997239%'
2026-01-21 13:07:24,664 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:07:26,403 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:07:26,416 - shipping_chatbot - INFO - QUERY_BANK: attribute_lookup found 1 records for '5302997239' (col: po_number_multiple)
2026-01-21 13:07:27,380 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: SELECT container_number FROM dataset WHERE po_number_multiple LIKE '%5302997239%' | Observation: |   container_number |   po_number_multiple |
|-------------------:|---------------------:|
|        16002432894 |           5302997239 |
2026-01-21 13:07:48,375 - shipping_chatbot - INFO - User_Query: What are the POs in the container TCLU4703170?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:07:51,394 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:07:51,396 - shipping_chatbot - INFO - Analyst Engine processing query: SELECT DISTINCT po_number_multiple FROM dataset WHERE container_number = 'TCLU4703170'
2026-01-21 13:07:51,396 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:07:52,992 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:07:53,011 - shipping_chatbot - INFO - QUERY_BANK: attribute_lookup found 1 records for 'TCLU4703170' (col: container_number)
2026-01-21 13:07:53,996 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: SELECT DISTINCT po_number_multiple FROM dataset WHERE container_number = 'TCLU4703170' | Observation: | container_number   |   po_number_multiple |
|:-------------------|---------------------:|
| TCLU4703170        |           5302850124 |
2026-01-21 13:08:17,865 - shipping_chatbot - INFO - User_Query: What are the POs arriving in Los Angeles?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:08:23,758 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:08:23,761 - shipping_chatbot - INFO - Analyst Engine processing query: SELECT DISTINCT po_number_multiple FROM dataset WHERE (discharge_port LIKE '%USLAX%') AND (ata_dp IS NULL) AND (consignee_code_multiple IN ('0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'))
2026-01-21 13:08:23,763 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:08:25,232 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'delayed_shipments'
2026-01-21 13:08:35,893 - shipping_chatbot - ERROR - Agent failed: Error code: 400 - {'error': {'message': "This model's maximum context length is 300000 tokens. However, your messages resulted in 392960 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_error', 'param': 'messages', 'code': 'context_length_exceeded'}}
Traceback (most recent call last):
  File "C:\Users\CHOWDHURYRaju\Desktop\roshan\StlnkWebNprdChatV2\api\main.py", line 201, in ask
    result = AGENT.invoke(
             ^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\chains\base.py", line 166, in invoke
    raise e
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\chains\base.py", line 156, in invoke
    self._call(inputs, run_manager=run_manager)
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\agents\agent.py", line 1433, in _call
    next_step_output = self._take_next_step(
                       ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\agents\agent.py", line 1139, in _take_next_step
    [
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\agents\agent.py", line 1139, in <listcomp>
    [
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\agents\agent.py", line 1167, in _iter_next_step
    output = self.agent.plan(
             ^^^^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\agents\agent.py", line 398, in plan
    for chunk in self.runnable.stream(inputs, config={"callbacks": callbacks}):
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\runnables\base.py", line 2775, in stream
    yield from self.transform(iter([input]), config, **kwargs)
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\runnables\base.py", line 2762, in transform
    yield from self._transform_stream_with_config(
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\runnables\base.py", line 1778, in _transform_stream_with_config
    chunk: Output = context.run(next, iterator)  # type: ignore
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\runnables\base.py", line 2726, in _transform
    for output in final_pipeline:
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\runnables\base.py", line 1154, in transform
    for ichunk in input:
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\runnables\base.py", line 4644, in transform
    yield from self.bound.transform(
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\runnables\base.py", line 1172, in transform
    yield from self.stream(final, config, **kwargs)
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\language_models\chat_models.py", line 265, in stream
    raise e
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\language_models\chat_models.py", line 245, in stream
    for chunk in self._stream(messages, stop=stop, **kwargs):
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_openai\chat_models\base.py", line 480, in _stream
    with self.client.create(messages=message_dicts, **params) as response:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\openai\resources\chat\completions\completions.py", line 1147, in create
    return self._post(
           ^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': "This model's maximum context length is 300000 tokens. However, your messages resulted in 392960 tokens. Please reduce the length of the messages.", 'type': 'invalid_request_error', 'param': 'messages', 'code': 'context_length_exceeded'}}
2026-01-21 13:08:36,028 - shipping_chatbot - INFO - Router: Set context (codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'], has_history: True) for query: What are the POs arriving in Los Angeles?
2026-01-21 13:08:36,109 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:08:36,124 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:09:58,162 - shipping_chatbot - INFO - User_Query: What is the consignee of 5302943326, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:10:01,108 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:10:01,112 - shipping_chatbot - INFO - Analyst Engine processing query: select consignee_code_multiple from dataset where po_number_multiple like '%5302943326%'
2026-01-21 13:10:01,112 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:10:02,778 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:10:02,796 - shipping_chatbot - INFO - QUERY_BANK: attribute_lookup found 1 records for '5302943326' (col: consignee_code_multiple)
2026-01-21 13:10:04,106 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: select consignee_code_multiple from dataset where po_number_multiple like '%5302943326%' | Observation: | container_number   | po_number_multiple                                                           | consignee_code_multiple     |
|:-------------------|:-----------------------------------------------------------------------------|:----------------------------|
| SEGU5077792        | 5302943326,5302943330,5302943331,5302955321,5302955322,5302973739,5302973743 | SALOMON USA (SUSA)(0002990) |
2026-01-21 13:10:42,066 - shipping_chatbot - INFO - User_Query: Booking number of 5302943326, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:10:44,720 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:10:44,722 - shipping_chatbot - INFO - Analyst Engine processing query: SELECT booking_number_multiple FROM dataset WHERE po_number_multiple LIKE '%5302943326%'
2026-01-21 13:10:44,722 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:10:46,362 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'booking_lookup'
2026-01-21 13:10:47,474 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: SELECT booking_number_multiple FROM dataset WHERE po_number_multiple LIKE '%5302943326%' | Observation: | container_number   | po_number_multiple                                                           | booking_number_multiple   | eta_dp              |
|:-------------------|:-----------------------------------------------------------------------------|:--------------------------|:--------------------|
| SEGU5077792        | 5302943326,5302943330,5302943331,5302955321,5302955322,5302973739,5302973743 | VN2091204,VN2091664       | 2025-12-01 00:00:00 |
2026-01-21 13:11:21,210 - shipping_chatbot - INFO - User_Query: What containers depature from CNSHA today, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:11:23,575 - shipping_chatbot - ERROR - Agent failed: Too many arguments to single-input tool Get Today Date.
                Consider using StructuredTool instead. Args: []
Traceback (most recent call last):
  File "C:\Users\CHOWDHURYRaju\Desktop\roshan\StlnkWebNprdChatV2\api\main.py", line 201, in ask
    result = AGENT.invoke(
             ^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\chains\base.py", line 166, in invoke
    raise e
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\chains\base.py", line 156, in invoke
    self._call(inputs, run_manager=run_manager)
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\agents\agent.py", line 1433, in _call
    next_step_output = self._take_next_step(
                       ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\agents\agent.py", line 1139, in _take_next_step
    [
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\agents\agent.py", line 1139, in <listcomp>
    [
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\agents\agent.py", line 1224, in _iter_next_step
    yield self._perform_agent_action(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\agents\agent.py", line 1246, in _perform_agent_action
    observation = tool.run(
                  ^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\tools.py", line 433, in run
    raise e
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\tools.py", line 407, in run
    tool_args, tool_kwargs = self._to_args_and_kwargs(parsed_input)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\tools.py", line 610, in _to_args_and_kwargs
    raise ToolException(
langchain_core.tools.ToolException: Too many arguments to single-input tool Get Today Date.
                Consider using StructuredTool instead. Args: []
2026-01-21 13:11:23,593 - shipping_chatbot - INFO - Router: Set context (codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'], has_history: True) for query: What containers depature from CNSHA today
2026-01-21 13:11:23,683 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:11:23,698 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:11:45,211 - shipping_chatbot - INFO - User_Query: What containers depature from Shanghai China today, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:11:47,489 - shipping_chatbot - ERROR - Agent failed: Too many arguments to single-input tool Get Today Date.
                Consider using StructuredTool instead. Args: []
Traceback (most recent call last):
  File "C:\Users\CHOWDHURYRaju\Desktop\roshan\StlnkWebNprdChatV2\api\main.py", line 201, in ask
    result = AGENT.invoke(
             ^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\chains\base.py", line 166, in invoke
    raise e
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\chains\base.py", line 156, in invoke
    self._call(inputs, run_manager=run_manager)
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\agents\agent.py", line 1433, in _call
    next_step_output = self._take_next_step(
                       ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\agents\agent.py", line 1139, in _take_next_step
    [
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\agents\agent.py", line 1139, in <listcomp>
    [
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\agents\agent.py", line 1224, in _iter_next_step
    yield self._perform_agent_action(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain\agents\agent.py", line 1246, in _perform_agent_action
    observation = tool.run(
                  ^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\tools.py", line 433, in run
    raise e
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\tools.py", line 407, in run
    tool_args, tool_kwargs = self._to_args_and_kwargs(parsed_input)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CHOWDHURYRaju\AppData\Roaming\Python\Python311\site-packages\langchain_core\tools.py", line 610, in _to_args_and_kwargs
    raise ToolException(
langchain_core.tools.ToolException: Too many arguments to single-input tool Get Today Date.
                Consider using StructuredTool instead. Args: []
2026-01-21 13:11:47,490 - shipping_chatbot - INFO - Router: Set context (codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392'], has_history: True) for query: What containers depature from Shanghai China today
2026-01-21 13:11:47,570 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:11:47,585 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:12:26,560 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#5302982894, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:12:29,443 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:12:29,446 - shipping_chatbot - INFO - Analyst Engine processing query: SELECT po_number_multiple, cargo_received_date_multiple FROM dataset WHERE po_number_multiple LIKE '%5302982894%'
2026-01-21 13:12:29,446 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:12:31,120 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:12:31,139 - shipping_chatbot - INFO - QUERY_BANK: attribute_lookup found 1 records for '5302982894' (col: po_number_multiple)
2026-01-21 13:12:32,566 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:12:32,568 - shipping_chatbot - INFO - Analyst Engine processing query: SELECT po_number_multiple, cargo_received_date_multiple FROM dataset WHERE po_number_multiple LIKE '%5302982894%'
2026-01-21 13:12:32,568 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:12:33,531 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:12:33,550 - shipping_chatbot - INFO - QUERY_BANK: attribute_lookup found 1 records for '5302982894' (col: po_number_multiple)
2026-01-21 13:12:34,606 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:12:34,606 - shipping_chatbot - INFO - Analyst Engine processing query: SELECT cargo_received_date_multiple FROM dataset WHERE po_number_multiple LIKE '%5302982894%'
2026-01-21 13:12:34,610 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:12:35,606 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:12:35,624 - shipping_chatbot - INFO - QUERY_BANK: attribute_lookup found 1 records for '5302982894' (col: cargo_received_date_multiple)
2026-01-21 13:12:36,743 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: SELECT po_number_multiple, cargo_received_date_multiple FROM dataset WHERE po_number_multiple LIKE '%5302982894%' | Observation: | container_number   |   po_number_multiple |
|:-------------------|---------------------:|
| TCKU1255049        |           5302982894 |
2026-01-21 13:12:36,743 - shipping_chatbot - INFO - AGENT_STEP: 2 | Tool Used: Analyze Data with Pandas | Tool Input: SELECT po_number_multiple, cargo_received_date_multiple FROM dataset WHERE po_number_multiple LIKE '%5302982894%' | Observation: | container_number   |   po_number_multiple |
|:-------------------|---------------------:|
| TCKU1255049        |           5302982894 |
2026-01-21 13:12:36,746 - shipping_chatbot - INFO - AGENT_STEP: 3 | Tool Used: Analyze Data with Pandas | Tool Input: SELECT cargo_received_date_multiple FROM dataset WHERE po_number_multiple LIKE '%5302982894%' | Observation: | container_number   |   po_number_multiple | cargo_received_date_multiple   |
|:-------------------|---------------------:|:-------------------------------|
| TCKU1255049        |           5302982894 | 2025-10-20 00:00:00            |
2026-01-21 13:14:54,704 - shipping_chatbot - INFO - User_Query: PO status for 5302982894, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:14:56,991 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:14:57,010 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302982894
2026-01-21 13:14:57,055 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-21 13:14:57,063 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Get Container Milestones | Tool Input: PO 5302982894 | Observation: The Container <con>TCKU1255049</con> is associated with the PO <po>5302982894</po> . Status is in below : 

The Container <con>TCKU1255049</con> <strong>Empty Container Returned to</strong> LAEM CHABANG(THLCH) on 2025-11-13

 <MILESTONE>                   <strong>Cargo Ready</strong>                None 2025-10-20
               <strong>Cargo Received</strong>                None 2025-10-20
                <strong>Departed From</strong>     SHANGHAI(CNSHA) 2025-10-30
<strong>Departed from Final ... [TRUNCATED]
2026-01-21 13:15:49,048 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:15:51,993 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:15:51,998 - shipping_chatbot - INFO - Analyst Engine processing query: SELECT po_number_multiple, SUM(shipped_quantity) AS total_shipped_quantity FROM dataset WHERE po_number_multiple LIKE '%5302982894%' GROUP BY po_number_multiple
2026-01-21 13:15:51,998 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:15:54,331 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:15:54,348 - shipping_chatbot - INFO - QUERY_BANK: attribute_lookup found 1 records for '5302982894' (col: po_number_multiple)
2026-01-21 13:15:55,843 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: SELECT po_number_multiple, SUM(shipped_quantity) AS total_shipped_quantity FROM dataset WHERE po_number_multiple LIKE '%5302982894%' GROUP BY po_number_multiple | Observation: | container_number   |   po_number_multiple |
|:-------------------|---------------------:|
| TCKU1255049        |           5302982894 |
2026-01-21 13:18:30,938 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302975708, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:18:33,869 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:18:33,872 - shipping_chatbot - INFO - Analyst Engine processing query: SELECT po_number_multiple, SUM(shipped_quantity) as total_shipped_quantity FROM dataset WHERE po_number_multiple LIKE '%5302975708%' GROUP BY po_number_multiple
2026-01-21 13:18:33,872 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:18:35,796 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:18:35,814 - shipping_chatbot - INFO - QUERY_BANK: attribute_lookup found 1 records for '5302975708' (col: po_number_multiple)
2026-01-21 13:18:36,750 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: SELECT po_number_multiple, SUM(shipped_quantity) as total_shipped_quantity FROM dataset WHERE po_number_multiple LIKE '%5302975708%' GROUP BY po_number_multiple | Observation: | container_number   |   po_number_multiple |
|:-------------------|---------------------:|
| CAAU6392783        |           5302975708 |
2026-01-21 13:23:22,321 - shipping_chatbot - INFO - User_Query: What is the shipper for PO#5302982894, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:23:24,986 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:23:24,990 - shipping_chatbot - INFO - Analyst Engine processing query: select supplier_vendor_name from dataset where po_number_multiple like '%5302982894%'
2026-01-21 13:23:24,990 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:23:26,724 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:23:26,738 - shipping_chatbot - INFO - QUERY_BANK: attribute_lookup found 1 records for '5302982894' (col: supplier_vendor_name)
2026-01-21 13:23:27,830 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: select supplier_vendor_name from dataset where po_number_multiple like '%5302982894%' | Observation: | container_number   |   po_number_multiple | supplier_vendor_name                         |
|:-------------------|---------------------:|:---------------------------------------------|
| TCKU1255049        |           5302982894 | JIAOWAY SPORTING GOODS(NANJING) CO.(0003202) |
2026-01-21 13:24:52,616 - shipping_chatbot - INFO - User_Query: What is the supplier for PO#5302982894, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:24:55,743 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:24:55,745 - shipping_chatbot - INFO - Analyst Engine processing query: select distinct supplier_vendor_name from data where po_number_multiple like '%5302982894%'
2026-01-21 13:24:55,746 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:24:57,651 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:24:57,666 - shipping_chatbot - INFO - QUERY_BANK: attribute_lookup found 1 records for '5302982894' (col: supplier_vendor_name)
2026-01-21 13:24:58,800 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: select distinct supplier_vendor_name from data where po_number_multiple like '%5302982894%' | Observation: | container_number   |   po_number_multiple | supplier_vendor_name                         |
|:-------------------|---------------------:|:---------------------------------------------|
| TCKU1255049        |           5302982894 | JIAOWAY SPORTING GOODS(NANJING) CO.(0003202) |
2026-01-21 13:29:00,298 - shipping_chatbot - INFO - User_Query: Which carrier is handled it?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:29:03,057 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:29:03,061 - shipping_chatbot - INFO - Analyst Engine processing query: select distinct final_carrier_name from dataset where po_number_multiple like '%5302982894%'
2026-01-21 13:29:03,061 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:29:04,631 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:29:04,650 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'carrier' (from 'carrier') not found
2026-01-21 13:29:05,811 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:29:05,815 - shipping_chatbot - INFO - Analyst Engine processing query: select distinct final_carrier_name from dataset where po_number_multiple like '%5302982894%'
2026-01-21 13:29:05,816 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:29:06,609 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:29:06,626 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'carrier' (from 'carrier') not found
2026-01-21 13:29:08,461 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:29:08,464 - shipping_chatbot - INFO - Analyst Engine processing query: select distinct final_carrier_name from dataset where po_number_multiple like '%5302982894%'
2026-01-21 13:29:08,466 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:29:09,535 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:29:09,552 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'carrier' (from 'carrier') not found
2026-01-21 13:29:10,936 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:29:10,938 - shipping_chatbot - INFO - Analyst Engine processing query: select distinct final_carrier_name from dataset where po_number_multiple like '%5302982894%'
2026-01-21 13:29:10,938 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:29:11,900 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:29:11,924 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'carrier' (from 'carrier') not found
2026-01-21 13:29:12,956 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:29:12,963 - shipping_chatbot - INFO - Analyst Engine processing query: select distinct final_carrier_name from dataset where po_number_multiple like '%5302982894%'
2026-01-21 13:29:12,964 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:29:13,805 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:29:13,819 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'carrier' (from 'carrier') not found
2026-01-21 13:29:15,338 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:29:15,343 - shipping_chatbot - INFO - Analyst Engine processing query: select distinct final_carrier_name from dataset where po_number_multiple like '%5302982894%'
2026-01-21 13:29:15,343 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:29:16,200 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:29:16,216 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'carrier' (from 'carrier') not found
2026-01-21 13:29:27,319 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:29:27,322 - shipping_chatbot - INFO - Analyst Engine processing query: select distinct final_carrier_name from dataset where po_number_multiple like '%5302982894%'
2026-01-21 13:29:27,323 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:29:29,446 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:29:29,461 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'carrier' (from 'carrier') not found
2026-01-21 13:29:30,646 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:29:30,646 - shipping_chatbot - INFO - Analyst Engine processing query: select distinct final_carrier_name from dataset where po_number_multiple like '%5302982894%'
2026-01-21 13:29:30,646 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:29:31,408 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:29:31,425 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'carrier' (from 'carrier') not found
2026-01-21 13:29:32,498 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: select distinct final_carrier_name from dataset where po_number_multiple like '%5302982894%' | Observation: Attribute field 'carrier' not found in the dataset.
2026-01-21 13:29:32,499 - shipping_chatbot - INFO - AGENT_STEP: 2 | Tool Used: Analyze Data with Pandas | Tool Input: select distinct final_carrier_name from dataset where po_number_multiple like '%5302982894%' | Observation: Attribute field 'carrier' not found in the dataset.
2026-01-21 13:29:32,499 - shipping_chatbot - INFO - AGENT_STEP: 3 | Tool Used: Analyze Data with Pandas | Tool Input: select distinct final_carrier_name from dataset where po_number_multiple like '%5302982894%' | Observation: Attribute field 'carrier' not found in the dataset.
2026-01-21 13:29:32,499 - shipping_chatbot - INFO - AGENT_STEP: 4 | Tool Used: Analyze Data with Pandas | Tool Input: select distinct final_carrier_name from dataset where po_number_multiple like '%5302982894%' | Observation: Attribute field 'carrier' not found in the dataset.
2026-01-21 13:29:32,499 - shipping_chatbot - INFO - AGENT_STEP: 5 | Tool Used: Analyze Data with Pandas | Tool Input: select distinct final_carrier_name from dataset where po_number_multiple like '%5302982894%' | Observation: Attribute field 'carrier' not found in the dataset.
2026-01-21 13:29:32,500 - shipping_chatbot - INFO - AGENT_STEP: 6 | Tool Used: Analyze Data with Pandas | Tool Input: select distinct final_carrier_name from dataset where po_number_multiple like '%5302982894%' | Observation: Attribute field 'carrier' not found in the dataset.
2026-01-21 13:29:32,500 - shipping_chatbot - INFO - AGENT_STEP: 7 | Tool Used: Analyze Data with Pandas | Tool Input: select distinct final_carrier_name from dataset where po_number_multiple like '%5302982894%' | Observation: Attribute field 'carrier' not found in the dataset.
2026-01-21 13:29:32,500 - shipping_chatbot - INFO - AGENT_STEP: 8 | Tool Used: Analyze Data with Pandas | Tool Input: select distinct final_carrier_name from dataset where po_number_multiple like '%5302982894%' | Observation: Attribute field 'carrier' not found in the dataset.
2026-01-21 13:30:55,410 - shipping_chatbot - INFO - User_Query: Which final carrier is handled it?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:30:58,392 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:30:58,394 - shipping_chatbot - INFO - Analyst Engine processing query: select final_carrier_name from dataset where po_number_multiple like '%5302982894%'
2026-01-21 13:30:58,396 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:31:00,491 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:31:00,508 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'carrier' (from 'carrier') not found
2026-01-21 13:31:01,756 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:31:01,758 - shipping_chatbot - INFO - Analyst Engine processing query: select final_carrier_name from dataset where po_number_multiple like '%5302982894%'
2026-01-21 13:31:01,759 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:31:02,579 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:31:02,595 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'carrier' (from 'carrier') not found
2026-01-21 13:31:03,752 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:31:03,756 - shipping_chatbot - INFO - Analyst Engine processing query: select final_carrier_name from dataset where po_number_multiple like '%5302982894%'
2026-01-21 13:31:03,756 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:31:04,659 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:31:04,675 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'carrier' (from 'carrier') not found
2026-01-21 13:31:05,768 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:31:05,770 - shipping_chatbot - INFO - Analyst Engine processing query: select distinct final_carrier_name from dataset where po_number_multiple like '%5302982894%'
2026-01-21 13:31:05,771 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:31:06,596 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:31:06,617 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'carrier' (from 'carrier') not found
2026-01-21 13:31:07,567 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:31:07,571 - shipping_chatbot - INFO - Analyst Engine processing query: select distinct final_carrier_name from dataset where po_number_multiple like '%5302982894%'
2026-01-21 13:31:07,571 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:31:08,372 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:31:08,387 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'carrier' (from 'carrier') not found
2026-01-21 13:31:09,315 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: select final_carrier_name from dataset where po_number_multiple like '%5302982894%' | Observation: Attribute field 'carrier' not found in the dataset.
2026-01-21 13:31:09,316 - shipping_chatbot - INFO - AGENT_STEP: 2 | Tool Used: Analyze Data with Pandas | Tool Input: select final_carrier_name from dataset where po_number_multiple like '%5302982894%' | Observation: Attribute field 'carrier' not found in the dataset.
2026-01-21 13:31:09,316 - shipping_chatbot - INFO - AGENT_STEP: 3 | Tool Used: Analyze Data with Pandas | Tool Input: select final_carrier_name from dataset where po_number_multiple like '%5302982894%' | Observation: Attribute field 'carrier' not found in the dataset.
2026-01-21 13:31:09,316 - shipping_chatbot - INFO - AGENT_STEP: 4 | Tool Used: Analyze Data with Pandas | Tool Input: select distinct final_carrier_name from dataset where po_number_multiple like '%5302982894%' | Observation: Attribute field 'carrier' not found in the dataset.
2026-01-21 13:31:09,317 - shipping_chatbot - INFO - AGENT_STEP: 5 | Tool Used: Analyze Data with Pandas | Tool Input: select distinct final_carrier_name from dataset where po_number_multiple like '%5302982894%' | Observation: Attribute field 'carrier' not found in the dataset.
2026-01-21 13:31:38,953 - shipping_chatbot - INFO - User_Query: Which final carrier is handled 5302982894?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:31:41,996 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:31:42,005 - shipping_chatbot - INFO - Analyst Engine processing query: select final_carrier_name from dataset where po_number_multiple like '%5302982894%'
2026-01-21 13:31:42,006 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:31:43,685 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:31:43,710 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'carrier' (from 'carrier') not found
2026-01-21 13:31:45,213 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:31:45,218 - shipping_chatbot - INFO - Analyst Engine processing query: select final_carrier_name from dataset where po_number_multiple like '%5302982894%'
2026-01-21 13:31:45,218 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:31:46,017 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:31:46,093 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'carrier' (from 'carrier') not found
2026-01-21 13:31:47,406 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:31:47,411 - shipping_chatbot - INFO - Analyst Engine processing query: select final_carrier_name from dataset where po_number_multiple like '%5302982894%'
2026-01-21 13:31:47,411 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:31:48,164 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:31:48,224 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'carrier' (from 'carrier') not found
2026-01-21 13:31:49,416 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 13:31:49,422 - shipping_chatbot - INFO - Analyst Engine processing query: select final_carrier_name from dataset where po_number_multiple like '%5302982894%'
2026-01-21 13:31:49,422 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 13:31:50,150 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 13:31:50,176 - shipping_chatbot - WARNING - QUERY_BANK: attribute_lookup column 'carrier' (from 'carrier') not found
2026-01-21 13:31:51,440 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: select final_carrier_name from dataset where po_number_multiple like '%5302982894%' | Observation: Attribute field 'carrier' not found in the dataset.
2026-01-21 13:31:51,440 - shipping_chatbot - INFO - AGENT_STEP: 2 | Tool Used: Analyze Data with Pandas | Tool Input: select final_carrier_name from dataset where po_number_multiple like '%5302982894%' | Observation: Attribute field 'carrier' not found in the dataset.
2026-01-21 13:31:51,440 - shipping_chatbot - INFO - AGENT_STEP: 3 | Tool Used: Analyze Data with Pandas | Tool Input: select final_carrier_name from dataset where po_number_multiple like '%5302982894%' | Observation: Attribute field 'carrier' not found in the dataset.
2026-01-21 13:31:51,442 - shipping_chatbot - INFO - AGENT_STEP: 4 | Tool Used: Analyze Data with Pandas | Tool Input: select final_carrier_name from dataset where po_number_multiple like '%5302982894%' | Observation: Attribute field 'carrier' not found in the dataset.
2026-01-21 14:16:53,530 - shipping_chatbot - INFO - User_Query: What is the status of NYKU3778509?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 14:16:55,954 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 14:16:55,981 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Get Container Milestones | Tool Input: container_number=NYKU3778509 | Observation: No record found for container_number=NYKU3778509.
2026-01-21 14:17:24,613 - shipping_chatbot - INFO - User_Query: What is the status of BMOU5152604?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 14:17:26,838 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 14:17:26,861 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Get Container Milestones | Tool Input: container_number=BMOU5152604 | Observation: No record found for container_number=BMOU5152604.
2026-01-21 14:17:58,078 - shipping_chatbot - INFO - User_Query: What is the status of BMOU5152604?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 14:18:00,678 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 14:18:00,737 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Get Container Milestones | Tool Input: container_number=BMOU5152604 | Observation: No record found for container_number=BMOU5152604.
2026-01-21 14:18:18,486 - shipping_chatbot - INFO - User_Query: What is the status of HAMU3586651?, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 14:18:20,820 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['13505', '0009633', '47650', '5171', '0005172', '48392', '0030962', '5177', '0005171', '0013505', '0002566', '21103', '0001615', '5179', '0008756', '1615', '0003905', '0002569', '5176', '0037359', '0005052', '0006360', '0001363', '5056', '37359', '3905', '5053', '0001389', '0001660', '0002565', '0005176', '0028662', '3427', '0002679', '0023453', '0008579', '6804', '0004932', '25833', '0003427', '23453', '1660', '0002990', '30962', '0004991', '2569', '2679', '0030961', '47055', '37361', '1540', '0048392', '0001665', '5180', '0033523', '1665', '29594', '0037360', '28664', '0047302', '2566', '0003235', '0047650', '0029594', '0021103', '1389', '0033522', '0047055', '47302', '46854', '21472', '0015526', '8579', '1363', '6360', '3717', '0005178', '2990', '0005056', '0006804', '0027113', '4991', '0037364', '33523', '9633', '33522', '0046854', '0012041', '30961', '0005179', '37360', '0037361', '0005180', '28662', '4932', '0003717', '0021472', '27113', '5052', '37364', '0000866', '2907', '866', '0028664', '3235', '8756', '0001540', '0002907', '15526', '12041', '2565', '0025833', '5172', '0005053', '5178', '0005177']
2026-01-21 14:18:20,846 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Get Container Milestones | Tool Input: container_number=HAMU3586651 | Observation: No record found for container_number=HAMU3586651.
2026-01-21 14:29:30,750 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 14:29:30,752 - shipping_chatbot - INFO - Agent created with 4 tools
2026-01-21 14:29:30,752 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 14:29:37,574 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 14:29:37,575 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 14:29:49,725 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 14:29:49,727 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 14:29:49,800 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 14:29:50,322 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 14:29:50,469 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 14:29:50,906 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 14:29:50,910 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 14:29:50,911 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 14:29:50,934 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
2026-01-21 14:29:53,976 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['0030961', '47650', '6360', '37361', '1363', '0005180', '0037364', '0015526', '8756', '12041', '5172', '30961', '0013505', '0037361', '25833', '0005179', '0002907', '0029594', '2566', '0008756', '5179', '0006804', '0003427', '2907', '13505', '33523', '1660', '0002679', '2565', '8579', '0030962', '3427', '0027113', '0037360', '3235', '2569', '0033522', '5176', '0004932', '47302', '5053', '46854', '0005052', '866', '0001615', '0005176', '0001389', '0005172', '37360', '27113', '0047055', '30962', '0001660', '0005053', '48392', '0003235', '6804', '4932', '1389', '0002990', '0025833', '29594', '0005171', '0008579', '5052', '0003717', '37359', '0033523', '23453', '0021472', '0047302', '5056', '47055', '0002566', '0048392', '1665', '4991', '0028662', '0012041', '0002569', '2990', '33522', '0028664', '0003905', '5177', '21103', '21472', '3717', '1540', '0000866', '5171', '0021103', '0009633', '2679', '0002565', '0001540', '5180', '0005056', '28662', '0006360', '0005177', '0046854', '37364', '0004991', '3905', '0037359', '0001665', '5178', '15526', '0023453', '0047650', '1615', '0001363', '0005178', '9633', '28664']
2026-01-21 14:29:53,980 - shipping_chatbot - INFO - Analyst Engine processing query: SELECT po_number_multiple, SUM(shipped_quantity) AS total_shipped_quantity FROM dataset WHERE po_number_multiple LIKE '%5302982894%' GROUP BY po_number_multiple
2026-01-21 14:29:53,981 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 14:29:55,596 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 14:29:55,614 - shipping_chatbot - INFO - QUERY_BANK: attribute_lookup found 1 records for '5302982894' (col: po_number_multiple)
2026-01-21 14:29:56,879 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['0030961', '47650', '6360', '37361', '1363', '0005180', '0037364', '0015526', '8756', '12041', '5172', '30961', '0013505', '0037361', '25833', '0005179', '0002907', '0029594', '2566', '0008756', '5179', '0006804', '0003427', '2907', '13505', '33523', '1660', '0002679', '2565', '8579', '0030962', '3427', '0027113', '0037360', '3235', '2569', '0033522', '5176', '0004932', '47302', '5053', '46854', '0005052', '866', '0001615', '0005176', '0001389', '0005172', '37360', '27113', '0047055', '30962', '0001660', '0005053', '48392', '0003235', '6804', '4932', '1389', '0002990', '0025833', '29594', '0005171', '0008579', '5052', '0003717', '37359', '0033523', '23453', '0021472', '0047302', '5056', '47055', '0002566', '0048392', '1665', '4991', '0028662', '0012041', '0002569', '2990', '33522', '0028664', '0003905', '5177', '21103', '21472', '3717', '1540', '0000866', '5171', '0021103', '0009633', '2679', '0002565', '0001540', '5180', '0005056', '28662', '0006360', '0005177', '0046854', '37364', '0004991', '3905', '0037359', '0001665', '5178', '15526', '0023453', '0047650', '1615', '0001363', '0005178', '9633', '28664']
2026-01-21 14:29:56,882 - shipping_chatbot - INFO - Analyst Engine processing query: SELECT po_number_multiple, SUM(shipped_quantity) AS shipped_quantity FROM dataset WHERE po_number_multiple LIKE '%5302982894%' GROUP BY po_number_multiple
2026-01-21 14:29:56,882 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 14:29:57,681 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 14:29:57,700 - shipping_chatbot - INFO - QUERY_BANK: attribute_lookup found 1 records for '5302982894' (col: po_number_multiple)
2026-01-21 14:29:59,051 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['0030961', '47650', '6360', '37361', '1363', '0005180', '0037364', '0015526', '8756', '12041', '5172', '30961', '0013505', '0037361', '25833', '0005179', '0002907', '0029594', '2566', '0008756', '5179', '0006804', '0003427', '2907', '13505', '33523', '1660', '0002679', '2565', '8579', '0030962', '3427', '0027113', '0037360', '3235', '2569', '0033522', '5176', '0004932', '47302', '5053', '46854', '0005052', '866', '0001615', '0005176', '0001389', '0005172', '37360', '27113', '0047055', '30962', '0001660', '0005053', '48392', '0003235', '6804', '4932', '1389', '0002990', '0025833', '29594', '0005171', '0008579', '5052', '0003717', '37359', '0033523', '23453', '0021472', '0047302', '5056', '47055', '0002566', '0048392', '1665', '4991', '0028662', '0012041', '0002569', '2990', '33522', '0028664', '0003905', '5177', '21103', '21472', '3717', '1540', '0000866', '5171', '0021103', '0009633', '2679', '0002565', '0001540', '5180', '0005056', '28662', '0006360', '0005177', '0046854', '37364', '0004991', '3905', '0037359', '0001665', '5178', '15526', '0023453', '0047650', '1615', '0001363', '0005178', '9633', '28664']
2026-01-21 14:29:59,055 - shipping_chatbot - INFO - Analyst Engine processing query: SELECT po_number_multiple, SUM(shipped_quantity) AS shipped_quantity FROM dataset WHERE po_number_multiple LIKE '%5302982894%'
2026-01-21 14:29:59,055 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 14:29:59,978 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 14:29:59,993 - shipping_chatbot - INFO - QUERY_BANK: attribute_lookup found 1 records for '5302982894' (col: po_number_multiple)
2026-01-21 14:30:01,064 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: SELECT po_number_multiple, SUM(shipped_quantity) AS total_shipped_quantity FROM dataset WHERE po_number_multiple LIKE '%5302982894%' GROUP BY po_number_multiple | Observation: | container_number   |   po_number_multiple |
|:-------------------|---------------------:|
| TCKU1255049        |           5302982894 |
2026-01-21 14:30:01,064 - shipping_chatbot - INFO - AGENT_STEP: 2 | Tool Used: Analyze Data with Pandas | Tool Input: SELECT po_number_multiple, SUM(shipped_quantity) AS shipped_quantity FROM dataset WHERE po_number_multiple LIKE '%5302982894%' GROUP BY po_number_multiple | Observation: | container_number   |   po_number_multiple |
|:-------------------|---------------------:|
| TCKU1255049        |           5302982894 |
2026-01-21 14:30:01,064 - shipping_chatbot - INFO - AGENT_STEP: 3 | Tool Used: Analyze Data with Pandas | Tool Input: SELECT po_number_multiple, SUM(shipped_quantity) AS shipped_quantity FROM dataset WHERE po_number_multiple LIKE '%5302982894%' | Observation: | container_number   |   po_number_multiple |
|:-------------------|---------------------:|
| TCKU1255049        |           5302982894 |
2026-01-21 14:31:48,795 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#5302982894, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 14:31:51,334 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['0030961', '47650', '6360', '37361', '1363', '0005180', '0037364', '0015526', '8756', '12041', '5172', '30961', '0013505', '0037361', '25833', '0005179', '0002907', '0029594', '2566', '0008756', '5179', '0006804', '0003427', '2907', '13505', '33523', '1660', '0002679', '2565', '8579', '0030962', '3427', '0027113', '0037360', '3235', '2569', '0033522', '5176', '0004932', '47302', '5053', '46854', '0005052', '866', '0001615', '0005176', '0001389', '0005172', '37360', '27113', '0047055', '30962', '0001660', '0005053', '48392', '0003235', '6804', '4932', '1389', '0002990', '0025833', '29594', '0005171', '0008579', '5052', '0003717', '37359', '0033523', '23453', '0021472', '0047302', '5056', '47055', '0002566', '0048392', '1665', '4991', '0028662', '0012041', '0002569', '2990', '33522', '0028664', '0003905', '5177', '21103', '21472', '3717', '1540', '0000866', '5171', '0021103', '0009633', '2679', '0002565', '0001540', '5180', '0005056', '28662', '0006360', '0005177', '0046854', '37364', '0004991', '3905', '0037359', '0001665', '5178', '15526', '0023453', '0047650', '1615', '0001363', '0005178', '9633', '28664']
2026-01-21 14:31:51,338 - shipping_chatbot - INFO - Analyst Engine processing query: SELECT po_number_multiple, cargo_received_date_multiple FROM dataset WHERE po_number_multiple LIKE '%5302982894%'
2026-01-21 14:31:51,338 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 14:31:52,955 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 14:31:52,971 - shipping_chatbot - INFO - QUERY_BANK: attribute_lookup found 1 records for '5302982894' (col: po_number_multiple)
2026-01-21 14:31:54,038 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['0030961', '47650', '6360', '37361', '1363', '0005180', '0037364', '0015526', '8756', '12041', '5172', '30961', '0013505', '0037361', '25833', '0005179', '0002907', '0029594', '2566', '0008756', '5179', '0006804', '0003427', '2907', '13505', '33523', '1660', '0002679', '2565', '8579', '0030962', '3427', '0027113', '0037360', '3235', '2569', '0033522', '5176', '0004932', '47302', '5053', '46854', '0005052', '866', '0001615', '0005176', '0001389', '0005172', '37360', '27113', '0047055', '30962', '0001660', '0005053', '48392', '0003235', '6804', '4932', '1389', '0002990', '0025833', '29594', '0005171', '0008579', '5052', '0003717', '37359', '0033523', '23453', '0021472', '0047302', '5056', '47055', '0002566', '0048392', '1665', '4991', '0028662', '0012041', '0002569', '2990', '33522', '0028664', '0003905', '5177', '21103', '21472', '3717', '1540', '0000866', '5171', '0021103', '0009633', '2679', '0002565', '0001540', '5180', '0005056', '28662', '0006360', '0005177', '0046854', '37364', '0004991', '3905', '0037359', '0001665', '5178', '15526', '0023453', '0047650', '1615', '0001363', '0005178', '9633', '28664']
2026-01-21 14:31:54,041 - shipping_chatbot - INFO - Analyst Engine processing query: SELECT po_number_multiple, cargo_received_date_multiple FROM dataset WHERE po_number_multiple LIKE '%5302982894%'
2026-01-21 14:31:54,041 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 14:31:54,877 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 14:31:54,900 - shipping_chatbot - INFO - QUERY_BANK: attribute_lookup found 1 records for '5302982894' (col: po_number_multiple)
2026-01-21 14:31:56,075 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['0030961', '47650', '6360', '37361', '1363', '0005180', '0037364', '0015526', '8756', '12041', '5172', '30961', '0013505', '0037361', '25833', '0005179', '0002907', '0029594', '2566', '0008756', '5179', '0006804', '0003427', '2907', '13505', '33523', '1660', '0002679', '2565', '8579', '0030962', '3427', '0027113', '0037360', '3235', '2569', '0033522', '5176', '0004932', '47302', '5053', '46854', '0005052', '866', '0001615', '0005176', '0001389', '0005172', '37360', '27113', '0047055', '30962', '0001660', '0005053', '48392', '0003235', '6804', '4932', '1389', '0002990', '0025833', '29594', '0005171', '0008579', '5052', '0003717', '37359', '0033523', '23453', '0021472', '0047302', '5056', '47055', '0002566', '0048392', '1665', '4991', '0028662', '0012041', '0002569', '2990', '33522', '0028664', '0003905', '5177', '21103', '21472', '3717', '1540', '0000866', '5171', '0021103', '0009633', '2679', '0002565', '0001540', '5180', '0005056', '28662', '0006360', '0005177', '0046854', '37364', '0004991', '3905', '0037359', '0001665', '5178', '15526', '0023453', '0047650', '1615', '0001363', '0005178', '9633', '28664']
2026-01-21 14:31:56,078 - shipping_chatbot - INFO - Analyst Engine processing query: SELECT cargo_received_date_multiple FROM dataset WHERE po_number_multiple LIKE '%5302982894%'
2026-01-21 14:31:56,078 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 14:31:56,981 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 14:31:57,000 - shipping_chatbot - INFO - QUERY_BANK: attribute_lookup found 1 records for '5302982894' (col: cargo_received_date_multiple)
2026-01-21 14:31:58,033 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: SELECT po_number_multiple, cargo_received_date_multiple FROM dataset WHERE po_number_multiple LIKE '%5302982894%' | Observation: | container_number   |   po_number_multiple |
|:-------------------|---------------------:|
| TCKU1255049        |           5302982894 |
2026-01-21 14:31:58,033 - shipping_chatbot - INFO - AGENT_STEP: 2 | Tool Used: Analyze Data with Pandas | Tool Input: SELECT po_number_multiple, cargo_received_date_multiple FROM dataset WHERE po_number_multiple LIKE '%5302982894%' | Observation: | container_number   |   po_number_multiple |
|:-------------------|---------------------:|
| TCKU1255049        |           5302982894 |
2026-01-21 14:31:58,033 - shipping_chatbot - INFO - AGENT_STEP: 3 | Tool Used: Analyze Data with Pandas | Tool Input: SELECT cargo_received_date_multiple FROM dataset WHERE po_number_multiple LIKE '%5302982894%' | Observation: | container_number   |   po_number_multiple | cargo_received_date_multiple   |
|:-------------------|---------------------:|:-------------------------------|
| TCKU1255049        |           5302982894 | 2025-10-20 00:00:00            |
2026-01-21 14:32:25,758 - shipping_chatbot - INFO - User_Query: what is the container no, consignee_code: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 14:32:28,288 - shipping_chatbot - INFO - Consignee filtering validated: 12624 rows for codes ['0030961', '47650', '6360', '37361', '1363', '0005180', '0037364', '0015526', '8756', '12041', '5172', '30961', '0013505', '0037361', '25833', '0005179', '0002907', '0029594', '2566', '0008756', '5179', '0006804', '0003427', '2907', '13505', '33523', '1660', '0002679', '2565', '8579', '0030962', '3427', '0027113', '0037360', '3235', '2569', '0033522', '5176', '0004932', '47302', '5053', '46854', '0005052', '866', '0001615', '0005176', '0001389', '0005172', '37360', '27113', '0047055', '30962', '0001660', '0005053', '48392', '0003235', '6804', '4932', '1389', '0002990', '0025833', '29594', '0005171', '0008579', '5052', '0003717', '37359', '0033523', '23453', '0021472', '0047302', '5056', '47055', '0002566', '0048392', '1665', '4991', '0028662', '0012041', '0002569', '2990', '33522', '0028664', '0003905', '5177', '21103', '21472', '3717', '1540', '0000866', '5171', '0021103', '0009633', '2679', '0002565', '0001540', '5180', '0005056', '28662', '0006360', '0005177', '0046854', '37364', '0004991', '3905', '0037359', '0001665', '5178', '15526', '0023453', '0047650', '1615', '0001363', '0005178', '9633', '28664']
2026-01-21 14:32:28,292 - shipping_chatbot - INFO - Analyst Engine processing query: select container_number from dataset where po_number_multiple like '%5302982894%'
2026-01-21 14:32:28,292 - shipping_chatbot - INFO - QUERY_BANK: Attempting LLM Intent Classification
2026-01-21 14:32:29,899 - shipping_chatbot - INFO - QUERY_BANK: LLM Matched 'attribute_lookup'
2026-01-21 14:32:29,914 - shipping_chatbot - INFO - QUERY_BANK: attribute_lookup found 1 records for '5302982894' (col: container_number)
2026-01-21 14:32:30,868 - shipping_chatbot - INFO - AGENT_STEP: 1 | Tool Used: Analyze Data with Pandas | Tool Input: select container_number from dataset where po_number_multiple like '%5302982894%' | Observation: | container_number   |   po_number_multiple |
|:-------------------|---------------------:|
| TCKU1255049        |           5302982894 |
2026-01-21 14:39:27,551 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 14:39:39,694 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 14:39:39,697 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 14:39:39,794 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 14:39:40,567 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 14:39:40,783 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 14:39:41,281 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 14:39:41,281 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 14:39:41,281 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 14:39:41,308 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
