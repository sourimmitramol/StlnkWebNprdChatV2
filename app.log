2026-01-19 09:39:34,020 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 09:39:34,020 - shipping_chatbot - INFO - Agent created with 52 tools
2026-01-19 09:39:34,025 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 09:49:30,426 - shipping_chatbot - INFO - User_Query: What is status of 5302997239?, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-19 09:49:30,426 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-19 09:50:49,830 - shipping_chatbot - INFO - Fetched 19073 rows
2026-01-19 09:50:49,830 - shipping_chatbot - INFO - Starting preprocessing on 19073 rows
2026-01-19 09:50:49,965 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-19 09:50:51,030 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-19 09:50:51,266 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-19 09:50:51,997 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-19 09:50:51,997 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-19 09:50:51,997 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-19 09:50:52,055 - shipping_chatbot - INFO - Pre-processing finished - 19073 rows remain
2026-01-19 09:50:56,046 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302997239
2026-01-19 09:50:56,180 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-19 09:52:08,580 - shipping_chatbot - INFO - User_Query: What is status of PO 5302997239?, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-19 09:52:12,124 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302997239
2026-01-19 09:52:12,242 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-19 10:43:46,551 - shipping_chatbot - INFO - User_Query: What are the POs in the container TCLU4703170?, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-19 10:43:49,714 - shipping_chatbot - INFO - [get_booking_details] Received query: 'container TCLU4703170'
2026-01-19 10:43:49,714 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=TCLU4703170, po=None, obl=None, booking=None
2026-01-19 10:46:38,180 - shipping_chatbot - INFO - User_Query: What is the container carrying the PO 5302997239?, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-19 10:46:40,912 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Extracted: container=None, po=5302997239, obl=None, is_lookup=False
2026-01-19 10:46:40,994 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] PO lookup: po_norm=5302997239, found 1 rows
2026-01-19 10:46:40,999 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Returning 1 supplier record(s) for PO 5302997239
2026-01-19 10:47:57,531 - shipping_chatbot - INFO - User_Query: What are the POs arriving in Los Angeles?, c_codes: ['0000866']
2026-01-19 10:48:00,612 - shipping_chatbot - INFO - [get_upcoming_pos] Period: next 7 days (default), Dates: 2026-01-19 to 2026-01-26
2026-01-19 10:48:00,662 - shipping_chatbot - INFO - [get_upcoming_pos] Found BARE port code: USLAX (matched in discharge_port)
2026-01-19 10:48:00,662 - shipping_chatbot - INFO - [get_upcoming_pos] After discharge_port filter (USLAX): 26 rows
2026-01-19 10:48:00,662 - shipping_chatbot - INFO - [get_upcoming_pos] Sample discharge ports after filter: ['LOS ANGELES, CA(USLAX)', 'LOS ANGELES, CA(USLAX)', 'LOS ANGELES, CA(USLAX)', 'LOS ANGELES, CA(USLAX)', 'LOS ANGELES, CA(USLAX)']
2026-01-19 10:48:00,662 - shipping_chatbot - INFO - [get_upcoming_pos] Returning 26 PO records
2026-01-19 10:50:23,863 - shipping_chatbot - INFO - User_Query: Please provide the shipment status of 5302970007, c_codes: ['0001540']
2026-01-19 10:50:26,640 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302970007
2026-01-19 10:50:26,643 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-19 10:55:16,244 - shipping_chatbot - INFO - User_Query: Please provide the shipment status of 5302970007, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-19 10:55:19,183 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302970007
2026-01-19 10:55:19,261 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-19 10:58:25,455 - shipping_chatbot - INFO - User_Query: List out any delay shipments in Augest, c_codes: ['0000866']
2026-01-19 10:58:28,259 - shipping_chatbot - INFO - [get_delayed_containers] Query: 'delayed shipments in August 2025', consignee_code: None
2026-01-19 10:58:28,259 - shipping_chatbot - INFO - [get_delayed_containers] Time filter: August 2025 (2025-08-01 to 2025-08-31)
2026-01-19 10:58:28,349 - shipping_chatbot - INFO - [get_delayed_containers] After time filter: 229 containers
2026-01-19 11:00:31,046 - shipping_chatbot - INFO - User_Query: What is the consignee of 5302943326, c_codes: ['0002990']
2026-01-19 11:00:33,882 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Extracted: container=None, po=5302943326, obl=None, is_lookup=False
2026-01-19 11:00:33,887 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] PO lookup: po_norm=5302943326, found 1 rows
2026-01-19 11:00:33,891 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Returning 1 supplier record(s) for PO 5302943326
2026-01-19 11:02:38,124 - shipping_chatbot - INFO - User_Query: Booking number of 5302943326, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-19 11:02:40,819 - shipping_chatbot - INFO - [get_booking_details] Received query: '5302943326'
2026-01-19 11:02:40,819 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=5302943326, obl=None, booking=None
2026-01-19 11:08:04,344 - shipping_chatbot - INFO - User_Query: What containers depature from CNSHA today, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-19 11:08:07,117 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Extracted: container=None, po=None, obl=None, is_booking_query=False
2026-01-19 11:08:07,117 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Extracted load_port: 'CNSHA'
2026-01-19 11:08:07,122 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Time window: 2026-01-19 00:00:00 to 2026-01-19 00:00:00 (today), is_booking_query=False
2026-01-19 11:08:07,208 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] After _df() consignee filter: 12654 rows
2026-01-19 11:08:07,208 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Thread consignee codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-19 11:08:07,284 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Code match 'CNSHA': 587 rows
2026-01-19 11:08:07,295 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Returning 4 records (is_booking_query=False)
2026-01-19 11:11:52,141 - shipping_chatbot - INFO - User_Query: What containers depature from CNSHA today, c_codes: ['0000866', '0040070']
2026-01-19 11:11:54,827 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Extracted: container=None, po=None, obl=None, is_booking_query=False
2026-01-19 11:11:54,827 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Extracted load_port: 'CNSHA'
2026-01-19 11:11:54,827 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Time window: 2026-01-19 00:00:00 to 2026-01-19 00:00:00 (today), is_booking_query=False
2026-01-19 11:11:54,894 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] After _df() consignee filter: 3578 rows
2026-01-19 11:11:54,894 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Thread consignee codes: ['0000866', '0040070']
2026-01-19 11:11:54,917 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Code match 'CNSHA': 115 rows
2026-01-19 11:11:54,929 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Returning 8 records (is_booking_query=False)
2026-01-19 11:20:17,382 - shipping_chatbot - INFO - User_Query: What containers depature from Shanghai China today, c_codes: ['0000866', '0040070']
2026-01-19 11:20:20,314 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Extracted: container=None, po=None, obl=None, is_booking_query=False
2026-01-19 11:20:20,314 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Extracted load_port: 'SHANGHAI'
2026-01-19 11:20:20,315 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Time window: 2026-01-19 00:00:00 to 2026-01-19 00:00:00 (today), is_booking_query=False
2026-01-19 11:20:20,391 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] After _df() consignee filter: 3578 rows
2026-01-19 11:20:20,391 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Thread consignee codes: ['0000866', '0040070']
2026-01-19 11:20:20,416 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Exact name match 'SHANGHAI': 115 rows
2026-01-19 11:20:20,435 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Returning 8 records (is_booking_query=False)
2026-01-19 11:22:03,274 - shipping_chatbot - INFO - User_Query: How many will be depature today from CNSHA, c_codes: ['0000866', '0040070']
2026-01-19 11:22:06,149 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Extracted: container=None, po=None, obl=None, is_booking_query=False
2026-01-19 11:22:06,149 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Extracted load_port: 'CNSHA'
2026-01-19 11:22:06,149 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Time window: 2026-01-19 00:00:00 to 2026-01-19 00:00:00 (today), is_booking_query=False
2026-01-19 11:22:06,222 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] After _df() consignee filter: 3578 rows
2026-01-19 11:22:06,237 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Thread consignee codes: ['0000866', '0040070']
2026-01-19 11:22:06,281 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Code match 'CNSHA': 115 rows
2026-01-19 11:22:06,293 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Returning 8 records (is_booking_query=False)
2026-01-19 11:44:55,277 - shipping_chatbot - INFO - User_Query: what are the po containing HMMU9056839, c_codes: ['0000866', '0040070', '0028664']
2026-01-19 11:44:58,169 - shipping_chatbot - INFO - [get_booking_details] Received query: 'container HMMU9056839'
2026-01-19 11:44:58,169 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=HMMU9056839, po=None, obl=None, booking=None
2026-01-19 12:07:01,332 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 12:07:01,332 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 12:07:01,332 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 12:13:36,348 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#5302982894, c_codes: ['0000866', '0040070', '0028664']
2026-01-19 12:13:36,348 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-19 12:13:51,004 - shipping_chatbot - INFO - Fetched 19073 rows
2026-01-19 12:13:51,020 - shipping_chatbot - INFO - Starting preprocessing on 19073 rows
2026-01-19 12:13:51,104 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-19 12:13:51,943 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-19 12:13:52,152 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-19 12:13:52,770 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-19 12:13:52,770 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-19 12:13:52,770 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-19 12:13:52,826 - shipping_chatbot - INFO - Pre-processing finished - 19073 rows remain
2026-01-19 12:15:16,267 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#6300139937, c_codes: ['0000866', '0040070', '0028664']
2026-01-19 12:15:19,157 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 6300139937
2026-01-19 12:33:34,945 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 12:33:34,945 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 12:33:34,945 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 12:34:00,932 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#6300139937, c_codes: ['0000866', '0040070', '0028664']
2026-01-19 12:34:00,932 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-19 12:34:18,056 - shipping_chatbot - INFO - Fetched 19073 rows
2026-01-19 12:34:18,073 - shipping_chatbot - INFO - Starting preprocessing on 19073 rows
2026-01-19 12:34:18,189 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-19 12:34:19,206 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-19 12:34:19,489 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-19 12:34:20,362 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-19 12:34:20,364 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-19 12:34:20,364 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-19 12:34:20,396 - shipping_chatbot - INFO - Pre-processing finished - 19073 rows remain
2026-01-19 12:34:24,243 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 6300139937
2026-01-19 12:34:40,300 - shipping_chatbot - INFO - Router: Set consignee codes ['0000866', '0040070', '0028664'] for query: Cargo ready date for PO#6300139937
2026-01-19 12:34:40,367 - shipping_chatbot - INFO - Consignee filtering validated: 5919 rows for codes ['0000866', '0040070', '0028664']
2026-01-19 12:35:13,109 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#6300139937, c_codes: ['0000866', '0040070', '0028664']
2026-01-19 12:35:17,186 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 6300139937
2026-01-19 12:36:10,920 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#6300139937, c_codes: ['0000866', '0040070', '0028664']
2026-01-19 12:36:16,685 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 6300139937
2026-01-19 12:38:27,852 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 12:38:27,852 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 12:38:27,853 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 12:38:32,255 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 12:38:32,257 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 12:38:32,257 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 12:41:12,376 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 12:41:12,376 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 12:41:12,376 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 12:42:10,763 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#6300139937, c_codes: ['0000866', '0040070', '0028664']
2026-01-19 12:42:10,763 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-19 12:43:16,525 - shipping_chatbot - INFO - Fetched 19073 rows
2026-01-19 12:43:16,529 - shipping_chatbot - INFO - Starting preprocessing on 19073 rows
2026-01-19 12:43:16,625 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-19 12:43:17,492 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-19 12:43:17,722 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-19 12:43:18,501 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-19 12:43:18,501 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-19 12:43:18,503 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-19 12:43:18,547 - shipping_chatbot - INFO - Pre-processing finished - 19073 rows remain
2026-01-19 12:43:24,675 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 6300139937
2026-01-19 12:46:09,834 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 12:46:09,834 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 12:46:09,834 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 12:46:51,002 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#6300139937, c_codes: ['0000866', '0040070', '0028664']
2026-01-19 12:46:51,002 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-19 12:47:03,809 - shipping_chatbot - INFO - Fetched 19073 rows
2026-01-19 12:47:03,809 - shipping_chatbot - INFO - Starting preprocessing on 19073 rows
2026-01-19 12:47:03,915 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-19 12:47:04,729 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-19 12:47:05,007 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-19 12:47:05,855 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-19 12:47:05,857 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-19 12:47:05,859 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-19 12:47:05,904 - shipping_chatbot - INFO - Pre-processing finished - 19073 rows remain
2026-01-19 12:47:10,981 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 6300139937
2026-01-19 12:47:10,997 - shipping_chatbot - ERROR - Agent failed: 'list' object has no attribute 'strip'
Traceback (most recent call last):
  File "D:\chatbot16012026\StlnkWebNprdChatV2\api\main.py", line 291, in ask
    output = (result.get("output") or "").strip()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'strip'
2026-01-19 12:47:11,038 - shipping_chatbot - INFO - Router: Set consignee codes ['0000866', '0040070', '0028664'] for query: Cargo ready date for PO#6300139937
2026-01-19 12:47:11,112 - shipping_chatbot - INFO - Consignee filtering validated: 5919 rows for codes ['0000866', '0040070', '0028664']
2026-01-19 12:48:34,450 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#6300139937, c_codes: ['0000866', '0040070', '0028664']
2026-01-19 12:48:39,835 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 6300139937
2026-01-19 12:48:39,839 - shipping_chatbot - ERROR - Agent failed: 'list' object has no attribute 'strip'
Traceback (most recent call last):
  File "D:\chatbot16012026\StlnkWebNprdChatV2\api\main.py", line 291, in ask
    output = (result.get("output") or "").strip()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'strip'
2026-01-19 12:48:39,839 - shipping_chatbot - INFO - Router: Set consignee codes ['0000866', '0040070', '0028664'] for query: Cargo ready date for PO#6300139937
2026-01-19 12:48:39,904 - shipping_chatbot - INFO - Consignee filtering validated: 5919 rows for codes ['0000866', '0040070', '0028664']
2026-01-19 12:49:08,730 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 12:49:08,730 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 12:49:08,730 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 12:49:12,342 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#6300139937, c_codes: ['0000866', '0040070', '0028664']
2026-01-19 12:49:12,342 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-19 12:49:29,515 - shipping_chatbot - INFO - Fetched 19073 rows
2026-01-19 12:49:29,515 - shipping_chatbot - INFO - Starting preprocessing on 19073 rows
2026-01-19 12:49:29,632 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-19 12:49:30,432 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-19 12:49:30,658 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-19 12:49:31,548 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-19 12:49:31,548 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-19 12:49:31,548 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-19 12:49:31,605 - shipping_chatbot - INFO - Pre-processing finished - 19073 rows remain
2026-01-19 12:49:36,913 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 6300139937
2026-01-19 12:49:49,578 - shipping_chatbot - INFO - Router: Set consignee codes ['0000866', '0040070', '0028664'] for query: Cargo ready date for PO#6300139937
2026-01-19 12:49:49,650 - shipping_chatbot - INFO - Consignee filtering validated: 5919 rows for codes ['0000866', '0040070', '0028664']
2026-01-19 12:50:13,924 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#6300139937, c_codes: ['0000866', '0040070', '0028664']
2026-01-19 12:50:21,615 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 6300139937
2026-01-19 12:52:22,792 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#5302836671, c_codes: ['0000866', '0040070', '0028664']
2026-01-19 12:52:27,757 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 5302836671
2026-01-19 13:00:50,188 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#5302853164, c_codes: ['0025833']
2026-01-19 13:00:54,695 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 5302853164
2026-01-19 13:10:27,776 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#5302836671, c_codes: ['0043881', '0000866']
2026-01-19 13:10:32,366 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 5302836671
2026-01-19 13:11:56,522 - shipping_chatbot - INFO - User_Query: Booking number of 5302943326, c_codes: ['0043881', '0000866']
2026-01-19 13:11:59,472 - shipping_chatbot - INFO - [get_booking_details] Received query: '5302943326'
2026-01-19 13:11:59,474 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=5302943326, obl=None, booking=None
2026-01-19 13:12:00,451 - shipping_chatbot - INFO - [get_booking_details] Received query: 'PO 5302943326'
2026-01-19 13:12:00,451 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=5302943326, obl=None, booking=None
2026-01-19 13:12:37,915 - shipping_chatbot - INFO - User_Query: Booking number of 5302943326, c_codes: ['0043881', '0000866', '0002990']
2026-01-19 13:12:40,673 - shipping_chatbot - INFO - [get_booking_details] Received query: '5302943326'
2026-01-19 13:12:40,673 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=5302943326, obl=None, booking=None
2026-01-19 13:14:22,166 - shipping_chatbot - INFO - User_Query: What is the shipper for PO#5302982894, c_codes: ['0043881', '0000866', '0002990', '0002907']
2026-01-19 13:14:25,409 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Extracted: container=None, po=5302982894, obl=None, is_lookup=False
2026-01-19 13:14:25,428 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] PO lookup: po_norm=5302982894, found 1 rows
2026-01-19 13:14:25,432 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Returning 1 supplier record(s) for PO 5302982894
2026-01-19 13:14:40,271 - shipping_chatbot - INFO - Router: Set consignee codes ['0043881', '0000866', '0002990', '0002907'] for query: What is the shipper for PO#5302982894
2026-01-19 13:14:40,326 - shipping_chatbot - INFO - Consignee filtering validated: 3531 rows for codes ['0043881', '0000866', '0002990', '0002907']
2026-01-19 13:14:40,374 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Extracted: container=None, po=5302982894, obl=None, is_lookup=True
2026-01-19 13:14:40,396 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] PO lookup: po_norm=5302982894, found 1 rows
2026-01-19 13:14:40,398 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Returning 1 supplier record(s) for PO 5302982894
2026-01-19 13:15:16,944 - shipping_chatbot - INFO - User_Query: What is the shipper for PO#5302982894, c_codes: ['0043881', '0000866', '0002990', '0002907']
2026-01-19 13:15:19,890 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Extracted: container=None, po=5302982894, obl=None, is_lookup=False
2026-01-19 13:15:19,909 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] PO lookup: po_norm=5302982894, found 1 rows
2026-01-19 13:15:19,909 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Returning 1 supplier record(s) for PO 5302982894
2026-01-19 13:15:34,356 - shipping_chatbot - INFO - Router: Set consignee codes ['0043881', '0000866', '0002990', '0002907'] for query: What is the shipper for PO#5302982894
2026-01-19 13:15:34,434 - shipping_chatbot - INFO - Consignee filtering validated: 3531 rows for codes ['0043881', '0000866', '0002990', '0002907']
2026-01-19 13:15:34,509 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Extracted: container=None, po=5302982894, obl=None, is_lookup=True
2026-01-19 13:15:34,526 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] PO lookup: po_norm=5302982894, found 1 rows
2026-01-19 13:15:34,526 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Returning 1 supplier record(s) for PO 5302982894
2026-01-19 13:16:30,660 - shipping_chatbot - INFO - User_Query: What is the shipper for PO 5302982894, c_codes: ['0043881', '0000866', '0002990', '0002907']
2026-01-19 13:16:33,629 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Extracted: container=None, po=5302982894, obl=None, is_lookup=False
2026-01-19 13:16:33,650 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] PO lookup: po_norm=5302982894, found 1 rows
2026-01-19 13:16:33,654 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Returning 1 supplier record(s) for PO 5302982894
2026-01-19 13:16:48,615 - shipping_chatbot - INFO - Router: Set consignee codes ['0043881', '0000866', '0002990', '0002907'] for query: What is the shipper for PO 5302982894
2026-01-19 13:16:48,679 - shipping_chatbot - INFO - Consignee filtering validated: 3531 rows for codes ['0043881', '0000866', '0002990', '0002907']
2026-01-19 13:16:48,746 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Extracted: container=None, po=5302982894, obl=None, is_lookup=True
2026-01-19 13:16:48,767 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] PO lookup: po_norm=5302982894, found 1 rows
2026-01-19 13:16:48,767 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Returning 1 supplier record(s) for PO 5302982894
2026-01-19 14:02:09,782 - shipping_chatbot - INFO - User_Query: What is the shipper for PO 5302982894, c_codes: ['0043881', '0000866', '0002990', '0002907']
2026-01-19 14:02:13,080 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Extracted: container=None, po=5302982894, obl=None, is_lookup=False
2026-01-19 14:02:13,097 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] PO lookup: po_norm=5302982894, found 1 rows
2026-01-19 14:02:13,105 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Returning 1 supplier record(s) for PO 5302982894
2026-01-19 14:06:02,791 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 14:06:02,791 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 14:06:02,791 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 14:06:07,497 - shipping_chatbot - INFO - User_Query: What is the shipper for PO 5302982894, c_codes: ['0043881', '0000866', '0002990', '0002907']
2026-01-19 14:06:07,497 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-19 14:06:56,235 - shipping_chatbot - INFO - Fetched 19073 rows
2026-01-19 14:06:56,242 - shipping_chatbot - INFO - Starting preprocessing on 19073 rows
2026-01-19 14:06:56,345 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-19 14:06:57,031 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-19 14:06:57,246 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-19 14:06:58,041 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-19 14:06:58,041 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-19 14:06:58,052 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-19 14:06:58,098 - shipping_chatbot - INFO - Pre-processing finished - 19073 rows remain
2026-01-19 14:07:01,454 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Extracted: container=None, po=5302982894, obl=None, is_lookup=False
2026-01-19 14:07:01,482 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] PO lookup: po_norm=5302982894, found 1 rows
2026-01-19 14:07:01,486 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Returning 1 supplier record(s) for PO 5302982894
2026-01-19 14:07:01,490 - shipping_chatbot - ERROR - Agent failed: 'list' object has no attribute 'strip'
Traceback (most recent call last):
  File "D:\chatbot16012026\StlnkWebNprdChatV2\api\main.py", line 291, in ask
    output = (result.get("output") or "").strip()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'strip'
2026-01-19 14:07:01,547 - shipping_chatbot - INFO - Router: Set consignee codes ['0043881', '0000866', '0002990', '0002907'] for query: What is the shipper for PO 5302982894
2026-01-19 14:07:01,633 - shipping_chatbot - INFO - Consignee filtering validated: 3531 rows for codes ['0043881', '0000866', '0002990', '0002907']
2026-01-19 14:07:01,704 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Extracted: container=None, po=5302982894, obl=None, is_lookup=True
2026-01-19 14:07:01,726 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] PO lookup: po_norm=5302982894, found 1 rows
2026-01-19 14:07:01,728 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Returning 1 supplier record(s) for PO 5302982894
2026-01-19 14:11:09,790 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 14:11:09,790 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 14:11:09,790 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 14:11:17,003 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 14:11:17,006 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 14:11:17,006 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 14:11:24,553 - shipping_chatbot - INFO - User_Query: What is the shipper for PO 5302982894, c_codes: ['0043881', '0000866', '0002990', '0002907']
2026-01-19 14:11:24,562 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-19 14:11:41,929 - shipping_chatbot - INFO - Fetched 19073 rows
2026-01-19 14:11:41,939 - shipping_chatbot - INFO - Starting preprocessing on 19073 rows
2026-01-19 14:11:42,062 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-19 14:11:43,206 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-19 14:11:43,421 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-19 14:11:44,646 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-19 14:11:44,646 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-19 14:11:44,646 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-19 14:11:44,696 - shipping_chatbot - INFO - Pre-processing finished - 19073 rows remain
2026-01-19 14:11:48,306 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Extracted: container=None, po=5302982894, obl=None, is_lookup=False
2026-01-19 14:11:48,332 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] PO lookup: po_norm=5302982894, found 1 rows
2026-01-19 14:11:48,341 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Returning 1 supplier record(s) for PO 5302982894
2026-01-19 14:13:21,902 - shipping_chatbot - INFO - User_Query: What is status of 5302997239?, c_codes: ['0043881', '0000866', '0002990', '0002907']
2026-01-19 14:13:25,445 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302997239
2026-01-19 14:13:25,506 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-19 14:14:00,659 - shipping_chatbot - INFO - User_Query: What are the POs in the container TCLU4703170?, c_codes: ['0043881', '0000866', '0002990', '0002907']
2026-01-19 14:14:03,781 - shipping_chatbot - INFO - [get_booking_details] Received query: 'container TCLU4703170'
2026-01-19 14:14:03,781 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=TCLU4703170, po=None, obl=None, booking=None
2026-01-19 14:14:55,386 - shipping_chatbot - INFO - User_Query: What is the container carrying the PO 5302997239?, c_codes: ['0043881', '0000866', '0002990', '0002907']
2026-01-19 14:14:59,095 - shipping_chatbot - INFO - [get_booking_details] Received query: 'PO 5302997239'
2026-01-19 14:14:59,095 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=5302997239, obl=None, booking=None
2026-01-19 14:15:28,781 - shipping_chatbot - INFO - User_Query: What are the POs arriving in Los Angeles?, c_codes: ['0043881', '0000866', '0002990', '0002907']
2026-01-19 14:15:31,968 - shipping_chatbot - INFO - [get_upcoming_pos] Period: next 7 days (default), Dates: 2026-01-19 to 2026-01-26
2026-01-19 14:15:32,062 - shipping_chatbot - INFO - [get_upcoming_pos] Found BARE port code: USLAX (matched in discharge_port)
2026-01-19 14:15:32,062 - shipping_chatbot - INFO - [get_upcoming_pos] After discharge_port filter (USLAX): 42 rows
2026-01-19 14:15:32,065 - shipping_chatbot - INFO - [get_upcoming_pos] Sample discharge ports after filter: ['LOS ANGELES, CA(USLAX)', 'LOS ANGELES, CA(USLAX)', 'LOS ANGELES, CA(USLAX)', 'LOS ANGELES, CA(USLAX)', 'LOS ANGELES, CA(USLAX)']
2026-01-19 14:15:32,065 - shipping_chatbot - INFO - [get_upcoming_pos] Returning 42 PO records
2026-01-19 14:16:54,781 - shipping_chatbot - INFO - User_Query: Please provide the shipment status of 5302970007, c_codes: ['0043881', '0000866', '0002990', '0002907', '0001540']
2026-01-19 14:16:58,247 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302970007
2026-01-19 14:16:58,309 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-19 14:17:54,464 - shipping_chatbot - INFO - User_Query: List out any delay shipments in December 2025, c_codes: ['0043881', '0000866']
2026-01-19 14:17:57,604 - shipping_chatbot - INFO - [get_delayed_containers] Query: 'delayed shipments in December 2025', consignee_code: None
2026-01-19 14:17:57,606 - shipping_chatbot - INFO - [get_delayed_containers] Time filter: December 2025 (2025-12-01 to 2025-12-31)
2026-01-19 14:17:57,691 - shipping_chatbot - INFO - [get_delayed_containers] After time filter: 218 containers
2026-01-19 14:21:19,691 - shipping_chatbot - INFO - User_Query: What is the consignee of 5302943326, c_codes: ['0043881', '0000866', '0002990']
2026-01-19 14:21:23,256 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Extracted: container=None, po=5302943326, obl=None, is_lookup=False
2026-01-19 14:21:23,308 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] PO lookup: po_norm=5302943326, found 1 rows
2026-01-19 14:21:23,315 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Returning 1 supplier record(s) for PO 5302943326
2026-01-19 14:22:16,085 - shipping_chatbot - INFO - User_Query: What is the consignee of 5302943326, c_codes: ['0043881', '0000866', '0002990']
2026-01-19 14:22:19,602 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Extracted: container=None, po=5302943326, obl=None, is_lookup=False
2026-01-19 14:22:19,639 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] PO lookup: po_norm=5302943326, found 1 rows
2026-01-19 14:22:19,643 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Returning 1 supplier record(s) for PO 5302943326
2026-01-19 14:23:41,636 - shipping_chatbot - INFO - User_Query: Booking number of 5302943326, c_codes: ['0043881', '0000866', '0002990']
2026-01-19 14:23:44,837 - shipping_chatbot - INFO - [get_booking_details] Received query: '5302943326'
2026-01-19 14:23:44,837 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=5302943326, obl=None, booking=None
2026-01-19 14:24:40,171 - shipping_chatbot - INFO - User_Query: What containers depature from CNSHA today, c_codes: ['0000866']
2026-01-19 14:24:43,687 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Extracted: container=None, po=None, obl=None, is_booking_query=False
2026-01-19 14:24:43,687 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Extracted load_port: 'CNSHA'
2026-01-19 14:24:43,692 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Time window: 2026-01-19 00:00:00 to 2026-01-19 00:00:00 (today), is_booking_query=False
2026-01-19 14:24:43,770 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] After _df() consignee filter: 2107 rows
2026-01-19 14:24:43,770 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Thread consignee codes: ['0000866']
2026-01-19 14:24:43,790 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Code match 'CNSHA': 63 rows
2026-01-19 14:24:43,805 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Returning 4 records (is_booking_query=False)
2026-01-19 14:25:42,631 - shipping_chatbot - INFO - User_Query: How many will be depature today from CNSHA, c_codes: ['0000866']
2026-01-19 14:25:45,788 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Extracted: container=None, po=None, obl=None, is_booking_query=False
2026-01-19 14:25:45,788 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Extracted load_port: 'CNSHA'
2026-01-19 14:25:45,794 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Time window: 2026-01-19 00:00:00 to 2026-01-19 00:00:00 (today), is_booking_query=False
2026-01-19 14:25:45,934 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] After _df() consignee filter: 2107 rows
2026-01-19 14:25:45,934 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Thread consignee codes: ['0000866']
2026-01-19 14:25:45,971 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Code match 'CNSHA': 63 rows
2026-01-19 14:25:45,986 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Returning 4 records (is_booking_query=False)
2026-01-19 14:26:26,655 - shipping_chatbot - INFO - User_Query: How many containers will be depature today from shanghai, c_codes: ['0000866']
2026-01-19 14:26:29,796 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Extracted: container=None, po=None, obl=None, is_booking_query=False
2026-01-19 14:26:29,796 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Extracted load_port: 'SHANGHAI'
2026-01-19 14:26:29,796 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Time window: 2026-01-19 00:00:00 to 2026-01-19 00:00:00 (today), is_booking_query=False
2026-01-19 14:26:29,939 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] After _df() consignee filter: 2107 rows
2026-01-19 14:26:29,939 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Thread consignee codes: ['0000866']
2026-01-19 14:26:29,970 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Exact name match 'SHANGHAI': 63 rows
2026-01-19 14:26:29,988 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Returning 4 records (is_booking_query=False)
2026-01-19 14:27:43,017 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#5302982894, c_codes: ['0002907']
2026-01-19 14:27:46,624 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 5302982894
2026-01-19 14:28:18,495 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#5302982894, c_codes: ['0002907']
2026-01-19 14:28:22,220 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 5302982894
2026-01-19 14:28:36,033 - shipping_chatbot - INFO - Router: Set consignee codes ['0002907'] for query: Cargo ready date for PO#5302982894
2026-01-19 14:28:36,135 - shipping_chatbot - INFO - Consignee filtering validated: 402 rows for codes ['0002907']
2026-01-19 14:28:48,090 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#5302982894, c_codes: ['0002907']
2026-01-19 14:28:52,331 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 5302982894
2026-01-19 14:31:43,104 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#5302975704, c_codes: ['0002907']
2026-01-19 14:31:47,028 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 5302975704
2026-01-19 14:34:31,614 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#UR01-PON-25090002453, c_codes: ['0021547']
2026-01-19 14:35:25,995 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#5302972528, c_codes: ['0025833']
2026-01-19 14:35:30,148 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 5302972528
2026-01-19 14:37:50,301 - shipping_chatbot - INFO - User_Query: What is the shipper for PO#5302982894, c_codes: ['0025833', '0002907']
2026-01-19 14:37:54,081 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Extracted: container=None, po=5302982894, obl=None, is_lookup=False
2026-01-19 14:37:54,095 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] PO lookup: po_norm=5302982894, found 1 rows
2026-01-19 14:37:54,095 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Returning 1 supplier record(s) for PO 5302982894
2026-01-19 14:38:54,973 - shipping_chatbot - INFO - User_Query: What is the supplier for PO#5302982894, c_codes: ['0025833', '0002907']
2026-01-19 14:38:58,079 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Extracted: container=None, po=5302982894, obl=None, is_lookup=False
2026-01-19 14:38:58,108 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] PO lookup: po_norm=5302982894, found 1 rows
2026-01-19 14:38:58,117 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Returning 1 supplier record(s) for PO 5302982894
2026-01-19 14:43:53,442 - shipping_chatbot - INFO - User_Query: What is the status of TCLU9332787?, c_codes: ['0025833', '0002907', '0005053']
2026-01-19 14:45:15,506 - shipping_chatbot - INFO - User_Query: What is the last milestone of TCLU9332787?, c_codes: ['0025833', '0002907', '0005053']
2026-01-19 14:47:02,363 - shipping_chatbot - INFO - User_Query: Will container UETU4079469 be moved via Rail?, c_codes: ['0025833', '0002907', '0005053', '0000866']
2026-01-19 14:47:18,064 - shipping_chatbot - INFO - User_Query: Will container UETU4079469 be moved via Rail?, c_codes: ['0025833', '0002907', '0005053', '0000866']
2026-01-19 14:47:42,557 - shipping_chatbot - INFO - User_Query: Will container UETU4079469 be moved via Rail?, c_codes: ['0000866']
2026-01-19 14:49:29,504 - shipping_chatbot - INFO - User_Query: Which containers have arrived DP but not yet to final destination?, c_codes: ['0000866']
2026-01-19 14:49:32,917 - shipping_chatbot - INFO - Processing natural language query: Select container_number from shipments where ata_dp is not null and (ata_fd is null or ata_fd = '')
2026-01-19 14:49:36,659 - shipping_chatbot - ERROR - Failed to process natural language query: 1 validation error for SQLDatabaseToolkit
db
  instance of SQLDatabase expected (type=type_error.arbitrary_type; expected_arbitrary_type=SQLDatabase)
Traceback (most recent call last):
  File "D:\chatbot16012026\StlnkWebNprdChatV2\agents\tools.py", line 7035, in sql_query_tool
    sql_agent = initialize_sql_agent()
                ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot16012026\StlnkWebNprdChatV2\agents\azure_agent.py", line 95, in initialize_sql_agent
    sql_agent_executor = create_sql_agent(
                         ^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_community\agent_toolkits\sql\base.py", line 139, in create_sql_agent
    toolkit = toolkit or SQLDatabaseToolkit(llm=llm, db=db)  # type: ignore[arg-type]
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\pydantic\v1\main.py", line 347, in __init__
    raise validation_error
pydantic.v1.error_wrappers.ValidationError: 1 validation error for SQLDatabaseToolkit
db
  instance of SQLDatabase expected (type=type_error.arbitrary_type; expected_arbitrary_type=SQLDatabase)
2026-01-19 14:49:37,855 - shipping_chatbot - INFO - Processing natural language query: Select container_number from shipments where ata_dp is not null and (ata_fd is null or ata_fd = '')
2026-01-19 14:49:41,358 - shipping_chatbot - ERROR - Failed to process natural language query: 1 validation error for SQLDatabaseToolkit
db
  instance of SQLDatabase expected (type=type_error.arbitrary_type; expected_arbitrary_type=SQLDatabase)
Traceback (most recent call last):
  File "D:\chatbot16012026\StlnkWebNprdChatV2\agents\tools.py", line 7035, in sql_query_tool
    sql_agent = initialize_sql_agent()
                ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot16012026\StlnkWebNprdChatV2\agents\azure_agent.py", line 95, in initialize_sql_agent
    sql_agent_executor = create_sql_agent(
                         ^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_community\agent_toolkits\sql\base.py", line 139, in create_sql_agent
    toolkit = toolkit or SQLDatabaseToolkit(llm=llm, db=db)  # type: ignore[arg-type]
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\pydantic\v1\main.py", line 347, in __init__
    raise validation_error
pydantic.v1.error_wrappers.ValidationError: 1 validation error for SQLDatabaseToolkit
db
  instance of SQLDatabase expected (type=type_error.arbitrary_type; expected_arbitrary_type=SQLDatabase)
2026-01-19 15:08:46,148 - shipping_chatbot - INFO - User_Query: Which containers are going to WEST JEFFERSON, OH in Oct, c_codes: ['0042485', '0045831']
2026-01-19 15:08:49,652 - shipping_chatbot - INFO - [get_containers_by_final_destination] Received query: 'containers arriving at WEST JEFFERSON, OH in October 2025'
2026-01-19 15:08:49,654 - shipping_chatbot - INFO - 
 days: 7
2026-01-19 15:08:49,654 - shipping_chatbot - INFO - [get_containers_by_final_destination] parsed_n_days=7 today=2026-01-19 end_date=2026-01-26
2026-01-19 15:08:49,794 - shipping_chatbot - INFO - Location = None
2026-01-19 15:14:47,388 - shipping_chatbot - INFO - User_Query: Which containers are going to WEST JEFFERSON, OH in Nov, c_codes: ['0042485', '0045831']
2026-01-19 15:14:51,120 - shipping_chatbot - INFO - [get_containers_by_final_destination] Received query: 'containers arriving at WEST JEFFERSON, OH in November 2025'
2026-01-19 15:14:51,120 - shipping_chatbot - INFO - 
 days: 7
2026-01-19 15:14:51,120 - shipping_chatbot - INFO - [get_containers_by_final_destination] parsed_n_days=7 today=2026-01-19 end_date=2026-01-26
2026-01-19 15:14:51,263 - shipping_chatbot - INFO - Location = None
2026-01-19 15:16:11,849 - shipping_chatbot - INFO - User_Query: Which containers are going to WEST JEFFERSON, OH in dec, c_codes: ['0042485', '0045831']
2026-01-19 15:16:15,493 - shipping_chatbot - INFO - [get_containers_by_final_destination] Received query: 'containers arriving at WEST JEFFERSON, OH in December 2025'
2026-01-19 15:16:15,493 - shipping_chatbot - INFO - 
 days: 7
2026-01-19 15:16:15,493 - shipping_chatbot - INFO - [get_containers_by_final_destination] parsed_n_days=7 today=2026-01-19 end_date=2026-01-26
2026-01-19 15:16:15,628 - shipping_chatbot - INFO - Location = None
2026-01-19 15:30:44,645 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 15:30:44,645 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 15:30:44,645 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 15:30:51,521 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 15:30:51,521 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 15:30:51,521 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 15:31:30,101 - shipping_chatbot - INFO - User_Query: Which containers are going to WEST JEFFERSON, OH in dec, c_codes: ['0042485', '0045831']
2026-01-19 15:31:30,101 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-19 15:31:48,544 - shipping_chatbot - INFO - Fetched 19073 rows
2026-01-19 15:31:48,551 - shipping_chatbot - INFO - Starting preprocessing on 19073 rows
2026-01-19 15:31:48,683 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-19 15:31:49,832 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-19 15:31:50,189 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-19 15:31:51,250 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-19 15:31:51,254 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-19 15:31:51,254 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-19 15:31:51,317 - shipping_chatbot - INFO - Pre-processing finished - 19073 rows remain
2026-01-19 15:31:54,348 - shipping_chatbot - INFO - [get_containers_by_final_destination] Processing query: containers arriving at WEST JEFFERSON, OH in December 2025
2026-01-19 15:31:54,348 - shipping_chatbot - INFO - [get_containers_by_final_destination] Time window: 2025-12-01 00:00:00 to 2025-12-01 00:00:00 (December 1, 2025)
2026-01-19 15:31:54,441 - shipping_chatbot - INFO - [get_containers_by_final_destination] Available date columns: ['predictive_eta_fd', 'revised_eta_fd', 'eta_fd']
2026-01-19 15:32:15,558 - shipping_chatbot - INFO - Router: Set consignee codes ['0042485', '0045831'] for query: Which containers are going to WEST JEFFERSON, OH in dec
2026-01-19 15:32:15,642 - shipping_chatbot - INFO - Consignee filtering validated: 1561 rows for codes ['0042485', '0045831']
2026-01-19 15:33:22,363 - shipping_chatbot - INFO - User_Query: Which containers are going to WEST JEFFERSON, OH in dec, c_codes: ['0042485', '0045831']
2026-01-19 15:33:26,094 - shipping_chatbot - INFO - [get_containers_by_final_destination] Processing query: containers arriving at WEST JEFFERSON, OH in December 2025
2026-01-19 15:33:26,097 - shipping_chatbot - INFO - [get_containers_by_final_destination] Time window: 2025-12-01 00:00:00 to 2025-12-01 00:00:00 (December 1, 2025)
2026-01-19 15:33:26,239 - shipping_chatbot - INFO - [get_containers_by_final_destination] Available date columns: ['predictive_eta_fd', 'revised_eta_fd', 'eta_fd']
2026-01-19 15:33:41,690 - shipping_chatbot - INFO - [get_containers_by_final_destination] Processing query: containers arriving at WEST JEFFERSON, OH in December 2025
2026-01-19 15:33:41,690 - shipping_chatbot - INFO - [get_containers_by_final_destination] Time window: 2025-12-01 00:00:00 to 2025-12-01 00:00:00 (December 1, 2025)
2026-01-19 15:33:41,805 - shipping_chatbot - INFO - [get_containers_by_final_destination] Available date columns: ['predictive_eta_fd', 'revised_eta_fd', 'eta_fd']
2026-01-19 15:33:43,993 - shipping_chatbot - INFO - Router: Set consignee codes ['0042485', '0045831'] for query: Which containers are going to WEST JEFFERSON, OH in dec
2026-01-19 15:33:44,118 - shipping_chatbot - INFO - Consignee filtering validated: 1561 rows for codes ['0042485', '0045831']
2026-01-19 15:33:55,161 - shipping_chatbot - INFO - User_Query: Which containers are going to WEST JEFFERSON, OH in dec, c_codes: ['0042485', '0045831']
2026-01-19 15:33:58,533 - shipping_chatbot - INFO - [get_containers_by_final_destination] Processing query: containers arriving at WEST JEFFERSON, OH in December 2025
2026-01-19 15:33:58,533 - shipping_chatbot - INFO - [get_containers_by_final_destination] Time window: 2025-12-01 00:00:00 to 2025-12-01 00:00:00 (December 1, 2025)
2026-01-19 15:33:58,654 - shipping_chatbot - INFO - [get_containers_by_final_destination] Available date columns: ['predictive_eta_fd', 'revised_eta_fd', 'eta_fd']
2026-01-19 15:34:17,211 - shipping_chatbot - INFO - Router: Set consignee codes ['0042485', '0045831'] for query: Which containers are going to WEST JEFFERSON, OH in dec
2026-01-19 15:34:17,351 - shipping_chatbot - INFO - Consignee filtering validated: 1561 rows for codes ['0042485', '0045831']
2026-01-19 15:46:33,124 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 15:46:33,124 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 15:46:33,124 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 15:46:48,321 - shipping_chatbot - INFO - User_Query: Which containers are going to WEST JEFFERSON, OH in dec, c_codes: ['0042485', '0045831']
2026-01-19 15:46:48,321 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-19 15:47:02,744 - shipping_chatbot - INFO - Fetched 19073 rows
2026-01-19 15:47:02,744 - shipping_chatbot - INFO - Starting preprocessing on 19073 rows
2026-01-19 15:47:02,859 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-19 15:47:03,474 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-19 15:47:03,757 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-19 15:47:04,437 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-19 15:47:04,441 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-19 15:47:04,441 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-19 15:47:04,463 - shipping_chatbot - INFO - Pre-processing finished - 19073 rows remain
2026-01-19 15:47:07,444 - shipping_chatbot - INFO - [get_containers_by_final_destination] Processing query: containers arriving at WEST JEFFERSON, OH in December 2025
2026-01-19 15:47:07,445 - shipping_chatbot - INFO - [get_containers_by_final_destination] Time window: 2025-12-01 00:00:00 to 2025-12-01 00:00:00 (December 1, 2025)
2026-01-19 15:47:07,491 - shipping_chatbot - INFO - [get_containers_by_final_destination] Initial dataset: 1561 rows
2026-01-19 15:47:07,491 - shipping_chatbot - INFO - [get_containers_by_final_destination] Available date columns: ['predictive_eta_fd', 'revised_eta_fd', 'eta_fd', 'delivery_date_to_consignee']
2026-01-19 15:47:07,507 - shipping_chatbot - INFO - [get_containers_by_final_destination] Extracted FD location: 'WEST JEFFERSON', code: 'None'
2026-01-19 15:47:07,515 - shipping_chatbot - INFO - [get_containers_by_final_destination] Exact name match: 0 matches
2026-01-19 15:47:07,516 - shipping_chatbot - INFO - [get_containers_by_final_destination] Word-based match: 482 matches
2026-01-19 15:47:07,527 - shipping_chatbot - INFO - [get_containers_by_final_destination] Found 482 containers after FD filter
2026-01-19 15:47:07,530 - shipping_chatbot - INFO - [get_containers_by_final_destination] Found 1 containers after date filter
2026-01-19 15:47:07,543 - shipping_chatbot - INFO - [get_containers_by_final_destination] Returning 1 containers with summary stats
2026-01-19 16:00:01,021 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 16:00:01,021 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 16:00:01,021 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 16:00:32,747 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 16:00:32,763 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 16:00:32,763 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 16:00:36,986 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 16:00:36,986 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 16:00:36,986 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 16:10:49,941 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 16:10:49,941 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 16:10:49,941 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 16:18:03,012 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 16:18:03,014 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 16:18:03,014 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 16:18:07,199 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 16:18:07,199 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 16:18:07,199 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 16:18:13,769 - shipping_chatbot - INFO - User_Query: Which containers are going to WEST JEFFERSON, OH in dec, c_codes: ['0042485', '0045831']
2026-01-19 16:18:13,771 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-19 16:18:29,694 - shipping_chatbot - INFO - Fetched 19073 rows
2026-01-19 16:18:29,698 - shipping_chatbot - INFO - Starting preprocessing on 19073 rows
2026-01-19 16:18:29,779 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-19 16:18:30,578 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-19 16:18:30,847 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-19 16:18:31,424 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-19 16:18:31,424 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-19 16:18:31,428 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-19 16:18:31,458 - shipping_chatbot - INFO - Pre-processing finished - 19073 rows remain
2026-01-19 16:18:35,163 - shipping_chatbot - INFO - [get_containers_by_final_destination] Processing query: containers arriving at WEST JEFFERSON, OH in December 2025
2026-01-19 16:18:35,163 - shipping_chatbot - INFO - [get_containers_by_final_destination] Time window: 2025-12-01 00:00:00 to 2025-12-01 00:00:00 (December 1, 2025)
2026-01-19 16:18:35,231 - shipping_chatbot - INFO - [get_containers_by_final_destination] Initial dataset: 1561 rows
2026-01-19 16:18:35,232 - shipping_chatbot - INFO - [get_containers_by_final_destination] Available date columns: ['eta_fd', 'delivery_date_to_consignee']
2026-01-19 16:18:35,236 - shipping_chatbot - INFO - [get_containers_by_final_destination] Extracted FD location: 'WEST JEFFERSON', code: 'None'
2026-01-19 16:18:35,243 - shipping_chatbot - INFO - [get_containers_by_final_destination] Exact name match: 0 matches
2026-01-19 16:18:35,249 - shipping_chatbot - INFO - [get_containers_by_final_destination] Word-based match: 482 matches
2026-01-19 16:18:35,254 - shipping_chatbot - INFO - [get_containers_by_final_destination] Found 482 containers after FD filter
2026-01-19 16:18:35,257 - shipping_chatbot - INFO - [get_containers_by_final_destination] Found 1 containers after date filter
2026-01-19 16:18:35,266 - shipping_chatbot - INFO - [get_containers_by_final_destination] Returning 1 containers with summary stats
2026-01-19 16:23:29,675 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 16:23:29,675 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 16:23:29,675 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 16:31:03,843 - shipping_chatbot - INFO - User_Query: Which containers are going to WEST JEFFERSON, OH in dec, c_codes: ['0042485', '0045831']
2026-01-19 16:31:03,843 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-19 16:31:25,017 - shipping_chatbot - INFO - Fetched 19073 rows
2026-01-19 16:31:25,020 - shipping_chatbot - INFO - Starting preprocessing on 19073 rows
2026-01-19 16:31:25,119 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-19 16:31:25,880 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-19 16:31:26,135 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-19 16:31:26,855 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-19 16:31:26,855 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-19 16:31:26,855 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-19 16:31:26,897 - shipping_chatbot - INFO - Pre-processing finished - 19073 rows remain
2026-01-19 16:31:30,818 - shipping_chatbot - INFO - [get_containers_by_final_destination] Processing query: containers arriving at WEST JEFFERSON, OH in December 2025
2026-01-19 16:31:30,818 - shipping_chatbot - INFO - [get_containers_by_final_destination] Time window: 2025-12-01 00:00:00 to 2025-12-01 00:00:00 (December 1, 2025)
2026-01-19 16:31:30,884 - shipping_chatbot - INFO - [get_containers_by_final_destination] Initial dataset: 1561 rows
2026-01-19 16:31:30,884 - shipping_chatbot - INFO - [get_containers_by_final_destination] Available date columns: ['eta_fd', 'delivery_date_to_consignee']
2026-01-19 16:31:30,884 - shipping_chatbot - INFO - [get_containers_by_final_destination] Extracted FD location: 'WEST JEFFERSON', code: 'None'
2026-01-19 16:31:30,901 - shipping_chatbot - INFO - [get_containers_by_final_destination] Exact name match: 0 matches
2026-01-19 16:31:30,910 - shipping_chatbot - INFO - [get_containers_by_final_destination] Word-based match: 482 matches
2026-01-19 16:31:30,910 - shipping_chatbot - INFO - [get_containers_by_final_destination] Found 482 containers after FD filter
2026-01-19 16:31:30,921 - shipping_chatbot - INFO - [get_containers_by_final_destination] Found 1 containers after date filter
2026-01-19 16:31:30,924 - shipping_chatbot - INFO - [get_containers_by_final_destination] Returning 1 containers with summary stats
2026-01-19 16:34:36,112 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 16:34:36,112 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 16:34:36,112 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 16:34:40,095 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 16:34:40,095 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 16:34:40,095 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 16:34:43,694 - shipping_chatbot - INFO - User_Query: Which containers are going to WEST JEFFERSON, OH in dec, c_codes: ['0042485', '0045831']
2026-01-19 16:34:43,694 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-19 16:35:02,863 - shipping_chatbot - INFO - Fetched 19073 rows
2026-01-19 16:35:02,863 - shipping_chatbot - INFO - Starting preprocessing on 19073 rows
2026-01-19 16:35:02,950 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-19 16:35:03,663 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-19 16:35:03,845 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-19 16:35:04,494 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-19 16:35:04,494 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-19 16:35:04,494 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-19 16:35:04,531 - shipping_chatbot - INFO - Pre-processing finished - 19073 rows remain
2026-01-19 16:35:07,877 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: December 1, 2025, Dates: 2025-12-01 to 2025-12-01, is_past=True
2026-01-19 16:35:07,968 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found city location: WEST JEFFERSON (normalized: WEST JEFFERSON)
2026-01-19 16:35:10,109 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: December 1, 2025, Dates: 2025-12-01 to 2025-12-01, is_past=True
2026-01-19 16:35:12,276 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: December 1, 2025, Dates: 2025-12-01 to 2025-12-01, is_past=True
2026-01-19 16:35:12,370 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found city location: WEST JEFFERSON (normalized: WEST JEFFERSON)
2026-01-19 16:36:21,857 - shipping_chatbot - INFO - User_Query: Which containers are going to WEST JEFFERSON, OH in dec, c_codes: ['0042485', '0045831']
2026-01-19 16:36:25,434 - shipping_chatbot - INFO - [get_containers_by_final_destination] Received query: 'containers arriving at WEST JEFFERSON, OH in December 2025'
2026-01-19 16:36:25,434 - shipping_chatbot - INFO - 
 days: 7
2026-01-19 16:36:25,442 - shipping_chatbot - INFO - [get_containers_by_final_destination] parsed_n_days=7 today=2026-01-19 end_date=2026-01-26
2026-01-19 16:36:25,490 - shipping_chatbot - INFO - Location = None
2026-01-19 16:44:06,770 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 16:44:06,771 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 16:44:06,771 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 16:45:21,772 - shipping_chatbot - INFO - User_Query: Which containers are going to WEST JEFFERSON, OH in dec, c_codes: ['0042485', '0045831']
2026-01-19 16:45:21,772 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-19 16:45:42,261 - shipping_chatbot - INFO - Fetched 19073 rows
2026-01-19 16:45:42,262 - shipping_chatbot - INFO - Starting preprocessing on 19073 rows
2026-01-19 16:45:42,377 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-19 16:45:43,146 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-19 16:45:43,345 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-19 16:45:44,046 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-19 16:45:44,046 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-19 16:45:44,046 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-19 16:45:44,092 - shipping_chatbot - INFO - Pre-processing finished - 19073 rows remain
2026-01-19 16:45:47,379 - shipping_chatbot - INFO - [get_containers_by_final_destination] Processing query: containers arriving at WEST JEFFERSON, OH in December 2025
2026-01-19 16:45:47,379 - shipping_chatbot - INFO - [get_containers_by_final_destination] Time window: 2025-12-01 00:00:00 to 2025-12-01 00:00:00 (December 1, 2025)
2026-01-19 16:45:47,480 - shipping_chatbot - INFO - [get_containers_by_final_destination] Initial dataset: 1561 rows
2026-01-19 16:45:47,480 - shipping_chatbot - INFO - [get_containers_by_final_destination] Using eta_fd column only
2026-01-19 16:45:47,480 - shipping_chatbot - INFO - [get_containers_by_final_destination] Extracted FD location: 'WEST JEFFERSON', code: 'None'
2026-01-19 16:45:47,480 - shipping_chatbot - INFO - [get_containers_by_final_destination] Exact name match: 0 matches
2026-01-19 16:45:47,502 - shipping_chatbot - INFO - [get_containers_by_final_destination] Word-based match: 482 matches
2026-01-19 16:45:47,508 - shipping_chatbot - INFO - [get_containers_by_final_destination] Found 482 containers after FD filter
2026-01-19 16:45:47,510 - shipping_chatbot - INFO - [get_containers_by_final_destination] Found 0 containers after date filter (using eta_fd only)
2026-01-19 16:51:33,814 - shipping_chatbot - INFO - User_Query: Any containers delayed on Oct?, c_codes: ['0042485', '0045831']
2026-01-19 16:51:36,993 - shipping_chatbot - INFO - [get_delayed_containers] Query: 'delayed in October 2025', consignee_code: None
2026-01-19 16:51:36,993 - shipping_chatbot - INFO - [get_delayed_containers] Time filter: October 2025 (2025-10-01 to 2025-10-31)
2026-01-19 16:51:37,128 - shipping_chatbot - INFO - [get_delayed_containers] After time filter: 141 containers
2026-01-19 17:24:17,270 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-19 17:24:17,270 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-19 17:24:17,270 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-19 17:24:40,795 - shipping_chatbot - INFO - User_Query: Which containers are going to WEST JEFFERSON, OH in Oct, c_codes: ['0042485', '0045831']
2026-01-19 17:24:40,795 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-19 17:24:57,853 - shipping_chatbot - INFO - Fetched 19073 rows
2026-01-19 17:24:57,856 - shipping_chatbot - INFO - Starting preprocessing on 19073 rows
2026-01-19 17:24:57,963 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-19 17:24:58,756 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-19 17:24:58,922 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-19 17:24:59,488 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-19 17:24:59,488 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-19 17:24:59,488 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-19 17:24:59,526 - shipping_chatbot - INFO - Pre-processing finished - 19073 rows remain
2026-01-19 17:25:03,754 - shipping_chatbot - INFO - [get_containers_by_final_destination] Processing query: containers arriving at WEST JEFFERSON, OH in October 2025
2026-01-19 17:25:03,754 - shipping_chatbot - INFO - [get_containers_by_final_destination] Time window: 2025-10-01 00:00:00 to 2025-10-31 00:00:00 (October 2025)
2026-01-19 17:25:03,822 - shipping_chatbot - INFO - [get_containers_by_final_destination] Initial dataset: 1561 rows
2026-01-19 17:25:03,823 - shipping_chatbot - INFO - [get_containers_by_final_destination] Using eta_fd column only
2026-01-19 17:25:03,823 - shipping_chatbot - INFO - [get_containers_by_final_destination] Extracted FD location: 'WEST JEFFERSON', code: 'None'
2026-01-19 17:25:03,831 - shipping_chatbot - INFO - [get_containers_by_final_destination] Exact name match: 0 matches
2026-01-19 17:25:03,840 - shipping_chatbot - INFO - [get_containers_by_final_destination] Word-based match: 482 matches
2026-01-19 17:25:03,845 - shipping_chatbot - INFO - [get_containers_by_final_destination] Found 482 containers after FD filter
2026-01-19 17:25:03,848 - shipping_chatbot - INFO - [get_containers_by_final_destination] Found 100 containers after date filter (using eta_fd only)
2026-01-19 17:25:03,848 - shipping_chatbot - INFO - [get_containers_by_final_destination] Returning 100 containers
2026-01-19 17:36:48,152 - shipping_chatbot - INFO - User_Query: Any containers delayed on Oct?, c_codes: ['0042485', '0045831']
2026-01-19 17:36:50,998 - shipping_chatbot - INFO - [get_delayed_containers] Query: 'delayed containers in October 2025', consignee_code: None
2026-01-19 17:36:50,998 - shipping_chatbot - INFO - [get_delayed_containers] Time filter: October 2025 (2025-10-01 to 2025-10-31)
2026-01-19 17:36:51,116 - shipping_chatbot - INFO - [get_delayed_containers] After time filter: 141 containers
2026-01-19 17:42:07,279 - shipping_chatbot - INFO - User_Query: What is the container number for PO#5302982894?, c_codes: ['0042485', '0045831', '0002907']
2026-01-19 17:42:10,158 - shipping_chatbot - INFO - [get_booking_details] Received query: 'PO 5302982894'
2026-01-19 17:42:10,158 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=5302982894, obl=None, booking=None
2026-01-19 17:43:41,586 - shipping_chatbot - INFO - User_Query: What are the POs arriving in Los Angeles?, c_codes: ['0042485', '0045831', '0002907']
2026-01-19 17:43:45,059 - shipping_chatbot - INFO - [get_upcoming_pos] Period: next 7 days (default), Dates: 2026-01-19 to 2026-01-26
2026-01-19 17:43:45,110 - shipping_chatbot - INFO - [get_upcoming_pos] Returning 47 PO records
2026-01-19 17:45:15,419 - shipping_chatbot - INFO - User_Query: What are the POs arriving in Los Angeles?, c_codes: ['0042485', '0045831', '0002907', '0000866']
2026-01-19 17:45:18,329 - shipping_chatbot - INFO - [get_upcoming_pos] Period: next 7 days (default), Dates: 2026-01-19 to 2026-01-26
2026-01-19 17:45:18,424 - shipping_chatbot - INFO - [get_upcoming_pos] Found BARE port code: USLAX (matched in discharge_port)
2026-01-19 17:45:18,426 - shipping_chatbot - INFO - [get_upcoming_pos] After discharge_port filter (USLAX): 26 rows
2026-01-19 17:45:18,426 - shipping_chatbot - INFO - [get_upcoming_pos] Sample discharge ports after filter: ['LOS ANGELES, CA(USLAX)', 'LOS ANGELES, CA(USLAX)', 'LOS ANGELES, CA(USLAX)', 'LOS ANGELES, CA(USLAX)', 'LOS ANGELES, CA(USLAX)']
2026-01-19 17:45:18,428 - shipping_chatbot - INFO - [get_upcoming_pos] Returning 26 PO records
2026-01-20 09:15:03,175 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 09:15:03,175 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-20 09:15:03,175 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 09:17:59,056 - shipping_chatbot - INFO - User_Query: What containers depature from Shanghai China today, c_codes: ['0000866']
2026-01-20 09:17:59,056 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-20 09:18:16,056 - shipping_chatbot - INFO - Fetched 19073 rows
2026-01-20 09:18:16,061 - shipping_chatbot - INFO - Starting preprocessing on 19073 rows
2026-01-20 09:18:16,174 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-20 09:18:17,002 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-20 09:18:17,264 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-20 09:18:18,233 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-20 09:18:18,234 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-20 09:18:18,240 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-20 09:18:18,301 - shipping_chatbot - INFO - Pre-processing finished - 19073 rows remain
2026-01-20 09:18:20,977 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Extracted: container=None, po=None, obl=None, is_booking_query=False
2026-01-20 09:18:20,979 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Extracted load_port: 'SHANGHAI'
2026-01-20 09:18:20,983 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Time window: 2026-01-20 00:00:00 to 2026-01-20 00:00:00 (today), is_booking_query=False
2026-01-20 09:18:21,079 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] After _df() consignee filter: 2107 rows
2026-01-20 09:18:21,079 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Thread consignee codes: ['0000866']
2026-01-20 09:18:21,103 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Exact name match 'SHANGHAI': 63 rows
2026-01-20 09:19:40,602 - shipping_chatbot - INFO - User_Query: Which containers are going to ENFIELD, CT in Oct, c_codes: ['0000866']
2026-01-20 09:19:43,683 - shipping_chatbot - INFO - [get_containers_by_final_destination] Processing query: containers arriving at ENFIELD, CT in October 2025
2026-01-20 09:19:43,683 - shipping_chatbot - INFO - [get_containers_by_final_destination] Time window: 2025-10-01 00:00:00 to 2025-10-31 00:00:00 (October 2025)
2026-01-20 09:19:43,789 - shipping_chatbot - INFO - [get_containers_by_final_destination] Initial dataset: 2107 rows
2026-01-20 09:19:43,790 - shipping_chatbot - INFO - [get_containers_by_final_destination] Using eta_fd column only
2026-01-20 09:19:43,793 - shipping_chatbot - INFO - [get_containers_by_final_destination] Extracted FD location: 'ENFIELD', code: 'None'
2026-01-20 09:19:43,818 - shipping_chatbot - INFO - [get_containers_by_final_destination] Exact name match: 0 matches
2026-01-20 09:19:43,835 - shipping_chatbot - INFO - [get_containers_by_final_destination] Word-based match: 0 matches
2026-01-20 09:21:33,567 - shipping_chatbot - INFO - User_Query: Which containers are going to ENFIELD, CT in Oct, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', 'and 0048627.']
2026-01-20 09:21:36,796 - shipping_chatbot - INFO - [get_containers_by_final_destination] Processing query: containers arriving at ENFIELD, CT in October 2025
2026-01-20 09:21:36,799 - shipping_chatbot - INFO - [get_containers_by_final_destination] Time window: 2025-10-01 00:00:00 to 2025-10-31 00:00:00 (October 2025)
2026-01-20 09:21:36,939 - shipping_chatbot - INFO - [get_containers_by_final_destination] Initial dataset: 5001 rows
2026-01-20 09:21:36,940 - shipping_chatbot - INFO - [get_containers_by_final_destination] Using eta_fd column only
2026-01-20 09:21:36,940 - shipping_chatbot - INFO - [get_containers_by_final_destination] Extracted FD location: 'ENFIELD', code: 'None'
2026-01-20 09:21:36,994 - shipping_chatbot - INFO - [get_containers_by_final_destination] Exact name match: 0 matches
2026-01-20 09:21:37,044 - shipping_chatbot - INFO - [get_containers_by_final_destination] Word-based match: 547 matches
2026-01-20 09:21:37,056 - shipping_chatbot - INFO - [get_containers_by_final_destination] Found 547 containers after FD filter
2026-01-20 09:21:37,059 - shipping_chatbot - INFO - [get_containers_by_final_destination] Found 38 containers after date filter (using eta_fd only)
2026-01-20 09:21:37,061 - shipping_chatbot - INFO - [get_containers_by_final_destination] Returning 38 containers
2026-01-20 09:23:04,767 - shipping_chatbot - INFO - User_Query: What is status of 5302997239?, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', 'and 0048627.']
2026-01-20 09:23:08,374 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302997239
2026-01-20 09:23:08,434 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-20 09:25:38,166 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#5302982894, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907 and 0048627.']
2026-01-20 09:27:03,305 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#5302982894, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907 and 0048627.']
2026-01-20 09:28:15,178 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#5302982894, c_codes: ['0002907']
2026-01-20 09:28:18,204 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 5302982894
2026-01-20 09:29:12,576 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#5302982894, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907 and 0048627.']
2026-01-20 09:30:01,872 - shipping_chatbot - INFO - User_Query: Cargo ready date for PO#5302982894, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-20 09:30:10,519 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 5302982894
2026-01-20 09:33:47,848 - shipping_chatbot - INFO - User_Query: List the HOT PO in Booking TH2017996, c_codes: ['0042485', '0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-20 09:33:51,186 - shipping_chatbot - INFO - [get_booking_details] Received query: 'TH2017996'
2026-01-20 09:33:51,191 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=None, obl=None, booking=TH2017996
2026-01-20 09:37:03,347 - shipping_chatbot - INFO - User_Query: please check the vendor name of 5500010589, c_codes: ['0042485', '0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-20 09:37:06,583 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Extracted: container=None, po=5500010589, obl=None, is_lookup=False
2026-01-20 09:37:06,711 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] PO lookup: po_norm=5500010589, found 0 rows
2026-01-20 09:40:43,002 - shipping_chatbot - INFO - User_Query: What is discharge port ETA of SMLU4664983, c_codes: ['0042485', '0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-20 09:42:44,498 - shipping_chatbot - INFO - User_Query: First and Mother vessel details of EG2002468, c_codes: ['0042485', '0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-20 09:42:47,909 - shipping_chatbot - INFO - [get_vessel_info] Processing input: First and Mother vessel details of EG2002468
2026-01-20 09:42:49,026 - shipping_chatbot - INFO - [get_vessel_info] Processing input: EG2002468
2026-01-20 09:42:49,169 - shipping_chatbot - INFO - [get_vessel_info] Detected as potential booking number: EG2002468
2026-01-20 09:42:49,169 - shipping_chatbot - INFO - [get_vessel_info] Attempting booking number match: EG2002468
2026-01-20 09:42:49,169 - shipping_chatbot - INFO - [get_vessel_info] Normalized booking: 'EG2002468' -> 'EG2002468'
2026-01-20 09:42:49,216 - shipping_chatbot - INFO - [get_vessel_info] Booking search results: 1 rows found
2026-01-20 09:42:49,216 - shipping_chatbot - INFO - [get_vessel_info] Sample matching bookings: ['EG2002468']
2026-01-20 09:42:49,216 - shipping_chatbot - INFO - [get_vessel_info] Found 1 record(s) for booking EG2002468
2026-01-20 09:42:49,227 - shipping_chatbot - INFO - [get_vessel_info] Returning 1 vessel record(s) for booking EG2002468
2026-01-20 09:44:24,346 - shipping_chatbot - INFO - User_Query: PO of TH2017962, c_codes: ['0042485', '0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-20 09:44:37,234 - shipping_chatbot - INFO - User_Query: PO of TH2017962, c_codes: ['0042485', '0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-20 09:45:27,122 - shipping_chatbot - INFO - User_Query: PO of TH2017962, c_codes: ['0042485']
2026-01-20 09:45:30,577 - shipping_chatbot - INFO - [get_booking_details] Received query: 'TH2017962'
2026-01-20 09:45:30,577 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=None, obl=None, booking=TH2017962
2026-01-20 09:46:28,761 - shipping_chatbot - INFO - User_Query: PO of TH2017962, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907 and 0048627.']
2026-01-20 09:46:31,548 - shipping_chatbot - INFO - [get_booking_details] Received query: 'TH2017962'
2026-01-20 09:46:31,548 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=None, obl=None, booking=TH2017962
2026-01-20 10:03:52,554 - shipping_chatbot - INFO - User_Query: What is the container number for PO#5302982894?, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907 and 0048627.']
2026-01-20 10:03:56,328 - shipping_chatbot - INFO - [get_booking_details] Received query: 'PO 5302982894'
2026-01-20 10:03:56,328 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=5302982894, obl=None, booking=None
2026-01-20 10:03:57,856 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302982894
2026-01-20 10:03:57,937 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 0 rows found
2026-01-20 10:05:19,596 - shipping_chatbot - INFO - User_Query: What is the container number for PO#5302982894?, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907 and 0048627.']
2026-01-20 10:05:23,792 - shipping_chatbot - INFO - [get_booking_details] Received query: 'PO 5302982894'
2026-01-20 10:05:23,792 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=5302982894, obl=None, booking=None
2026-01-20 10:05:25,170 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302982894
2026-01-20 10:05:25,257 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 0 rows found
2026-01-20 10:05:48,813 - shipping_chatbot - INFO - User_Query: What is the container number for PO#5302982894?, c_codes: ['0002907']
2026-01-20 10:05:52,347 - shipping_chatbot - INFO - [get_booking_details] Received query: 'PO 5302982894'
2026-01-20 10:05:52,348 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=5302982894, obl=None, booking=None
2026-01-20 10:06:19,158 - shipping_chatbot - INFO - User_Query: What is the container number for PO#5302982894?, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-20 10:06:22,600 - shipping_chatbot - INFO - [get_booking_details] Received query: 'PO 5302982894'
2026-01-20 10:06:22,600 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=5302982894, obl=None, booking=None
2026-01-20 10:08:10,572 - shipping_chatbot - INFO - User_Query: What is the container number for PO#5302982894?, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627.']
2026-01-20 10:08:13,800 - shipping_chatbot - INFO - [get_booking_details] Received query: 'PO 5302982894'
2026-01-20 10:08:13,800 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=5302982894, obl=None, booking=None
2026-01-20 10:24:25,533 - shipping_chatbot - INFO - User_Query: Which Booking is associated with PO#5300009918, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627.']
2026-01-20 10:24:28,868 - shipping_chatbot - INFO - [get_booking_details] Received query: 'PO 5300009918'
2026-01-20 10:24:28,871 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=5300009918, obl=None, booking=None
2026-01-20 10:25:52,026 - shipping_chatbot - INFO - User_Query: Which OBL is associated with PO#5300009918, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627.']
2026-01-20 10:25:55,396 - shipping_chatbot - INFO - [get_booking_details] Received query: 'PO 5300009918'
2026-01-20 10:25:55,396 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=5300009918, obl=None, booking=None
2026-01-20 10:29:44,015 - shipping_chatbot - INFO - User_Query: Which PO are associated with Booking#CN2229273?, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627.']
2026-01-20 10:29:46,992 - shipping_chatbot - INFO - [get_booking_details] Received query: 'CN2229273'
2026-01-20 10:29:46,992 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=None, obl=None, booking=CN2229273
2026-01-20 11:06:52,489 - shipping_chatbot - INFO - User_Query: Which OBL are associated with Booking#CN2229273?, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627.']
2026-01-20 11:06:55,246 - shipping_chatbot - INFO - [get_booking_details] Received query: 'CN2229273'
2026-01-20 11:06:55,247 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=None, obl=None, booking=CN2229273
2026-01-20 11:18:54,834 - shipping_chatbot - INFO - User_Query: Which PO are associated with OBL#MLGDMLWCN0001321?, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627.']
2026-01-20 11:19:48,543 - shipping_chatbot - INFO - User_Query: Which PO are associated with OBL#MLGDMLWCN0001321?, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627.']
2026-01-20 11:20:33,784 - shipping_chatbot - INFO - User_Query: Which booking are associated with OBL#MLGDMLWCN0001321?, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627.']
2026-01-20 11:23:45,321 - shipping_chatbot - INFO - User_Query: Which booking are associated with OBL#MLGDMLWCN0001321?, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627.']
2026-01-20 11:48:54,835 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 11:48:54,835 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-20 11:48:54,835 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 11:49:09,604 - shipping_chatbot - INFO - User_Query: Which booking are associated with OBL#MLGDMLWCN0001321?, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627.']
2026-01-20 11:49:09,604 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-20 11:49:28,590 - shipping_chatbot - INFO - Fetched 18991 rows
2026-01-20 11:49:28,597 - shipping_chatbot - INFO - Starting preprocessing on 18991 rows
2026-01-20 11:49:28,657 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-20 11:49:29,123 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-20 11:49:29,274 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-20 11:49:29,772 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-20 11:49:29,772 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-20 11:49:29,772 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-20 11:49:29,813 - shipping_chatbot - INFO - Pre-processing finished - 18991 rows remain
2026-01-20 11:50:15,455 - shipping_chatbot - INFO - User_Query: Which booking are associated with OBL#MLGDMLWCN0001321?, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627.']
2026-01-20 11:52:38,576 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 11:52:38,576 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-20 11:52:38,576 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 11:53:33,443 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 11:53:33,443 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-20 11:53:33,443 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 11:53:51,984 - shipping_chatbot - INFO - User_Query: Which booking are associated with OBL#MLGDMLWCN0001321?, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627.']
2026-01-20 11:53:51,984 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-20 11:54:07,569 - shipping_chatbot - INFO - Fetched 18991 rows
2026-01-20 11:54:07,571 - shipping_chatbot - INFO - Starting preprocessing on 18991 rows
2026-01-20 11:54:07,668 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-20 11:54:08,445 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-20 11:54:08,678 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-20 11:54:09,579 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-20 11:54:09,579 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-20 11:54:09,579 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-20 11:54:09,629 - shipping_chatbot - INFO - Pre-processing finished - 18991 rows remain
2026-01-20 11:54:27,428 - shipping_chatbot - INFO - User_Query: Which booking are associated with OBL#MLGDMLWCN0001321?, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627.']
2026-01-20 11:54:29,197 - shipping_chatbot - INFO - User_Query: Which booking are associated with OBL#MLGDMLWCN0001321?, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627.']
2026-01-20 11:55:27,218 - shipping_chatbot - INFO - User_Query: Which booking are associated with OBL#MUC59171015?, c_codes: ['0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627.']
2026-01-20 11:55:30,295 - shipping_chatbot - INFO - [get_containers_for_bl] matched_rows=1 date_cols=['ata_dp', 'revised_eta', 'eta_dp'] min_date=2025-11-05 00:00:00 max_date=2025-11-05 00:00:00
2026-01-20 11:55:31,204 - shipping_chatbot - INFO - [get_booking_details] Received query: 'TCLU9332787'
2026-01-20 11:55:31,204 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=TCLU9332787, po=None, obl=None, booking=None
2026-01-20 11:55:31,204 - shipping_chatbot - INFO - [get_booking_details] Intent flags: wants_booking_number=True, wants_eta=False, wants_po=False, wants_container=False, wants_bl=False
2026-01-20 11:57:07,510 - shipping_chatbot - INFO - User_Query: Which booking are associated with OBL#MLWVN0000904?, c_codes: ['0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 11:57:27,030 - shipping_chatbot - INFO - User_Query: Which booking are associated with OBL#MLWVN0000904?, c_codes: ['0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 11:59:03,691 - shipping_chatbot - INFO - User_Query: Which booking are associated with PO#5302894475?, c_codes: ['0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 11:59:06,528 - shipping_chatbot - INFO - [get_booking_details] Received query: 'PO 5302894475'
2026-01-20 11:59:06,529 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=5302894475, obl=None, booking=None
2026-01-20 11:59:06,529 - shipping_chatbot - INFO - [get_booking_details] Intent flags: wants_booking_number=True, wants_eta=False, wants_po=False, wants_container=False, wants_bl=False
2026-01-20 12:21:43,723 - shipping_chatbot - INFO - User_Query: Which Booking is associated with OBL#CN7061586?, c_codes: ['0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 12:21:46,736 - shipping_chatbot - INFO - [get_booking_details] Received query: 'CN7061586'
2026-01-20 12:21:46,736 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=None, obl=None, booking=CN7061586
2026-01-20 12:21:46,743 - shipping_chatbot - INFO - [get_booking_details] Intent flags: wants_booking_number=False, wants_eta=False, wants_po=False, wants_container=False, wants_bl=False
2026-01-20 12:23:15,289 - shipping_chatbot - INFO - User_Query: Which PO is associated with OBL#CN7061586?, c_codes: ['0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 12:29:13,692 - shipping_chatbot - INFO - User_Query: cargo ready date for PO#6300146311, c_codes: ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 12:29:20,140 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 6300146311
2026-01-20 12:45:23,108 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 12:45:23,108 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-20 12:45:23,108 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 12:45:40,223 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 12:45:40,223 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-20 12:45:40,224 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 12:45:53,697 - shipping_chatbot - INFO - User_Query: cargo ready date for PO#6300146311, c_codes: ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 12:45:53,697 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-20 12:46:09,107 - shipping_chatbot - INFO - Fetched 18991 rows
2026-01-20 12:46:09,108 - shipping_chatbot - INFO - Starting preprocessing on 18991 rows
2026-01-20 12:46:09,191 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-20 12:46:09,785 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-20 12:46:09,957 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-20 12:46:10,500 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-20 12:46:10,509 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-20 12:46:10,509 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-20 12:46:10,536 - shipping_chatbot - INFO - Pre-processing finished - 18991 rows remain
2026-01-20 12:46:17,005 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 6300146311
2026-01-20 12:50:08,122 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 12:50:08,122 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-20 12:50:08,122 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 12:50:12,792 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 12:50:12,792 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-20 12:50:12,792 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 12:50:12,807 - shipping_chatbot - INFO - User_Query: cargo ready date for PO#6300146311, c_codes: ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 12:50:12,808 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-20 12:50:27,704 - shipping_chatbot - INFO - Fetched 18991 rows
2026-01-20 12:50:27,704 - shipping_chatbot - INFO - Starting preprocessing on 18991 rows
2026-01-20 12:50:27,822 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-20 12:50:28,534 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-20 12:50:28,754 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-20 12:50:29,571 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-20 12:50:29,571 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-20 12:50:29,571 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-20 12:50:29,607 - shipping_chatbot - INFO - Pre-processing finished - 18991 rows remain
2026-01-20 12:50:35,085 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 6300146311
2026-01-20 12:54:17,731 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 12:54:17,731 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-20 12:54:17,731 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 12:54:21,588 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 12:54:21,588 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-20 12:54:21,588 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 12:57:51,838 - shipping_chatbot - INFO - User_Query: cargo ready date for PO#6300146311, c_codes: ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 12:57:51,838 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-20 12:58:07,274 - shipping_chatbot - INFO - Fetched 18991 rows
2026-01-20 12:58:07,277 - shipping_chatbot - INFO - Starting preprocessing on 18991 rows
2026-01-20 12:58:07,404 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-20 12:58:08,490 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-20 12:58:08,844 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-20 12:58:09,943 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-20 12:58:09,945 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-20 12:58:09,946 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-20 12:58:10,003 - shipping_chatbot - INFO - Pre-processing finished - 18991 rows remain
2026-01-20 12:58:18,255 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 6300146311
2026-01-20 13:09:14,490 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 13:09:14,491 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-20 13:09:14,491 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 13:09:18,684 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 13:09:18,685 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-20 13:09:18,685 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 13:09:24,821 - shipping_chatbot - INFO - User_Query: cargo ready date for PO#6300146311, c_codes: ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 13:09:24,821 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-20 13:09:39,817 - shipping_chatbot - INFO - Fetched 18991 rows
2026-01-20 13:09:39,820 - shipping_chatbot - INFO - Starting preprocessing on 18991 rows
2026-01-20 13:09:39,915 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-20 13:09:40,678 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-20 13:09:40,896 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-20 13:09:41,786 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-20 13:09:41,786 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-20 13:09:41,786 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-20 13:09:41,828 - shipping_chatbot - INFO - Pre-processing finished - 18991 rows remain
2026-01-20 13:09:50,147 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 1 records with filters: PO: 6300146311
2026-01-20 13:12:24,150 - shipping_chatbot - INFO - User_Query: cargo ready date for PO#5302835997, c_codes: ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 13:12:30,608 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 4 records with filters: PO: 5302835997
2026-01-20 13:12:55,283 - shipping_chatbot - INFO - Router: Set consignee codes ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.'] for query: cargo ready date for PO#5302835997
2026-01-20 13:12:55,334 - shipping_chatbot - INFO - Consignee filtering validated: 7972 rows for codes ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 13:14:38,382 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 13:14:38,382 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-20 13:14:38,382 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 13:14:38,397 - shipping_chatbot - INFO - User_Query: cargo ready date for PO#5302835997, c_codes: ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 13:14:38,398 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-20 13:14:52,800 - shipping_chatbot - INFO - Fetched 18991 rows
2026-01-20 13:14:52,810 - shipping_chatbot - INFO - Starting preprocessing on 18991 rows
2026-01-20 13:14:52,903 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-20 13:14:53,476 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-20 13:14:53,658 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-20 13:14:54,275 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-20 13:14:54,285 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-20 13:14:54,285 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-20 13:14:54,313 - shipping_chatbot - INFO - Pre-processing finished - 18991 rows remain
2026-01-20 13:15:02,973 - shipping_chatbot - INFO - [get_cargo_ready_date] Returning 4 records with filters: PO: 5302835997
2026-01-20 14:07:53,243 - shipping_chatbot - INFO - User_Query: Which containers are arrived at HAMBURG in Oct, c_codes: ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 14:07:56,976 - shipping_chatbot - INFO - [get_arrivals_by_port] Period: October 2025, Dates: 2025-10-01 to 2025-10-31
2026-01-20 14:10:11,386 - shipping_chatbot - INFO - User_Query: Which containers are arrived at HAMBURG in Oct, c_codes: ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 14:10:14,762 - shipping_chatbot - INFO - [get_arrivals_by_port] Period: October 2025, Dates: 2025-10-01 to 2025-10-31
2026-01-20 14:14:06,651 - shipping_chatbot - INFO - User_Query: Which containers are going to ENFIELD, CT in Oct, c_codes: ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 14:14:10,560 - shipping_chatbot - INFO - [get_containers_by_final_destination] Processing query: containers arriving at ENFIELD, CT in October 2025
2026-01-20 14:14:10,560 - shipping_chatbot - INFO - [get_containers_by_final_destination] Time window: 2025-10-01 00:00:00 to 2025-10-31 00:00:00 (October 2025)
2026-01-20 14:14:10,709 - shipping_chatbot - INFO - [get_containers_by_final_destination] Initial dataset: 7972 rows
2026-01-20 14:14:10,709 - shipping_chatbot - INFO - [get_containers_by_final_destination] Using eta_fd column only
2026-01-20 14:14:10,709 - shipping_chatbot - INFO - [get_containers_by_final_destination] Extracted FD location: 'ENFIELD', code: 'None'
2026-01-20 14:14:10,811 - shipping_chatbot - INFO - [get_containers_by_final_destination] Exact name match: 0 matches
2026-01-20 14:14:10,893 - shipping_chatbot - INFO - [get_containers_by_final_destination] Word-based match: 545 matches
2026-01-20 14:14:10,914 - shipping_chatbot - INFO - [get_containers_by_final_destination] Found 545 containers after FD filter
2026-01-20 14:14:10,914 - shipping_chatbot - INFO - [get_containers_by_final_destination] Found 38 containers after date filter (using eta_fd only)
2026-01-20 14:14:10,923 - shipping_chatbot - INFO - [get_containers_by_final_destination] Returning 38 containers
2026-01-20 14:23:44,240 - shipping_chatbot - INFO - User_Query: What is the ETA of booking VN2092736, c_codes: ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 14:24:07,518 - shipping_chatbot - INFO - Router: Set consignee codes ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.'] for query: What is the ETA of booking VN2092736
2026-01-20 14:24:07,647 - shipping_chatbot - INFO - Consignee filtering validated: 7972 rows for codes ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 14:24:16,159 - shipping_chatbot - INFO - User_Query: What is the ETA of booking VN2092736, c_codes: ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 14:29:02,490 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 14:29:02,490 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-20 14:29:02,490 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 14:29:22,870 - shipping_chatbot - INFO - User_Query: What is the ETA of booking VN2092736, c_codes: ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 14:29:22,871 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-20 14:29:42,761 - shipping_chatbot - INFO - Fetched 18991 rows
2026-01-20 14:29:42,769 - shipping_chatbot - INFO - Starting preprocessing on 18991 rows
2026-01-20 14:29:42,978 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-20 14:29:43,902 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-20 14:29:44,144 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-20 14:29:45,199 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-20 14:29:45,203 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-20 14:29:45,203 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-20 14:29:45,289 - shipping_chatbot - INFO - Pre-processing finished - 18991 rows remain
2026-01-20 14:32:29,338 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 14:32:29,340 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-20 14:32:29,340 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 14:32:36,156 - shipping_chatbot - INFO - User_Query: What is the ETA of booking VN2092736, c_codes: ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 14:32:36,156 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-20 14:32:57,572 - shipping_chatbot - INFO - Fetched 18991 rows
2026-01-20 14:32:57,575 - shipping_chatbot - INFO - Starting preprocessing on 18991 rows
2026-01-20 14:32:57,715 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-20 14:32:58,488 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-20 14:32:58,742 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-20 14:32:59,675 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-20 14:32:59,675 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-20 14:32:59,682 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-20 14:32:59,727 - shipping_chatbot - INFO - Pre-processing finished - 18991 rows remain
2026-01-20 15:15:46,018 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 15:15:46,018 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-20 15:15:46,018 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-20 15:16:09,627 - shipping_chatbot - INFO - User_Query: Which containers are going to VUNG TAU in Oct, c_codes: ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 15:16:09,627 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-20 15:16:44,612 - shipping_chatbot - INFO - Fetched 18991 rows
2026-01-20 15:16:44,617 - shipping_chatbot - INFO - Starting preprocessing on 18991 rows
2026-01-20 15:16:44,769 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-20 15:16:45,847 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-20 15:16:46,247 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-20 15:16:47,512 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-20 15:16:47,515 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-20 15:16:47,520 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-20 15:16:47,610 - shipping_chatbot - INFO - Pre-processing finished - 18991 rows remain
2026-01-20 15:16:51,608 - shipping_chatbot - INFO - [get_containers_by_final_destination] Processing query: containers going to VUNG TAU in October 2025
2026-01-20 15:16:51,612 - shipping_chatbot - INFO - [get_containers_by_final_destination] Time window: 2025-10-01 00:00:00 to 2025-10-31 00:00:00 (October 2025)
2026-01-20 15:16:51,758 - shipping_chatbot - INFO - [get_containers_by_final_destination] Initial dataset: 7972 rows
2026-01-20 15:16:51,758 - shipping_chatbot - INFO - [get_containers_by_final_destination] Using eta_fd column only
2026-01-20 15:16:51,761 - shipping_chatbot - INFO - [get_containers_by_final_destination] Extracted FD location: 'VUNG TAU', code: 'None'
2026-01-20 15:16:51,841 - shipping_chatbot - INFO - [get_containers_by_final_destination] Exact name match: 0 matches
2026-01-20 15:16:51,894 - shipping_chatbot - INFO - [get_containers_by_final_destination] Word-based match: 0 matches
2026-01-20 15:38:29,421 - shipping_chatbot - INFO - User_Query: what is the ETA of Booking GT3000512?, c_codes: ['0028664', '0000866', '0005053', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627', '0028664.']
2026-01-20 16:01:32,207 - shipping_chatbot - INFO - User_Query: Please run a report for all Amer Sports HOT container from Jun-Sep, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-20 16:09:23,340 - shipping_chatbot - INFO - User_Query: Please run a report for all Amer Sports HOT container from Jun-Sep, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-20 17:01:38,327 - shipping_chatbot - INFO - User_Query: PO#5302982894 arrived to destination?, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-20 17:01:42,365 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302982894
2026-01-20 17:01:42,575 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-20 17:20:54,361 - shipping_chatbot - INFO - User_Query: Recent Booking number of 5302882444?, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-20 17:20:57,702 - shipping_chatbot - INFO - [get_booking_details] Received query: '5302882444'
2026-01-20 17:20:57,708 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=5302882444, obl=None, booking=None
2026-01-20 17:20:57,708 - shipping_chatbot - INFO - [get_booking_details] Intent flags: wants_booking_number=True, wants_eta=False, wants_po=False, wants_container=False, wants_bl=False
2026-01-20 17:33:35,163 - shipping_chatbot - INFO - User_Query: Please run a report for all Amer Sports HOT container from Jun-Sep 2025, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-20 17:54:36,660 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-20 17:54:36,660 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-20 17:54:36,660 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 09:12:27,551 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 09:12:27,551 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 09:12:27,551 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 09:17:08,164 - shipping_chatbot - INFO - User_Query: What is status of 5302997239?, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 09:17:08,164 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 09:17:26,146 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 09:17:26,146 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 09:17:26,230 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 09:17:26,727 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 09:17:26,894 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 09:17:27,449 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 09:17:27,449 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 09:17:27,449 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 09:17:27,484 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
2026-01-21 09:17:30,191 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302997239
2026-01-21 09:17:30,245 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-21 10:56:07,551 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 10:56:07,551 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 10:56:07,551 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 10:59:28,026 - shipping_chatbot - INFO - User_Query: Please run a report for all Amer Sports logistics HOT container from Jun-Sep, c_codes: ['0000866']
2026-01-21 10:59:28,026 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 10:59:48,597 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 10:59:48,602 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 10:59:48,690 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 10:59:49,349 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 10:59:49,636 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 10:59:50,986 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 10:59:50,986 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 10:59:50,986 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 10:59:51,061 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
2026-01-21 11:04:21,037 - shipping_chatbot - INFO - User_Query: Please run a report for all Amer Sports HOT container from Jun-Sep, c_codes: ['0000866']
2026-01-21 11:04:29,532 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 11:04:29,532 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 11:04:29,532 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 11:04:33,911 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 11:04:33,911 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 11:04:33,911 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 11:04:36,511 - shipping_chatbot - INFO - User_Query: Please run a report for all Amer Sports HOT container from Jun-Sep, c_codes: ['0000866']
2026-01-21 11:04:36,511 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 11:04:52,913 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 11:04:52,917 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 11:04:53,018 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 11:04:53,644 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 11:04:53,889 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 11:04:54,499 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 11:04:54,499 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 11:04:54,499 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 11:04:54,541 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
2026-01-21 11:05:42,598 - shipping_chatbot - INFO - User_Query: Please run a report for all Amer Sports HOT container from Jun-Sep, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 11:10:31,347 - shipping_chatbot - INFO - User_Query: Any containers delayed on Oct?, c_codes: ['0000866']
2026-01-21 11:10:33,946 - shipping_chatbot - INFO - [get_delayed_containers] Query: 'delayed in October 2025', consignee_code: None
2026-01-21 11:10:33,951 - shipping_chatbot - INFO - [get_delayed_containers] Time filter: October 2025 (2025-10-01 to 2025-10-31)
2026-01-21 11:10:34,020 - shipping_chatbot - INFO - [get_delayed_containers] After time filter: 141 containers
2026-01-21 11:37:11,750 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 11:37:11,750 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 11:37:11,750 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 11:58:49,824 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 11:58:49,824 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 11:58:49,824 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:00:52,646 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0000866', '0002907']
2026-01-21 12:00:53,432 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0000866', '0002907']
2026-01-21 12:01:35,358 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0000866', '0002907']
2026-01-21 12:02:14,964 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0000866', '0002907']
2026-01-21 12:02:34,244 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:03:50,223 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:03:50,223 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 12:03:50,223 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:04:06,644 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:08:04,599 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:08:04,600 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 12:08:04,600 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:08:47,629 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:08:47,629 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 12:08:47,629 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:08:55,958 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:09:14,012 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:09:36,565 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:10:33,732 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:10:33,734 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 12:10:33,734 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:11:22,225 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:11:47,950 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:14:08,575 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:14:08,575 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 12:14:08,575 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:15:35,128 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:16:59,828 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:16:59,828 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 12:16:59,828 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:18:23,318 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:19:06,701 - shipping_chatbot - INFO - User_Query: What is the container number loaded for PO 7196962A?, c_codes: ['0043881']
2026-01-21 12:19:06,701 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 12:19:46,088 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 12:19:46,088 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 12:19:46,246 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 12:19:47,556 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 12:19:47,987 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 12:19:49,336 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 12:19:49,342 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 12:19:49,346 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 12:19:49,405 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
2026-01-21 12:19:52,516 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Extracted: container=None, po=None, obl=None, is_lookup=False
2026-01-21 12:21:37,534 - shipping_chatbot - INFO - User_Query: What is the container number loaded for PO 5302964112?, c_codes: ['0002907']
2026-01-21 12:21:40,949 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Extracted: container=None, po=5302964112, obl=None, is_lookup=False
2026-01-21 12:21:40,949 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] PO lookup: po_norm=5302964112, found 1 rows
2026-01-21 12:21:40,957 - shipping_chatbot - INFO - [get_containers_PO_OBL_by_supplier] Returning 1 supplier record(s) for PO 5302964112
2026-01-21 12:22:59,087 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:26:12,332 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:26:12,332 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 12:26:12,332 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:26:21,822 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:26:28,653 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:26:28,909 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:26:29,107 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:26:29,294 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:26:29,444 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:26:29,636 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:26:30,572 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:26:30,765 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:26:31,090 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:27:36,641 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:27:36,641 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 12:27:36,641 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:27:41,186 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:27:42,371 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:27:42,641 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:27:42,847 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:27:43,523 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:27:43,724 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:29:10,115 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:29:10,115 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 12:29:10,115 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:29:18,506 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:29:18,506 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 12:29:18,506 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:29:18,512 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:29:22,859 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:29:32,818 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:29:33,487 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:29:33,700 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:29:33,921 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:29:34,140 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:29:34,321 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:29:34,530 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:29:34,897 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:33:00,824 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:33:00,832 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 12:33:00,832 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:33:33,156 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:33:33,158 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 12:33:33,158 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:35:50,935 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:36:13,386 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:36:13,386 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 12:36:13,386 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:36:32,099 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:36:33,963 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:36:34,636 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:36:34,807 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:36:34,985 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:36:35,155 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:36:35,328 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:36:37,039 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:36:37,287 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:36:37,456 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:36:37,642 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:36:37,829 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:36:38,002 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:36:38,172 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:36:38,343 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:36:38,504 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0002907']
2026-01-21 12:38:01,169 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:38:01,169 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 12:38:01,169 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:38:08,018 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:38:08,018 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 12:38:08,018 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:38:47,103 - shipping_chatbot - INFO - User_Query: Which Booking is associated with PO#5300009918, c_codes: ['0000866', '0042485', '0042652', '0043881', '0043882', '0045831', '0048201', '0002907', '0048627.']
2026-01-21 12:38:47,103 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 12:39:31,760 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 12:39:31,771 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 12:39:31,888 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 12:39:32,868 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 12:39:33,113 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 12:39:34,030 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 12:39:34,030 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 12:39:34,030 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 12:39:34,088 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
2026-01-21 12:39:37,119 - shipping_chatbot - INFO - [get_booking_details] Received query: 'PO 5300009918'
2026-01-21 12:39:37,133 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=5300009918, obl=None, booking=None
2026-01-21 12:39:37,136 - shipping_chatbot - INFO - [get_booking_details] Intent flags: wants_booking_number=True, wants_eta=False, wants_po=False, wants_container=False, wants_bl=False
2026-01-21 12:41:05,341 - shipping_chatbot - INFO - User_Query: Please run a report for all Amer Sports logistics HOT container from Jun-Sep, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 12:44:57,689 - shipping_chatbot - INFO - User_Query: Please run a report for all Amer Sports logistics HOT container from Jun-Sep, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 12:49:31,821 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 12:49:31,821 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 12:49:31,821 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 12:49:55,756 - shipping_chatbot - INFO - User_Query: Please run a report for all Amer Sports logistics HOT container from Jun-Sep, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 12:49:55,756 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 12:50:30,515 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 12:50:30,529 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 12:50:30,666 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 12:50:31,395 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 12:50:31,632 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 12:50:32,465 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 12:50:32,476 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 12:50:32,476 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 12:50:32,514 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
2026-01-21 12:50:36,432 - shipping_chatbot - INFO - [get_hot_containers] Initial dataframe size: 12624 rows
2026-01-21 12:50:36,432 - shipping_chatbot - INFO - [get_hot_containers] Using hot flag column: hot_container_flag
2026-01-21 12:50:36,443 - shipping_chatbot - INFO - [get_hot_containers] After strict hot flag filter: 1407 rows (removed 11217 non-hot)
2026-01-21 12:50:36,445 - shipping_chatbot - INFO - [get_hot_containers] Parsed time period: June 2025 (2025-06-01 to 2025-06-30)
2026-01-21 12:50:36,452 - shipping_chatbot - INFO - [get_hot_containers] After date filter using revised_eta: 95 rows
2026-01-21 12:50:36,452 - shipping_chatbot - INFO - [get_hot_containers] Returning 95 hot containers
2026-01-21 12:50:36,452 - shipping_chatbot - INFO - [get_hot_containers] Hot flag distribution in results: {True: 95}
2026-01-21 13:13:57,079 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 13:13:57,079 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 13:13:57,079 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 13:14:34,558 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 13:14:34,558 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 13:14:34,558 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 13:14:43,474 - shipping_chatbot - INFO - User_Query: Please run a report for all Amer Sports logistics HOT container from Jun-Sep, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:14:43,474 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 13:15:00,469 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 13:15:00,476 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 13:15:00,601 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 13:15:01,536 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 13:15:01,993 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 13:15:03,059 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 13:15:03,059 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 13:15:03,067 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 13:15:03,108 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
2026-01-21 13:15:06,883 - shipping_chatbot - INFO - [get_hot_containers] Initial dataframe size: 12624 rows
2026-01-21 13:15:06,883 - shipping_chatbot - INFO - [get_hot_containers] Using hot flag column: hot_container_flag
2026-01-21 13:15:06,905 - shipping_chatbot - INFO - [get_hot_containers] After strict hot flag filter: 1407 rows (removed 11217 non-hot)
2026-01-21 13:15:06,916 - shipping_chatbot - INFO - [get_hot_containers] Parsed time period: June 2025 (2025-06-01 to 2025-06-30)
2026-01-21 13:15:06,916 - shipping_chatbot - INFO - [get_hot_containers] After date filter using revised_eta: 95 rows
2026-01-21 13:15:06,928 - shipping_chatbot - INFO - [get_hot_containers] Returning 95 hot containers
2026-01-21 13:15:06,928 - shipping_chatbot - INFO - [get_hot_containers] Hot flag distribution in results: {True: 95}
2026-01-21 13:16:12,112 - shipping_chatbot - INFO - User_Query: Please run a report for all Amer Sports logistics HOT container from Jun-Sep, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:16:19,449 - shipping_chatbot - INFO - [get_hot_containers] Initial dataframe size: 12624 rows
2026-01-21 13:16:19,449 - shipping_chatbot - INFO - [get_hot_containers] Using hot flag column: hot_container_flag
2026-01-21 13:16:19,476 - shipping_chatbot - INFO - [get_hot_containers] After strict hot flag filter: 1407 rows (removed 11217 non-hot)
2026-01-21 13:16:19,491 - shipping_chatbot - INFO - [get_hot_containers] Parsed time period: June 2025 (2025-06-01 to 2025-06-30)
2026-01-21 13:16:19,493 - shipping_chatbot - INFO - [get_hot_containers] After date filter using revised_eta: 95 rows
2026-01-21 13:16:19,508 - shipping_chatbot - INFO - [get_hot_containers] Returning 95 hot containers
2026-01-21 13:16:19,508 - shipping_chatbot - INFO - [get_hot_containers] Hot flag distribution in results: {True: 95}
2026-01-21 13:20:24,025 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 13:20:24,025 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 13:20:24,025 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 13:21:34,922 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 13:21:34,922 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 13:21:34,922 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 13:22:28,599 - shipping_chatbot - INFO - User_Query: Please run a report for all Amer Sports logistics HOT container from Jun-Sep, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:22:28,600 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 13:22:54,988 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 13:22:54,993 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 13:22:55,125 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 13:22:55,935 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 13:22:56,186 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 13:22:57,016 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 13:22:57,020 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 13:22:57,020 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 13:22:57,061 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
2026-01-21 13:23:00,691 - shipping_chatbot - INFO - [get_hot_containers] Initial dataframe size: 12624 rows
2026-01-21 13:23:00,691 - shipping_chatbot - INFO - [get_hot_containers] Using hot flag column: hot_container_flag
2026-01-21 13:23:00,709 - shipping_chatbot - INFO - [get_hot_containers] After strict hot flag filter: 1407 rows (removed 11217 non-hot)
2026-01-21 13:23:00,724 - shipping_chatbot - INFO - [get_hot_containers] Parsed time period: June 2025 (2025-06-01 to 2025-06-30)
2026-01-21 13:23:00,729 - shipping_chatbot - INFO - [get_hot_containers] After date filter using revised_eta: 95 rows
2026-01-21 13:23:00,739 - shipping_chatbot - INFO - [get_hot_containers] Returning 95 hot containers
2026-01-21 13:23:00,739 - shipping_chatbot - INFO - [get_hot_containers] Hot flag distribution in results: {True: 95}
2026-01-21 13:23:55,841 - shipping_chatbot - INFO - User_Query: Please run a report for all Amer Sports logistics HOT container from Jun-Sep, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:24:00,803 - shipping_chatbot - INFO - [get_hot_containers] Initial dataframe size: 12624 rows
2026-01-21 13:24:00,803 - shipping_chatbot - INFO - [get_hot_containers] Using hot flag column: hot_container_flag
2026-01-21 13:24:00,836 - shipping_chatbot - INFO - [get_hot_containers] After strict hot flag filter: 1407 rows (removed 11217 non-hot)
2026-01-21 13:24:00,846 - shipping_chatbot - INFO - [get_hot_containers] Parsed time period: June 2025 (2025-06-01 to 2025-06-30)
2026-01-21 13:24:00,854 - shipping_chatbot - INFO - [get_hot_containers] After date filter using revised_eta: 95 rows
2026-01-21 13:24:00,863 - shipping_chatbot - INFO - [get_hot_containers] Returning 95 hot containers
2026-01-21 13:24:00,863 - shipping_chatbot - INFO - [get_hot_containers] Hot flag distribution in results: {True: 95}
2026-01-21 13:24:17,729 - shipping_chatbot - INFO - User_Query: Please run a report for all Amer Sports logistics HOT container from Jun-Sep, c_codes: ['0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:24:21,457 - shipping_chatbot - INFO - [get_hot_containers] Initial dataframe size: 10527 rows
2026-01-21 13:24:21,463 - shipping_chatbot - INFO - [get_hot_containers] Using hot flag column: hot_container_flag
2026-01-21 13:24:21,480 - shipping_chatbot - INFO - [get_hot_containers] After strict hot flag filter: 758 rows (removed 9769 non-hot)
2026-01-21 13:24:21,483 - shipping_chatbot - INFO - [get_hot_containers] Parsed time period: June 2025 (2025-06-01 to 2025-06-30)
2026-01-21 13:24:21,487 - shipping_chatbot - INFO - [get_hot_containers] After date filter using revised_eta: 30 rows
2026-01-21 13:24:21,488 - shipping_chatbot - INFO - [get_hot_containers] Returning 30 hot containers
2026-01-21 13:24:21,488 - shipping_chatbot - INFO - [get_hot_containers] Hot flag distribution in results: {True: 30}
2026-01-21 13:26:08,038 - shipping_chatbot - INFO - User_Query: Please run a report for all Amer Sports logistics HOT container from Jun-Sep, c_codes: ['0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:26:11,347 - shipping_chatbot - INFO - [get_hot_containers] Initial dataframe size: 10527 rows
2026-01-21 13:26:11,347 - shipping_chatbot - INFO - [get_hot_containers] Using hot flag column: hot_container_flag
2026-01-21 13:26:11,355 - shipping_chatbot - INFO - [get_hot_containers] After strict hot flag filter: 758 rows (removed 9769 non-hot)
2026-01-21 13:26:11,365 - shipping_chatbot - INFO - [get_hot_containers] Parsed time period: June 2025 (2025-06-01 to 2025-06-30)
2026-01-21 13:26:11,365 - shipping_chatbot - INFO - [get_hot_containers] After date filter using revised_eta: 30 rows
2026-01-21 13:26:11,372 - shipping_chatbot - INFO - [get_hot_containers] Returning 30 hot containers
2026-01-21 13:26:11,375 - shipping_chatbot - INFO - [get_hot_containers] Hot flag distribution in results: {True: 30}
2026-01-21 13:27:34,962 - shipping_chatbot - INFO - User_Query: Please run a report for all Amer Sports logistics HOT container from Jun-Sep, c_codes: ['0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:27:39,769 - shipping_chatbot - INFO - [get_hot_containers] Initial dataframe size: 10527 rows
2026-01-21 13:27:39,769 - shipping_chatbot - INFO - [get_hot_containers] Using hot flag column: hot_container_flag
2026-01-21 13:27:39,779 - shipping_chatbot - INFO - [get_hot_containers] After strict hot flag filter: 758 rows (removed 9769 non-hot)
2026-01-21 13:27:39,790 - shipping_chatbot - INFO - [get_hot_containers] Parsed time period: June 2025 (2025-06-01 to 2025-06-30)
2026-01-21 13:27:39,794 - shipping_chatbot - INFO - [get_hot_containers] After date filter using revised_eta: 30 rows
2026-01-21 13:27:39,802 - shipping_chatbot - INFO - [get_hot_containers] Returning 30 hot containers
2026-01-21 13:27:39,806 - shipping_chatbot - INFO - [get_hot_containers] Hot flag distribution in results: {True: 30}
2026-01-21 13:27:58,089 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 13:27:58,089 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 13:27:58,089 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 13:28:23,872 - shipping_chatbot - INFO - User_Query: Please run a report for all Amer Sports logistics HOT container from Jun-Sep, c_codes: ['0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 13:28:23,872 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 13:28:50,013 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 13:28:50,026 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 13:28:50,138 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 13:28:50,843 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 13:28:51,107 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 13:28:51,874 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 13:28:51,874 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 13:28:51,880 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 13:28:51,922 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
2026-01-21 13:28:55,427 - shipping_chatbot - INFO - [get_hot_containers] Initial dataframe size: 10527 rows
2026-01-21 13:28:55,435 - shipping_chatbot - INFO - [get_hot_containers] Using hot flag column: hot_container_flag
2026-01-21 13:28:55,454 - shipping_chatbot - INFO - [get_hot_containers] After strict hot flag filter: 758 rows (removed 9769 non-hot)
2026-01-21 13:28:55,466 - shipping_chatbot - INFO - [get_hot_containers] Parsed time period: between 2025-06-01 and 2025-09-30 (2025-06-01 to 2025-09-30)
2026-01-21 13:28:55,469 - shipping_chatbot - INFO - [get_hot_containers] After date filter using revised_eta: 238 rows
2026-01-21 13:28:55,480 - shipping_chatbot - INFO - [get_hot_containers] Returning 238 hot containers
2026-01-21 13:28:55,482 - shipping_chatbot - INFO - [get_hot_containers] Hot flag distribution in results: {True: 238}
2026-01-21 13:32:59,737 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 13:32:59,737 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 13:32:59,737 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 14:13:49,969 - shipping_chatbot - INFO - User_Query: Please run a report for all Amer Sports logistics HOT container from Jun-Sep, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 14:13:49,969 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 14:14:03,393 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 14:14:03,396 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 14:14:03,462 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 14:14:03,951 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 14:14:04,111 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 14:14:04,687 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 14:14:04,687 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 14:14:04,687 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 14:14:04,721 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
2026-01-21 14:14:07,720 - shipping_chatbot - INFO - [get_hot_containers] Initial dataframe size: 12624 rows
2026-01-21 14:14:07,720 - shipping_chatbot - INFO - [get_hot_containers] Using hot flag column: hot_container_flag
2026-01-21 14:14:07,739 - shipping_chatbot - INFO - [get_hot_containers] After strict hot flag filter: 1407 rows (removed 11217 non-hot)
2026-01-21 14:14:07,742 - shipping_chatbot - INFO - [get_hot_containers] Parsed time period: June 2025 (2025-06-01 to 2025-06-30)
2026-01-21 14:14:07,743 - shipping_chatbot - INFO - [get_hot_containers] After date filter using revised_eta: 95 rows
2026-01-21 14:14:07,749 - shipping_chatbot - INFO - [get_hot_containers] Returning 95 hot containers
2026-01-21 14:14:07,750 - shipping_chatbot - INFO - [get_hot_containers] Hot flag distribution in results: {True: 95}
2026-01-21 14:15:11,874 - shipping_chatbot - INFO - User_Query: Hot POs delayed by more than 5 days, c_codes: ['0000866']
2026-01-21 14:15:14,453 - shipping_chatbot - INFO - [get_delayed_pos] Processing query: hot po delayed by more than 5 days
2026-01-21 14:15:14,454 - shipping_chatbot - INFO - [get_delayed_pos] Matched more_than pattern: ('5',)
2026-01-21 14:15:14,456 - shipping_chatbot - INFO - [get_delayed_pos] More than filter: delay_days > 5, results: 46
2026-01-21 14:15:14,458 - shipping_chatbot - INFO - [get_delayed_pos] Sample delay_days values: {0: 919, 1: 364, -1: 185, 2: 121, 4: 55, 3: 43, -2: 31, 8: 21, 5: 17, -5: 14}
2026-01-21 14:15:33,050 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 14:15:33,050 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 14:15:33,050 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 14:20:36,498 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 14:20:36,499 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 14:20:36,499 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 14:22:33,995 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 14:22:33,995 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 14:22:33,995 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 14:22:39,269 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 14:22:39,269 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 14:22:39,269 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 14:22:48,246 - shipping_chatbot - INFO - User_Query: Hot POs delayed by more than 5 days, c_codes: ['0000866']
2026-01-21 14:22:48,248 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 14:22:59,713 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 14:22:59,716 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 14:22:59,813 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 14:23:00,559 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 14:23:00,795 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 14:23:01,422 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 14:23:01,422 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 14:23:01,427 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 14:23:01,455 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
2026-01-21 14:23:04,089 - shipping_chatbot - INFO - [get_delayed_pos] Hot filter applied: 1824 -> 576 rows (removed 1248 non-hot)
2026-01-21 14:23:04,097 - shipping_chatbot - INFO - [get_delayed_pos] Processing query: hot po delayed by more than 5 days
2026-01-21 14:23:04,097 - shipping_chatbot - INFO - [get_delayed_pos] Matched more_than pattern: ('5',)
2026-01-21 14:23:04,099 - shipping_chatbot - INFO - [get_delayed_pos] More than filter: delay_days > 5, results: 15
2026-01-21 14:23:04,100 - shipping_chatbot - INFO - [get_delayed_pos] Sample delay_days values: {0: 306, 1: 130, 2: 41, -1: 37, -2: 14, 4: 9, 8: 8, 3: 8, 5: 6, -3: 5}
2026-01-21 14:24:25,665 - shipping_chatbot - INFO - User_Query: POs delayed by more than 5 days, c_codes: ['0000866']
2026-01-21 14:24:28,293 - shipping_chatbot - INFO - [get_delayed_pos] Processing query: delayed by more than 5 days
2026-01-21 14:24:28,293 - shipping_chatbot - INFO - [get_delayed_pos] Matched more_than pattern: ('5',)
2026-01-21 14:24:28,293 - shipping_chatbot - INFO - [get_delayed_pos] More than filter: delay_days > 5, results: 46
2026-01-21 14:24:28,293 - shipping_chatbot - INFO - [get_delayed_pos] Sample delay_days values: {0: 919, 1: 364, -1: 185, 2: 121, 4: 55, 3: 43, -2: 31, 8: 21, 5: 17, -5: 14}
2026-01-21 14:37:44,382 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 14:37:44,382 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 14:37:44,382 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 14:37:48,099 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 14:37:48,099 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 14:37:48,099 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 14:39:11,664 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0000866']
2026-01-21 14:39:50,729 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0000866']
2026-01-21 14:41:01,486 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 14:41:01,486 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 14:41:01,486 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 14:41:18,719 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0000866']
2026-01-21 14:47:37,491 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 14:47:37,492 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 14:47:37,492 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 14:47:41,639 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 14:47:41,639 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 14:47:41,639 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 14:50:43,856 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 14:50:43,857 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 14:50:43,857 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 14:50:47,304 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0000866']
2026-01-21 14:50:52,010 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0000866']
2026-01-21 14:50:52,329 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0000866']
2026-01-21 14:50:52,513 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0000866']
2026-01-21 14:50:52,686 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0000866']
2026-01-21 14:50:52,840 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0000866']
2026-01-21 14:50:53,009 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0000866']
2026-01-21 14:50:53,170 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0000866']
2026-01-21 14:50:53,286 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0000866']
2026-01-21 14:50:53,430 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0000866']
2026-01-21 14:51:02,925 - shipping_chatbot - INFO - User_Query: shipped quantity for 5302982894, c_codes: ['0000866']
2026-01-21 14:51:05,179 - shipping_chatbot - INFO - User_Query: shipped quantity for 5302982894, c_codes: ['0000866']
2026-01-21 14:51:05,368 - shipping_chatbot - INFO - User_Query: shipped quantity for 5302982894, c_codes: ['0000866']
2026-01-21 14:51:05,577 - shipping_chatbot - INFO - User_Query: shipped quantity for 5302982894, c_codes: ['0000866']
2026-01-21 14:52:06,956 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:52:11,545 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:52:11,721 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:52:11,891 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:52:12,066 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:52:12,232 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:52:12,411 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:52:39,994 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:55:33,467 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 14:55:33,467 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 14:55:33,467 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 14:56:05,489 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 14:56:05,491 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 14:56:05,491 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 14:56:10,749 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 14:56:10,749 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 14:56:10,749 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 14:58:46,153 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 14:58:46,154 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 14:58:46,154 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 14:58:46,203 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:58:48,806 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:58:50,116 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:58:50,307 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:58:50,498 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:58:50,829 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:58:51,019 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:58:51,624 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:58:51,822 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:58:53,008 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:58:53,194 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:59:28,986 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:59:29,150 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:59:29,325 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:59:29,615 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:59:29,795 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 14:59:29,961 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 15:01:39,723 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 15:01:45,030 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 15:01:45,030 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 15:01:45,030 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 15:01:48,757 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 15:06:58,073 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 15:06:58,073 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 15:06:58,074 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 15:07:21,691 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 15:07:21,691 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 15:07:21,691 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 15:07:53,085 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 15:07:53,085 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 15:07:53,085 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 15:09:15,964 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 15:09:15,964 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 15:09:15,964 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 15:10:53,875 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 15:10:57,149 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 15:13:00,360 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 15:13:00,360 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 15:13:00,360 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 15:13:04,324 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 15:13:04,324 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 15:13:04,324 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 15:15:17,372 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 15:15:17,372 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 15:15:17,372 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 15:19:12,301 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 15:19:30,004 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 15:19:30,838 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 15:19:45,629 - shipping_chatbot - INFO - User_Query: shipped quantity for container 5302939785, c_codes: ['0000866']
2026-01-21 15:21:46,019 - shipping_chatbot - INFO - User_Query: shipped quantity for container 5302939785, c_codes: ['0000866']
2026-01-21 15:25:04,267 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 15:25:04,267 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 15:25:04,267 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 15:25:44,491 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 15:25:44,491 - shipping_chatbot - INFO - Agent created with 53 tools
2026-01-21 15:25:44,491 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 15:25:49,768 - shipping_chatbot - INFO - User_Query: shipped quantity for container 5302939785, c_codes: ['0000866']
2026-01-21 15:25:49,768 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'shipped quantity for container 5302939785', length: 41
2026-01-21 15:25:49,768 - shipping_chatbot - INFO - [DEBUG] q_lower: 'shipped quantity for container 5302939785'
2026-01-21 15:25:49,769 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 15:26:02,896 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 15:26:02,896 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 15:26:02,974 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 15:26:03,446 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 15:26:03,611 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 15:26:04,145 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 15:26:04,145 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 15:26:04,145 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 15:26:04,184 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
2026-01-21 15:26:25,308 - shipping_chatbot - INFO - Router: Set consignee codes ['0000866'] for query: shipped quantity for container 5302939785
2026-01-21 15:26:25,373 - shipping_chatbot - INFO - Consignee filtering validated: 2097 rows for codes ['0000866']
2026-01-21 15:29:31,449 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 15:29:31,449 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 15:29:31,450 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 15:29:36,257 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 15:29:36,258 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 15:29:36,258 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 15:30:53,007 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 15:30:53,007 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 15:30:53,007 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 15:31:29,890 - shipping_chatbot - INFO - User_Query: shipped quantity for po#5302939785, c_codes: ['0000866']
2026-01-21 15:31:29,890 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'shipped quantity for po#5302939785', length: 34
2026-01-21 15:31:29,890 - shipping_chatbot - INFO - [DEBUG] q_lower: 'shipped quantity for po#5302939785'
2026-01-21 15:31:29,890 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 15:31:43,797 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 15:31:43,798 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 15:31:43,882 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 15:31:44,548 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 15:31:44,781 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 15:31:45,559 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 15:31:45,561 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 15:31:45,563 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 15:31:45,610 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
2026-01-21 15:31:48,303 - shipping_chatbot - INFO - [get_shipped_quantity] ===== FUNCTION CALLED ===== Query: 'shipped quantity for PO#5302939785', consignee_code: None
2026-01-21 15:31:48,373 - shipping_chatbot - INFO - [get_shipped_quantity] Detected PO: 5302939785
2026-01-21 15:31:48,373 - shipping_chatbot - INFO - [get_shipped_quantity] Searching for PO 5302939785 in po_number_multiple column
2026-01-21 15:31:48,373 - shipping_chatbot - INFO - [get_shipped_quantity] Found 3 records matching PO 5302939785
2026-01-21 15:31:48,379 - shipping_chatbot - INFO - [get_shipped_quantity] ===== RETURNING 3 RECORDS =====
2026-01-21 15:31:48,385 - shipping_chatbot - INFO - [get_shipped_quantity] Result type: <class 'list'>, length: 3
2026-01-21 15:46:46,432 - shipping_chatbot - INFO - User_Query: shipped quantity for TCKU7098672, c_codes: ['0000866']
2026-01-21 15:46:46,432 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'shipped quantity for TCKU7098672', length: 32
2026-01-21 15:46:46,432 - shipping_chatbot - INFO - [DEBUG] q_lower: 'shipped quantity for tcku7098672'
2026-01-21 15:46:49,222 - shipping_chatbot - INFO - [get_shipped_quantity] ===== FUNCTION CALLED ===== Query: 'shipped quantity for container TCKU7098672', consignee_code: None
2026-01-21 15:46:49,318 - shipping_chatbot - INFO - [get_shipped_quantity] Detected Container: TCKU7098672
2026-01-21 15:46:49,329 - shipping_chatbot - INFO - [get_shipped_quantity] ===== RETURNING 1 RECORDS =====
2026-01-21 15:46:49,329 - shipping_chatbot - INFO - [get_shipped_quantity] Result type: <class 'list'>, length: 1
2026-01-21 15:47:51,144 - shipping_chatbot - INFO - User_Query: What is status of 5302997239?, c_codes: ['0000866']
2026-01-21 15:47:51,145 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'What is status of 5302997239?', length: 29
2026-01-21 15:47:51,146 - shipping_chatbot - INFO - [DEBUG] q_lower: 'what is status of 5302997239?'
2026-01-21 15:47:53,964 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302997239
2026-01-21 15:47:53,976 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-21 15:48:20,330 - shipping_chatbot - INFO - User_Query: What are the POs in the container TCLU4703170?, c_codes: ['0000866']
2026-01-21 15:48:20,331 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'What are the POs in the container TCLU4703170?', length: 46
2026-01-21 15:48:20,331 - shipping_chatbot - INFO - [DEBUG] q_lower: 'what are the pos in the container tclu4703170?'
2026-01-21 15:48:22,837 - shipping_chatbot - INFO - [get_booking_details] Received query: 'container TCLU4703170'
2026-01-21 15:48:22,837 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=TCLU4703170, po=None, obl=None, booking=None
2026-01-21 15:48:22,837 - shipping_chatbot - INFO - [get_booking_details] Intent flags: wants_booking_number=True, wants_eta=False, wants_po=False, wants_container=False, wants_bl=False
2026-01-21 16:10:40,570 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0000866']
2026-01-21 16:10:40,570 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'shipped quantity for PO#5302982894', length: 34
2026-01-21 16:10:40,570 - shipping_chatbot - INFO - [DEBUG] q_lower: 'shipped quantity for po#5302982894'
2026-01-21 16:10:43,135 - shipping_chatbot - INFO - [get_shipped_quantity] ===== FUNCTION CALLED ===== Query: 'shipped quantity for PO#5302982894', consignee_code: None
2026-01-21 16:10:43,218 - shipping_chatbot - INFO - [get_shipped_quantity] Detected PO: 5302982894
2026-01-21 16:10:43,218 - shipping_chatbot - INFO - [get_shipped_quantity] Searching for PO 5302982894 in po_number_multiple column
2026-01-21 16:10:43,218 - shipping_chatbot - INFO - [get_shipped_quantity] Found 0 records matching PO 5302982894
2026-01-21 16:11:42,827 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0000866', '0002907']
2026-01-21 16:11:42,827 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'shipped quantity for PO#5302982894', length: 34
2026-01-21 16:11:42,831 - shipping_chatbot - INFO - [DEBUG] q_lower: 'shipped quantity for po#5302982894'
2026-01-21 16:11:45,549 - shipping_chatbot - INFO - [get_shipped_quantity] ===== FUNCTION CALLED ===== Query: 'shipped quantity for PO#5302982894', consignee_code: None
2026-01-21 16:11:45,632 - shipping_chatbot - INFO - [get_shipped_quantity] Detected PO: 5302982894
2026-01-21 16:11:45,632 - shipping_chatbot - INFO - [get_shipped_quantity] Searching for PO 5302982894 in po_number_multiple column
2026-01-21 16:11:45,647 - shipping_chatbot - INFO - [get_shipped_quantity] Found 1 records matching PO 5302982894
2026-01-21 16:11:45,649 - shipping_chatbot - INFO - [get_shipped_quantity] ===== RETURNING 1 RECORDS =====
2026-01-21 16:11:45,656 - shipping_chatbot - INFO - [get_shipped_quantity] Result type: <class 'list'>, length: 1
2026-01-21 16:13:44,695 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 16:13:44,695 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 16:13:44,697 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 16:13:51,093 - shipping_chatbot - INFO - User_Query: shipped quantity for PO#5302982894, c_codes: ['0000866', '0002907']
2026-01-21 16:13:51,094 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'shipped quantity for PO#5302982894', length: 34
2026-01-21 16:13:51,094 - shipping_chatbot - INFO - [DEBUG] q_lower: 'shipped quantity for po#5302982894'
2026-01-21 16:13:51,094 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 16:14:03,970 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 16:14:03,970 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 16:14:04,037 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 16:14:04,529 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 16:14:04,694 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 16:14:05,254 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 16:14:05,254 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 16:14:05,254 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 16:14:05,286 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
2026-01-21 16:14:07,859 - shipping_chatbot - INFO - [get_shipped_quantity] ===== FUNCTION CALLED ===== Query: 'shipped quantity for PO#5302982894', consignee_code: None
2026-01-21 16:14:07,908 - shipping_chatbot - INFO - [get_shipped_quantity] Detected PO: 5302982894
2026-01-21 16:14:07,908 - shipping_chatbot - INFO - [get_shipped_quantity] Searching for PO 5302982894 in po_number_multiple column
2026-01-21 16:14:07,908 - shipping_chatbot - INFO - [get_shipped_quantity] Found 1 records matching PO 5302982894
2026-01-21 16:14:07,916 - shipping_chatbot - INFO - [get_shipped_quantity] ===== RETURNING 1 RECORDS =====
2026-01-21 16:14:07,920 - shipping_chatbot - INFO - [get_shipped_quantity] Result type: <class 'list'>, length: 1
2026-01-21 16:14:53,385 - shipping_chatbot - INFO - User_Query: What is status of 5302997239?, c_codes: ['0000866', '0002907']
2026-01-21 16:14:53,387 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'What is status of 5302997239?', length: 29
2026-01-21 16:14:53,387 - shipping_chatbot - INFO - [DEBUG] q_lower: 'what is status of 5302997239?'
2026-01-21 16:14:55,834 - shipping_chatbot - INFO - [get_container_milestones] Searching for PO: 5302997239
2026-01-21 16:14:55,850 - shipping_chatbot - INFO - [get_container_milestones] PO match results: 1 rows found
2026-01-21 16:18:22,659 - shipping_chatbot - INFO - User_Query: What is the container number for PO#5302982894?, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 16:18:22,659 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'What is the container number for PO#5302982894?', length: 47
2026-01-21 16:18:22,659 - shipping_chatbot - INFO - [DEBUG] q_lower: 'what is the container number for po#5302982894?'
2026-01-21 16:18:25,078 - shipping_chatbot - INFO - [get_booking_details] Received query: 'PO 5302982894'
2026-01-21 16:18:25,081 - shipping_chatbot - INFO - [get_booking_details] Extracted identifiers: container=None, po=5302982894, obl=None, booking=None
2026-01-21 16:18:25,081 - shipping_chatbot - INFO - [get_booking_details] Intent flags: wants_booking_number=True, wants_eta=False, wants_po=False, wants_container=False, wants_bl=False
2026-01-21 16:40:24,773 - shipping_chatbot - INFO - User_Query: Hot containers arriving in next 3 days, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 16:40:24,773 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Hot containers arriving in next 3 days', length: 38
2026-01-21 16:40:24,773 - shipping_chatbot - INFO - [DEBUG] q_lower: 'hot containers arriving in next 3 days'
2026-01-21 16:40:27,266 - shipping_chatbot - INFO - [get_hot_upcoming_arrivals] Query: arriving in next 3 days
2026-01-21 16:40:27,266 - shipping_chatbot - INFO - [get_hot_upcoming_arrivals] Time window: 2026-01-21 00:00:00..2026-01-23 00:00:00 (next 3 days (exact))
2026-01-21 16:40:27,406 - shipping_chatbot - INFO - [get_hot_upcoming_arrivals] Initial dataset: 12624 rows
2026-01-21 16:40:27,436 - shipping_chatbot - INFO - [get_hot_upcoming_arrivals] After hot_container_flag filter: 1407 rows
2026-01-21 16:40:27,436 - shipping_chatbot - INFO - [get_hot_upcoming_arrivals] After date/upcoming filter (start=2026-01-21 00:00:00, end=2026-01-23 00:00:00): 1 rows
2026-01-21 16:40:27,453 - shipping_chatbot - INFO - [get_hot_upcoming_arrivals] Returning 1 hot container records
2026-01-21 16:41:49,009 - shipping_chatbot - INFO - User_Query: Hot containers arriving in next 3 days, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 16:41:49,009 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Hot containers arriving in next 3 days', length: 38
2026-01-21 16:41:49,009 - shipping_chatbot - INFO - [DEBUG] q_lower: 'hot containers arriving in next 3 days'
2026-01-21 16:41:51,622 - shipping_chatbot - INFO - [get_hot_upcoming_arrivals] Query: arriving in next 3 days
2026-01-21 16:41:51,637 - shipping_chatbot - INFO - [get_hot_upcoming_arrivals] Time window: 2026-01-21 00:00:00..2026-01-23 00:00:00 (next 3 days (exact))
2026-01-21 16:41:51,724 - shipping_chatbot - INFO - [get_hot_upcoming_arrivals] Initial dataset: 12624 rows
2026-01-21 16:41:51,724 - shipping_chatbot - INFO - [get_hot_upcoming_arrivals] After hot_container_flag filter: 1407 rows
2026-01-21 16:41:51,738 - shipping_chatbot - INFO - [get_hot_upcoming_arrivals] After date/upcoming filter (start=2026-01-21 00:00:00, end=2026-01-23 00:00:00): 1 rows
2026-01-21 16:41:51,738 - shipping_chatbot - INFO - [get_hot_upcoming_arrivals] Returning 1 hot container records
2026-01-21 16:49:44,880 - shipping_chatbot - INFO - User_Query: Which containers will arrive in the next 10days at Nashville, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-21 16:49:44,882 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers will arrive in the next 10days at Nashville', length: 60
2026-01-21 16:49:44,882 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers will arrive in the next 10days at nashville'
2026-01-21 16:49:47,531 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 10 days, Dates: 2026-01-21 to 2026-01-30, is_past=False
2026-01-21 17:18:05,533 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 17:18:05,533 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 17:18:05,533 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 17:20:32,169 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-21 17:20:32,170 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-21 17:20:32,170 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-21 17:22:41,719 - shipping_chatbot - INFO - User_Query: Which containers will arrive in the next 10days at Nashville, c_codes: ['0000866']
2026-01-21 17:22:41,719 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers will arrive in the next 10days at Nashville', length: 60
2026-01-21 17:22:41,719 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers will arrive in the next 10days at nashville'
2026-01-21 17:22:41,719 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-21 17:22:58,795 - shipping_chatbot - INFO - Fetched 19032 rows
2026-01-21 17:22:58,795 - shipping_chatbot - INFO - Starting preprocessing on 19032 rows
2026-01-21 17:22:58,881 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-21 17:22:59,361 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-21 17:22:59,512 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-21 17:23:00,053 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-21 17:23:00,055 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-21 17:23:00,056 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-21 17:23:00,084 - shipping_chatbot - INFO - Pre-processing finished - 19032 rows remain
2026-01-21 17:23:02,514 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 10 days, Dates: 2026-01-21 to 2026-01-30, is_past=False
2026-01-21 17:26:05,099 - shipping_chatbot - INFO - User_Query: Which containers will arrive in the next 10days at HONG KONG, c_codes: ['0000866']
2026-01-21 17:26:05,100 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers will arrive in the next 10days at HONG KONG', length: 60
2026-01-21 17:26:05,100 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers will arrive in the next 10days at hong kong'
2026-01-21 17:26:07,781 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 10 days, Dates: 2026-01-21 to 2026-01-30, is_past=False
2026-01-21 17:26:07,858 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found bare port code: HKHKG (validated against known codes)
2026-01-21 17:34:48,754 - shipping_chatbot - INFO - User_Query: Which containers will arrive in the next 10days at NASHVILLE, c_codes: ['0000866']
2026-01-21 17:34:48,754 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers will arrive in the next 10days at NASHVILLE', length: 60
2026-01-21 17:34:48,754 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers will arrive in the next 10days at nashville'
2026-01-21 17:34:51,340 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 10 days, Dates: 2026-01-21 to 2026-01-30, is_past=False
2026-01-21 17:36:18,183 - shipping_chatbot - INFO - User_Query: Can you please let me know the containers arriving at Nashville in next 5 days, c_codes: ['0000866']
2026-01-21 17:36:18,183 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Can you please let me know the containers arriving at Nashville in next 5 days', length: 78
2026-01-21 17:36:18,183 - shipping_chatbot - INFO - [DEBUG] q_lower: 'can you please let me know the containers arriving at nashville in next 5 days'
2026-01-21 17:36:20,741 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 5 days, Dates: 2026-01-21 to 2026-01-25, is_past=False
2026-01-22 08:45:31,496 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 08:45:31,498 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 08:45:31,498 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 08:54:19,034 - shipping_chatbot - INFO - User_Query: how many containers departed from CNSHA day before yesterday, c_codes: ['0000866']
2026-01-22 08:54:19,034 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'how many containers departed from CNSHA day before yesterday', length: 60
2026-01-22 08:54:19,034 - shipping_chatbot - INFO - [DEBUG] q_lower: 'how many containers departed from cnsha day before yesterday'
2026-01-22 08:54:19,034 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-22 08:58:28,257 - shipping_chatbot - INFO - Fetched 19114 rows
2026-01-22 08:58:28,257 - shipping_chatbot - INFO - Starting preprocessing on 19114 rows
2026-01-22 08:58:28,406 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-22 08:58:29,274 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-22 08:58:29,506 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-22 08:58:30,284 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-22 08:58:30,290 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-22 08:58:30,290 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-22 08:58:30,340 - shipping_chatbot - INFO - Pre-processing finished - 19114 rows remain
2026-01-22 08:58:34,024 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted: container=None, po=None, obl=None
2026-01-22 08:58:34,024 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted load_port: 'CNSHA ON 2025-06-04'
2026-01-22 08:58:34,038 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Time window: 2026-01-22 00:00:00 to 2026-01-28 00:00:00 (next 7 days (default))
2026-01-22 08:58:34,148 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Authorized consignee codes: ['0000866'], rows after filtering: 2095
2026-01-22 08:58:34,177 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Port matching: user_input='CNSHA ON 2025-06-04', normalized='CNSHA ON 2025-06-04', code='None'
2026-01-22 08:58:34,179 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Exact name match 'CNSHA ON 2025-06-04': 0 rows
2026-01-22 08:58:34,181 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Word-based match ['CNSHA', 'ON', '2025-06-04']: 0 rows
2026-01-22 08:58:34,192 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Fuzzy match: 0 rows
2026-01-22 08:58:34,195 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After port filter: 0 rows matched
2026-01-22 09:02:17,210 - shipping_chatbot - INFO - User_Query: how many containers departed from CNSHA today, c_codes: ['0000866']
2026-01-22 09:02:17,213 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'how many containers departed from CNSHA today', length: 45
2026-01-22 09:02:17,213 - shipping_chatbot - INFO - [DEBUG] q_lower: 'how many containers departed from cnsha today'
2026-01-22 09:02:20,008 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted: container=None, po=None, obl=None
2026-01-22 09:02:20,008 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted load_port: 'CNSHA TODAY'
2026-01-22 09:02:20,008 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Time window: 2026-01-22 00:00:00 to 2026-01-22 00:00:00 (today)
2026-01-22 09:02:20,106 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Authorized consignee codes: ['0000866'], rows after filtering: 2095
2026-01-22 09:02:20,135 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Port matching: user_input='CNSHA TODAY', normalized='CNSHA TODAY', code='None'
2026-01-22 09:02:20,137 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Exact name match 'CNSHA TODAY': 0 rows
2026-01-22 09:02:20,137 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Word-based match ['CNSHA', 'TODAY']: 0 rows
2026-01-22 09:02:20,144 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Fuzzy match: 0 rows
2026-01-22 09:02:20,152 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After port filter: 0 rows matched
2026-01-22 09:17:55,589 - shipping_chatbot - INFO - User_Query: how many containers departed from CNTAO yesterday, c_codes: ['0000866', '0040070', '0043881']
2026-01-22 09:17:55,589 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'how many containers departed from CNTAO yesterday', length: 49
2026-01-22 09:17:55,591 - shipping_chatbot - INFO - [DEBUG] q_lower: 'how many containers departed from cntao yesterday'
2026-01-22 09:18:06,077 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted: container=None, po=None, obl=None
2026-01-22 09:18:06,083 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted load_port: 'CNTAO YESTERDAY'
2026-01-22 09:18:06,083 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Time window: 2026-01-21 00:00:00 to 2026-01-21 00:00:00 (yesterday)
2026-01-22 09:18:06,198 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Authorized consignee codes: ['0000866', '0040070', '0043881'], rows after filtering: 4129
2026-01-22 09:18:06,229 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Port matching: user_input='CNTAO YESTERDAY', normalized='CNTAO YESTERDAY', code='None'
2026-01-22 09:18:06,243 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Exact name match 'CNTAO YESTERDAY': 0 rows
2026-01-22 09:18:06,243 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Word-based match ['CNTAO', 'YESTERDAY']: 0 rows
2026-01-22 09:18:06,243 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Fuzzy match: 0 rows
2026-01-22 09:18:06,251 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After port filter: 0 rows matched
2026-01-22 09:19:20,296 - shipping_chatbot - INFO - User_Query: how many containers departed from QINGDAO yesterday, c_codes: ['0000866', '0040070', '0043881']
2026-01-22 09:19:20,299 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'how many containers departed from QINGDAO yesterday', length: 51
2026-01-22 09:19:20,300 - shipping_chatbot - INFO - [DEBUG] q_lower: 'how many containers departed from qingdao yesterday'
2026-01-22 09:19:22,908 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted: container=None, po=None, obl=None
2026-01-22 09:19:22,918 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted load_port: 'QINGDAO YESTERDAY'
2026-01-22 09:19:22,918 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Time window: 2026-01-21 00:00:00 to 2026-01-21 00:00:00 (yesterday)
2026-01-22 09:19:23,070 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Authorized consignee codes: ['0000866', '0040070', '0043881'], rows after filtering: 4129
2026-01-22 09:19:23,140 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Port matching: user_input='QINGDAO YESTERDAY', normalized='QINGDAO YESTERDAY', code='None'
2026-01-22 09:19:23,144 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Exact name match 'QINGDAO YESTERDAY': 0 rows
2026-01-22 09:19:23,144 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Word-based match ['QINGDAO', 'YESTERDAY']: 0 rows
2026-01-22 09:19:23,152 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Fuzzy match: 0 rows
2026-01-22 09:19:23,161 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After port filter: 0 rows matched
2026-01-22 09:40:25,120 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 09:40:25,120 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 09:40:25,120 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 09:40:37,881 - shipping_chatbot - INFO - User_Query: how many containers departed from QINGDAO yesterday, c_codes: ['0000866', '0040070', '0043881']
2026-01-22 09:40:37,881 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'how many containers departed from QINGDAO yesterday', length: 51
2026-01-22 09:40:37,881 - shipping_chatbot - INFO - [DEBUG] q_lower: 'how many containers departed from qingdao yesterday'
2026-01-22 09:40:37,883 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-22 09:43:38,730 - shipping_chatbot - INFO - Fetched 19114 rows
2026-01-22 09:43:38,730 - shipping_chatbot - INFO - Starting preprocessing on 19114 rows
2026-01-22 09:43:38,808 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-22 09:43:39,309 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-22 09:43:39,491 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-22 09:43:40,058 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-22 09:43:40,058 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-22 09:43:40,058 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-22 09:43:40,097 - shipping_chatbot - INFO - Pre-processing finished - 19114 rows remain
2026-01-22 09:43:42,949 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted: container=None, po=None, obl=None
2026-01-22 09:43:42,951 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted load_port: 'QINGDAO'
2026-01-22 09:43:42,953 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Time window: 2026-01-21 00:00:00 to 2026-01-21 00:00:00 (yesterday)
2026-01-22 09:43:43,008 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Port variants to match: {'QINGDAOPORT', 'CNTAO', 'QINGDAO'}
2026-01-22 09:43:43,030 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After port filter: 134 rows matched
2026-01-22 09:43:43,030 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Sample matched ports: ['QINGDAO, SHANDONG(CNTAO)', 'QINGDAO, SHANDONG(CNTAO)', 'QINGDAO, SHANDONG(CNTAO)', 'QINGDAO, SHANDONG(CNTAO)', 'QINGDAO, SHANDONG(CNTAO)']
2026-01-22 09:43:43,030 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After date filter: 2 rows matched
2026-01-22 09:43:43,036 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Sample filtered results:
      container_number dep_for_filter departure_source
18450      MSMU3888268     2026-01-21              ATD
18451      MSBU2773419     2026-01-21              ATD
2026-01-22 09:43:43,043 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Returning 2 records
2026-01-22 10:04:36,345 - shipping_chatbot - INFO - User_Query: how many containers departed from QINGDAO day before yesterday, c_codes: ['0000866', '0040070', '0043881']
2026-01-22 10:04:36,345 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'how many containers departed from QINGDAO day before yesterday', length: 62
2026-01-22 10:04:36,345 - shipping_chatbot - INFO - [DEBUG] q_lower: 'how many containers departed from qingdao day before yesterday'
2026-01-22 10:04:39,093 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted: container=None, po=None, obl=None
2026-01-22 10:04:39,093 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted load_port: 'QINGDAO ON 2025-10-22'
2026-01-22 10:04:39,093 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Time window: 2026-01-22 00:00:00 to 2026-01-28 00:00:00 (next 7 days (default))
2026-01-22 10:04:39,165 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Port variants to match: {'QINGDAO ON 2025-10-22'}
2026-01-22 10:04:39,199 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After port filter: 0 rows matched
2026-01-22 10:08:01,552 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 10:08:01,552 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 10:08:01,552 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 10:08:11,288 - shipping_chatbot - INFO - User_Query: how many containers departed from QINGDAO day before yesterday, c_codes: ['0000866', '0040070', '0043881']
2026-01-22 10:08:11,288 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'how many containers departed from QINGDAO day before yesterday', length: 62
2026-01-22 10:08:11,288 - shipping_chatbot - INFO - [DEBUG] q_lower: 'how many containers departed from qingdao day before yesterday'
2026-01-22 10:08:11,288 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-22 10:08:26,620 - shipping_chatbot - INFO - Fetched 19114 rows
2026-01-22 10:08:26,627 - shipping_chatbot - INFO - Starting preprocessing on 19114 rows
2026-01-22 10:08:26,725 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-22 10:08:27,333 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-22 10:08:27,563 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-22 10:08:28,352 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-22 10:08:28,352 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-22 10:08:28,352 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-22 10:08:28,400 - shipping_chatbot - INFO - Pre-processing finished - 19114 rows remain
2026-01-22 10:08:31,286 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted: container=None, po=None, obl=None
2026-01-22 10:08:31,296 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted load_port: 'QINGDAO ON 2025-10-23'
2026-01-22 10:08:31,303 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Time window: 2026-01-22 00:00:00 to 2026-01-28 00:00:00 (next 7 days (default))
2026-01-22 10:08:31,382 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Port variants to match: {'QINGDAO ON 2025-10-23'}
2026-01-22 10:08:31,401 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After port filter: 0 rows matched
2026-01-22 10:09:27,555 - shipping_chatbot - INFO - User_Query: how many containers departed from QINGDAO day before yesterday, c_codes: ['0000866', '0040070', '0043881']
2026-01-22 10:09:27,555 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'how many containers departed from QINGDAO day before yesterday', length: 62
2026-01-22 10:09:27,555 - shipping_chatbot - INFO - [DEBUG] q_lower: 'how many containers departed from qingdao day before yesterday'
2026-01-22 10:09:30,570 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted: container=None, po=None, obl=None
2026-01-22 10:09:30,570 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted load_port: 'QINGDAO ON 2025-10-22'
2026-01-22 10:09:30,570 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Time window: 2026-01-22 00:00:00 to 2026-01-28 00:00:00 (next 7 days (default))
2026-01-22 10:09:30,662 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Port variants to match: {'QINGDAO ON 2025-10-22'}
2026-01-22 10:09:30,714 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After port filter: 0 rows matched
2026-01-22 10:10:42,904 - shipping_chatbot - INFO - User_Query: how many containers departed from QINGDAO day before yesterday, c_codes: ['0000866', '0040070', '0043881']
2026-01-22 10:10:42,904 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'how many containers departed from QINGDAO day before yesterday', length: 62
2026-01-22 10:10:42,904 - shipping_chatbot - INFO - [DEBUG] q_lower: 'how many containers departed from qingdao day before yesterday'
2026-01-22 10:10:45,799 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted: container=None, po=None, obl=None
2026-01-22 10:10:45,799 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted load_port: 'QINGDAO ON 2025-10-22'
2026-01-22 10:10:45,799 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Time window: 2026-01-22 00:00:00 to 2026-01-28 00:00:00 (next 7 days (default))
2026-01-22 10:10:45,889 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Port variants to match: {'QINGDAO ON 2025-10-22'}
2026-01-22 10:10:45,918 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After port filter: 0 rows matched
2026-01-22 10:17:18,147 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 10:17:18,148 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 10:17:18,148 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 10:18:02,595 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 10:18:02,595 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 10:18:02,595 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 10:18:06,734 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 10:18:06,734 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 10:18:06,734 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 10:18:10,684 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 10:18:10,685 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 10:18:10,685 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 10:18:41,846 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 10:18:41,846 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 10:18:41,846 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 10:19:42,197 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 10:19:42,197 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 10:19:42,197 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 10:19:51,332 - shipping_chatbot - INFO - User_Query: how many containers departed from QINGDAO day before yesterday, c_codes: ['0000866', '0040070', '0043881']
2026-01-22 10:19:51,337 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'how many containers departed from QINGDAO day before yesterday', length: 62
2026-01-22 10:19:51,337 - shipping_chatbot - INFO - [DEBUG] q_lower: 'how many containers departed from qingdao day before yesterday'
2026-01-22 10:19:51,337 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-22 10:20:21,619 - shipping_chatbot - INFO - Fetched 19114 rows
2026-01-22 10:20:21,621 - shipping_chatbot - INFO - Starting preprocessing on 19114 rows
2026-01-22 10:20:21,729 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-22 10:20:22,277 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-22 10:20:22,473 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-22 10:20:23,322 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-22 10:20:23,322 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-22 10:20:23,322 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-22 10:20:23,345 - shipping_chatbot - INFO - Pre-processing finished - 19114 rows remain
2026-01-22 10:20:26,147 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted: container=None, po=None, obl=None
2026-01-22 10:20:26,153 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted load_port: 'QINGDAO ON 2025-10-22'
2026-01-22 10:20:26,156 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Time window: 2026-01-22 00:00:00 to 2026-01-28 00:00:00 (next 7 days (default))
2026-01-22 10:20:26,228 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Port variants to match: {'QINGDAO ON 2025-10-22'}
2026-01-22 10:20:26,253 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After port filter: 0 rows matched
2026-01-22 10:21:03,890 - shipping_chatbot - INFO - User_Query: how many containers departed from QINGDAO day before yesterday, c_codes: ['0000866', '0040070', '0043881']
2026-01-22 10:21:03,890 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'how many containers departed from QINGDAO day before yesterday', length: 62
2026-01-22 10:21:03,890 - shipping_chatbot - INFO - [DEBUG] q_lower: 'how many containers departed from qingdao day before yesterday'
2026-01-22 10:21:06,756 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted: container=None, po=None, obl=None
2026-01-22 10:21:06,756 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted load_port: 'QINGDAO ON 2025-10-23'
2026-01-22 10:21:06,756 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Time window: 2026-01-22 00:00:00 to 2026-01-28 00:00:00 (next 7 days (default))
2026-01-22 10:21:06,867 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Port variants to match: {'QINGDAO ON 2025-10-23'}
2026-01-22 10:21:06,907 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After port filter: 0 rows matched
2026-01-22 10:24:43,478 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 10:24:43,478 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 10:24:43,478 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 10:24:47,399 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 10:24:47,399 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 10:24:47,399 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 10:24:51,956 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 10:24:51,956 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 10:24:51,956 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 10:24:55,728 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 10:24:55,729 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 10:24:55,729 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 10:26:06,258 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 10:26:06,258 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 10:26:06,258 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 10:26:26,771 - shipping_chatbot - INFO - User_Query: how many containers departed from QINGDAO day before yesterday, c_codes: ['0000866', '0040070', '0043881']
2026-01-22 10:26:26,783 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'how many containers departed from QINGDAO day before yesterday', length: 62
2026-01-22 10:26:26,783 - shipping_chatbot - INFO - [DEBUG] q_lower: 'how many containers departed from qingdao day before yesterday'
2026-01-22 10:26:26,783 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-22 10:26:52,411 - shipping_chatbot - INFO - Fetched 19114 rows
2026-01-22 10:26:52,424 - shipping_chatbot - INFO - Starting preprocessing on 19114 rows
2026-01-22 10:26:52,557 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-22 10:26:53,696 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-22 10:26:54,033 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-22 10:26:55,353 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-22 10:26:55,358 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-22 10:26:55,360 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-22 10:26:55,422 - shipping_chatbot - INFO - Pre-processing finished - 19114 rows remain
2026-01-22 10:26:58,275 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted: container=None, po=None, obl=None
2026-01-22 10:26:58,277 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted load_port: 'QINGDAO'
2026-01-22 10:26:58,279 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Time window: 2026-01-20 00:00:00 to 2026-01-20 00:00:00 (day before yesterday)
2026-01-22 10:26:58,357 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Port variants to match: {'CNTAO', 'QINGDAO', 'QINGDAOPORT'}
2026-01-22 10:26:58,386 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After port filter: 134 rows matched
2026-01-22 10:26:58,386 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Sample matched ports: ['QINGDAO, SHANDONG(CNTAO)', 'QINGDAO, SHANDONG(CNTAO)', 'QINGDAO, SHANDONG(CNTAO)', 'QINGDAO, SHANDONG(CNTAO)', 'QINGDAO, SHANDONG(CNTAO)']
2026-01-22 10:26:58,393 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After date filter: 3 rows matched
2026-01-22 10:26:58,410 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Sample filtered results:
      container_number dep_for_filter departure_source
17721      MSKU4393154     2026-01-20              ATD
18281      OOCU8354059     2026-01-20              ATD
18288      OOCU8793365     2026-01-20              ATD
2026-01-22 10:26:58,414 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Returning 3 records
2026-01-22 10:30:07,046 - shipping_chatbot - INFO - User_Query: how many containers departed from CNSHA day before yesterday, c_codes: ['0000866', '0040070', '0043881']
2026-01-22 10:30:07,046 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'how many containers departed from CNSHA day before yesterday', length: 60
2026-01-22 10:30:07,046 - shipping_chatbot - INFO - [DEBUG] q_lower: 'how many containers departed from cnsha day before yesterday'
2026-01-22 10:30:09,518 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted: container=None, po=None, obl=None
2026-01-22 10:30:09,518 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted load_port: 'CNSHA'
2026-01-22 10:30:09,518 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Time window: 2026-01-20 00:00:00 to 2026-01-20 00:00:00 (day before yesterday)
2026-01-22 10:30:09,574 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Port variants to match: {'CNSHA', 'SHANGHAI'}
2026-01-22 10:30:09,597 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After port filter: 161 rows matched
2026-01-22 10:30:09,598 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Sample matched ports: ['SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)']
2026-01-22 10:30:09,600 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After date filter: 4 rows matched
2026-01-22 10:30:09,604 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Sample filtered results:
      container_number dep_for_filter departure_source
18570      PSXU2700726     2026-01-20              ATD
18571      TLLU7515513     2026-01-20              ATD
18572      DRYU9829654     2026-01-20              ATD
18573      CSNU6187455     2026-01-20              ATD
2026-01-22 10:30:09,607 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Returning 4 records
2026-01-22 10:31:07,872 - shipping_chatbot - INFO - User_Query: how many containers departed from CNSHA day before yesterday, c_codes: ['0000866']
2026-01-22 10:31:07,872 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'how many containers departed from CNSHA day before yesterday', length: 60
2026-01-22 10:31:07,872 - shipping_chatbot - INFO - [DEBUG] q_lower: 'how many containers departed from cnsha day before yesterday'
2026-01-22 10:31:10,302 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted: container=None, po=None, obl=None
2026-01-22 10:31:10,302 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted load_port: 'CNSHA'
2026-01-22 10:31:10,302 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Time window: 2026-01-20 00:00:00 to 2026-01-20 00:00:00 (day before yesterday)
2026-01-22 10:31:10,360 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Port variants to match: {'CNSHA', 'SHANGHAI'}
2026-01-22 10:31:10,369 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After port filter: 106 rows matched
2026-01-22 10:31:10,369 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Sample matched ports: ['SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)']
2026-01-22 10:31:10,381 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After date filter: 0 rows matched
2026-01-22 10:39:00,189 - shipping_chatbot - INFO - User_Query: how many containers departed from CNSHA yesterday, c_codes: ['0000866']
2026-01-22 10:39:00,189 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'how many containers departed from CNSHA yesterday', length: 49
2026-01-22 10:39:00,189 - shipping_chatbot - INFO - [DEBUG] q_lower: 'how many containers departed from cnsha yesterday'
2026-01-22 10:39:03,038 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted: container=None, po=None, obl=None
2026-01-22 10:39:03,038 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted load_port: 'CNSHA'
2026-01-22 10:39:03,040 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Time window: 2026-01-21 00:00:00 to 2026-01-21 00:00:00 (yesterday)
2026-01-22 10:39:03,112 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Port variants to match: {'CNSHA', 'SHANGHAI'}
2026-01-22 10:39:03,130 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After port filter: 106 rows matched
2026-01-22 10:39:03,131 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Sample matched ports: ['SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)']
2026-01-22 10:39:03,133 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After date filter: 0 rows matched
2026-01-22 10:45:33,290 - shipping_chatbot - INFO - User_Query: Which containers will arrive in the next 10days at Nashville, c_codes: ['0000866']
2026-01-22 10:45:33,290 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers will arrive in the next 10days at Nashville', length: 60
2026-01-22 10:45:33,290 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers will arrive in the next 10days at nashville'
2026-01-22 10:45:35,935 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 10 days, Dates: 2026-01-22 to 2026-01-31, is_past=False
2026-01-22 10:45:36,096 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found bare port code: USBNA (validated against known codes)
2026-01-22 10:52:10,649 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 10:52:10,649 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 10:52:10,649 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 10:52:20,707 - shipping_chatbot - INFO - User_Query: Which containers will arrive in the next 10days at Nashville, c_codes: ['0000866']
2026-01-22 10:52:20,707 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers will arrive in the next 10days at Nashville', length: 60
2026-01-22 10:52:20,707 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers will arrive in the next 10days at nashville'
2026-01-22 10:52:20,707 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-22 10:52:53,196 - shipping_chatbot - INFO - Fetched 19114 rows
2026-01-22 10:52:53,196 - shipping_chatbot - INFO - Starting preprocessing on 19114 rows
2026-01-22 10:52:53,315 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-22 10:52:54,250 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-22 10:52:54,546 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-22 10:52:55,394 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-22 10:52:55,395 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-22 10:52:55,395 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-22 10:52:55,463 - shipping_chatbot - INFO - Pre-processing finished - 19114 rows remain
2026-01-22 10:52:58,439 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 10 days, Dates: 2026-01-22 to 2026-01-31, is_past=False
2026-01-22 10:52:58,535 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found port code after preposition: USBNA
2026-01-22 10:52:58,535 - shipping_chatbot - ERROR - Agent failed: cannot access local variable 'candidate_tokens' where it is not associated with a value
Traceback (most recent call last):
  File "D:\chatbot16012026\StlnkWebNprdChatV2\api\main.py", line 342, in ask
    result = AGENT.invoke({"input": q})
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\chains\base.py", line 166, in invoke
    raise e
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\chains\base.py", line 156, in invoke
    self._call(inputs, run_manager=run_manager)
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1433, in _call
    next_step_output = self._take_next_step(
                       ^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1139, in _take_next_step
    [
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1139, in <listcomp>
    [
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1224, in _iter_next_step
    yield self._perform_agent_action(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1246, in _perform_agent_action
    observation = tool.run(
                  ^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\base.py", line 586, in run
    raise error_to_raise
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\base.py", line 555, in run
    response = context.run(self._run, *tool_args, **tool_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\simple.py", line 84, in _run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot16012026\StlnkWebNprdChatV2\agents\tools.py", line 3944, in get_upcoming_arrivals
    for t in candidate_tokens
             ^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'candidate_tokens' where it is not associated with a value
2026-01-22 10:52:58,695 - shipping_chatbot - INFO - Router: Set consignee codes ['0000866'] for query: Which containers will arrive in the next 10days at Nashville
2026-01-22 10:52:58,748 - shipping_chatbot - INFO - Consignee filtering validated: 2095 rows for codes ['0000866']
2026-01-22 10:52:58,762 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 7 days (default), Dates: 2026-01-22 to 2026-01-28, is_past=False
2026-01-22 10:52:58,848 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found city location: Nashville (normalized: NASHVILLE)
2026-01-22 10:52:58,848 - shipping_chatbot - INFO - [get_upcoming_arrivals] Applying location filter for 'NASHVILLE'. Rows before filter: 2095, Matching rows: 1715
2026-01-22 10:52:58,850 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample ports after filter: ['SAVANNAH, GA(USSAV)']
2026-01-22 10:52:58,854 - shipping_chatbot - INFO - [get_upcoming_arrivals] Returning 17 containers. Unique discharge ports in result: ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 10:52:58,854 - shipping_chatbot - WARNING - [get_upcoming_arrivals] WARNING: Multiple ports in result when filtering for 'NASHVILLE': ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 10:53:14,722 - shipping_chatbot - INFO - User_Query: Which containers will arrive in the next 10days at Nashville, c_codes: ['0000866']
2026-01-22 10:53:14,723 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers will arrive in the next 10days at Nashville', length: 60
2026-01-22 10:53:14,723 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers will arrive in the next 10days at nashville'
2026-01-22 10:53:17,166 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 10 days, Dates: 2026-01-22 to 2026-01-31, is_past=False
2026-01-22 10:53:17,272 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found port code after preposition: USBNA
2026-01-22 10:53:17,272 - shipping_chatbot - ERROR - Agent failed: cannot access local variable 'candidate_tokens' where it is not associated with a value
Traceback (most recent call last):
  File "D:\chatbot16012026\StlnkWebNprdChatV2\api\main.py", line 342, in ask
    result = AGENT.invoke({"input": q})
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\chains\base.py", line 166, in invoke
    raise e
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\chains\base.py", line 156, in invoke
    self._call(inputs, run_manager=run_manager)
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1433, in _call
    next_step_output = self._take_next_step(
                       ^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1139, in _take_next_step
    [
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1139, in <listcomp>
    [
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1224, in _iter_next_step
    yield self._perform_agent_action(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1246, in _perform_agent_action
    observation = tool.run(
                  ^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\base.py", line 586, in run
    raise error_to_raise
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\base.py", line 555, in run
    response = context.run(self._run, *tool_args, **tool_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\simple.py", line 84, in _run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot16012026\StlnkWebNprdChatV2\agents\tools.py", line 3944, in get_upcoming_arrivals
    for t in candidate_tokens
             ^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'candidate_tokens' where it is not associated with a value
2026-01-22 10:53:17,272 - shipping_chatbot - INFO - Router: Set consignee codes ['0000866'] for query: Which containers will arrive in the next 10days at Nashville
2026-01-22 10:53:17,354 - shipping_chatbot - INFO - Consignee filtering validated: 2095 rows for codes ['0000866']
2026-01-22 10:53:17,355 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 7 days (default), Dates: 2026-01-22 to 2026-01-28, is_past=False
2026-01-22 10:53:17,452 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found city location: Nashville (normalized: NASHVILLE)
2026-01-22 10:53:17,452 - shipping_chatbot - INFO - [get_upcoming_arrivals] Applying location filter for 'NASHVILLE'. Rows before filter: 2095, Matching rows: 1715
2026-01-22 10:53:17,455 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample ports after filter: ['SAVANNAH, GA(USSAV)']
2026-01-22 10:53:17,462 - shipping_chatbot - INFO - [get_upcoming_arrivals] Returning 17 containers. Unique discharge ports in result: ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 10:53:17,462 - shipping_chatbot - WARNING - [get_upcoming_arrivals] WARNING: Multiple ports in result when filtering for 'NASHVILLE': ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 10:54:04,756 - shipping_chatbot - INFO - User_Query: Which containers will arrive in the next 10days at Nashville, c_codes: ['0000866']
2026-01-22 10:54:04,757 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers will arrive in the next 10days at Nashville', length: 60
2026-01-22 10:54:04,757 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers will arrive in the next 10days at nashville'
2026-01-22 10:54:07,117 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 10 days, Dates: 2026-01-22 to 2026-01-31, is_past=False
2026-01-22 10:55:03,428 - shipping_chatbot - INFO - User_Query: Which containers will arrive in the next 10days at Nashville, c_codes: ['0000866']
2026-01-22 10:55:03,428 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers will arrive in the next 10days at Nashville', length: 60
2026-01-22 10:55:03,428 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers will arrive in the next 10days at nashville'
2026-01-22 10:55:05,935 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 10 days, Dates: 2026-01-22 to 2026-01-31, is_past=False
2026-01-22 10:55:06,030 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found port code after preposition: USBNA
2026-01-22 10:55:06,031 - shipping_chatbot - ERROR - Agent failed: cannot access local variable 'candidate_tokens' where it is not associated with a value
Traceback (most recent call last):
  File "D:\chatbot16012026\StlnkWebNprdChatV2\api\main.py", line 342, in ask
    result = AGENT.invoke({"input": q})
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\chains\base.py", line 166, in invoke
    raise e
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\chains\base.py", line 156, in invoke
    self._call(inputs, run_manager=run_manager)
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1433, in _call
    next_step_output = self._take_next_step(
                       ^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1139, in _take_next_step
    [
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1139, in <listcomp>
    [
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1224, in _iter_next_step
    yield self._perform_agent_action(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1246, in _perform_agent_action
    observation = tool.run(
                  ^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\base.py", line 586, in run
    raise error_to_raise
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\base.py", line 555, in run
    response = context.run(self._run, *tool_args, **tool_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\simple.py", line 84, in _run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot16012026\StlnkWebNprdChatV2\agents\tools.py", line 3944, in get_upcoming_arrivals
    for t in candidate_tokens
             ^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'candidate_tokens' where it is not associated with a value
2026-01-22 10:55:06,033 - shipping_chatbot - INFO - Router: Set consignee codes ['0000866'] for query: Which containers will arrive in the next 10days at Nashville
2026-01-22 10:55:06,114 - shipping_chatbot - INFO - Consignee filtering validated: 2095 rows for codes ['0000866']
2026-01-22 10:55:06,115 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 7 days (default), Dates: 2026-01-22 to 2026-01-28, is_past=False
2026-01-22 10:55:06,218 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found city location: Nashville (normalized: NASHVILLE)
2026-01-22 10:55:06,218 - shipping_chatbot - INFO - [get_upcoming_arrivals] Applying location filter for 'NASHVILLE'. Rows before filter: 2095, Matching rows: 1715
2026-01-22 10:55:06,221 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample ports after filter: ['SAVANNAH, GA(USSAV)']
2026-01-22 10:55:06,228 - shipping_chatbot - INFO - [get_upcoming_arrivals] Returning 17 containers. Unique discharge ports in result: ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 10:55:06,229 - shipping_chatbot - WARNING - [get_upcoming_arrivals] WARNING: Multiple ports in result when filtering for 'NASHVILLE': ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 10:55:23,978 - shipping_chatbot - INFO - User_Query: Which containers will arrive in the next 10days at Nashville, c_codes: ['0000866']
2026-01-22 10:55:23,978 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers will arrive in the next 10days at Nashville', length: 60
2026-01-22 10:55:23,978 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers will arrive in the next 10days at nashville'
2026-01-22 10:55:26,515 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 10 days, Dates: 2026-01-22 to 2026-01-31, is_past=False
2026-01-22 11:00:13,931 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 11:00:13,931 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 11:00:13,931 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 11:00:20,174 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 11:00:20,175 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 11:00:20,175 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 11:00:26,670 - shipping_chatbot - INFO - User_Query: Which containers will arrive in the next 10days at Nashville, c_codes: ['0000866']
2026-01-22 11:00:26,672 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers will arrive in the next 10days at Nashville', length: 60
2026-01-22 11:00:26,672 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers will arrive in the next 10days at nashville'
2026-01-22 11:00:26,672 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-22 11:00:52,751 - shipping_chatbot - INFO - Fetched 19114 rows
2026-01-22 11:00:52,751 - shipping_chatbot - INFO - Starting preprocessing on 19114 rows
2026-01-22 11:00:52,868 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-22 11:00:53,752 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-22 11:00:54,042 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-22 11:00:54,793 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-22 11:00:54,795 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-22 11:00:54,795 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-22 11:00:54,829 - shipping_chatbot - INFO - Pre-processing finished - 19114 rows remain
2026-01-22 11:00:57,349 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 10 days, Dates: 2026-01-22 to 2026-01-31, is_past=False
2026-01-22 11:00:57,443 - shipping_chatbot - INFO - [get_upcoming_arrivals] Extracted 48 known port codes from dataset
2026-01-22 11:00:57,444 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample known codes: ['CAVAN', 'USORD', 'USIND', 'USSPX', 'USCMH', 'USFBX', 'USWAS', 'USSAV', 'USSEA', 'USPDX', 'USWOS', 'USHIB', 'USIAD', 'USMJB', 'HKHKG', 'USEWR', 'USJFK', 'USUXE', 'USLAX', 'CAPRR']
2026-01-22 11:00:57,444 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found port code after preposition: USBNA
2026-01-22 11:00:57,444 - shipping_chatbot - INFO - [get_upcoming_arrivals] Is USBNA in known_codes? True
2026-01-22 11:00:57,446 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 112 matches in column 'discharge_port'
2026-01-22 11:00:57,446 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 101 matches in column 'vehicle_arrival_lcn'
2026-01-22 11:00:57,449 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 1548 matches in column 'final_destination'
2026-01-22 11:00:57,452 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 1526 matches in column 'place_of_delivery'
2026-01-22 11:00:57,452 - shipping_chatbot - INFO - [get_upcoming_arrivals] Successfully detected port code 'USBNA' after preposition. Matched 1715 rows.
2026-01-22 11:00:57,453 - shipping_chatbot - ERROR - Agent failed: cannot access local variable 'candidate_tokens' where it is not associated with a value
Traceback (most recent call last):
  File "D:\chatbot16012026\StlnkWebNprdChatV2\api\main.py", line 342, in ask
    result = AGENT.invoke({"input": q})
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\chains\base.py", line 166, in invoke
    raise e
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\chains\base.py", line 156, in invoke
    self._call(inputs, run_manager=run_manager)
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1433, in _call
    next_step_output = self._take_next_step(
                       ^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1139, in _take_next_step
    [
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1139, in <listcomp>
    [
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1224, in _iter_next_step
    yield self._perform_agent_action(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1246, in _perform_agent_action
    observation = tool.run(
                  ^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\base.py", line 586, in run
    raise error_to_raise
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\base.py", line 555, in run
    response = context.run(self._run, *tool_args, **tool_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\simple.py", line 84, in _run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot16012026\StlnkWebNprdChatV2\agents\tools.py", line 3966, in get_upcoming_arrivals
    for t in candidate_tokens
             ^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'candidate_tokens' where it is not associated with a value
2026-01-22 11:00:57,459 - shipping_chatbot - INFO - Router: Set consignee codes ['0000866'] for query: Which containers will arrive in the next 10days at Nashville
2026-01-22 11:00:57,534 - shipping_chatbot - INFO - Consignee filtering validated: 2095 rows for codes ['0000866']
2026-01-22 11:00:57,538 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 7 days (default), Dates: 2026-01-22 to 2026-01-28, is_past=False
2026-01-22 11:00:57,627 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found city location: Nashville (normalized: NASHVILLE)
2026-01-22 11:00:57,627 - shipping_chatbot - INFO - [get_upcoming_arrivals] Applying location filter for 'NASHVILLE'. Rows before filter: 2095, Matching rows: 1715
2026-01-22 11:00:57,629 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample ports after filter: ['SAVANNAH, GA(USSAV)']
2026-01-22 11:00:57,637 - shipping_chatbot - INFO - [get_upcoming_arrivals] Returning 17 containers. Unique discharge ports in result: ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 11:00:57,637 - shipping_chatbot - WARNING - [get_upcoming_arrivals] WARNING: Multiple ports in result when filtering for 'NASHVILLE': ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 11:01:18,807 - shipping_chatbot - INFO - User_Query: Which containers will arrive in the next 10days at Nashville, c_codes: ['0000866']
2026-01-22 11:01:18,807 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers will arrive in the next 10days at Nashville', length: 60
2026-01-22 11:01:18,807 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers will arrive in the next 10days at nashville'
2026-01-22 11:01:21,655 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 10 days, Dates: 2026-01-22 to 2026-01-31, is_past=False
2026-01-22 11:01:21,753 - shipping_chatbot - INFO - [get_upcoming_arrivals] Extracted 48 known port codes from dataset
2026-01-22 11:01:21,754 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample known codes: ['CAVAN', 'USORD', 'USIND', 'USSPX', 'USCMH', 'USFBX', 'USWAS', 'USSAV', 'USSEA', 'USPDX', 'USWOS', 'USHIB', 'USIAD', 'USMJB', 'HKHKG', 'USEWR', 'USJFK', 'USUXE', 'USLAX', 'CAPRR']
2026-01-22 11:01:21,755 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found port code after preposition: USBNA
2026-01-22 11:01:21,755 - shipping_chatbot - INFO - [get_upcoming_arrivals] Is USBNA in known_codes? True
2026-01-22 11:01:21,757 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 112 matches in column 'discharge_port'
2026-01-22 11:01:21,758 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 101 matches in column 'vehicle_arrival_lcn'
2026-01-22 11:01:21,758 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 1548 matches in column 'final_destination'
2026-01-22 11:01:21,763 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 1526 matches in column 'place_of_delivery'
2026-01-22 11:01:21,763 - shipping_chatbot - INFO - [get_upcoming_arrivals] Successfully detected port code 'USBNA' after preposition. Matched 1715 rows.
2026-01-22 11:01:21,763 - shipping_chatbot - ERROR - Agent failed: cannot access local variable 'candidate_tokens' where it is not associated with a value
Traceback (most recent call last):
  File "D:\chatbot16012026\StlnkWebNprdChatV2\api\main.py", line 342, in ask
    result = AGENT.invoke({"input": q})
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\chains\base.py", line 166, in invoke
    raise e
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\chains\base.py", line 156, in invoke
    self._call(inputs, run_manager=run_manager)
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1433, in _call
    next_step_output = self._take_next_step(
                       ^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1139, in _take_next_step
    [
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1139, in <listcomp>
    [
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1224, in _iter_next_step
    yield self._perform_agent_action(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1246, in _perform_agent_action
    observation = tool.run(
                  ^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\base.py", line 586, in run
    raise error_to_raise
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\base.py", line 555, in run
    response = context.run(self._run, *tool_args, **tool_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\simple.py", line 84, in _run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot16012026\StlnkWebNprdChatV2\agents\tools.py", line 3966, in get_upcoming_arrivals
    for t in candidate_tokens
             ^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'candidate_tokens' where it is not associated with a value
2026-01-22 11:01:21,765 - shipping_chatbot - INFO - Router: Set consignee codes ['0000866'] for query: Which containers will arrive in the next 10days at Nashville
2026-01-22 11:01:21,810 - shipping_chatbot - INFO - Consignee filtering validated: 2095 rows for codes ['0000866']
2026-01-22 11:01:21,810 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 7 days (default), Dates: 2026-01-22 to 2026-01-28, is_past=False
2026-01-22 11:01:21,893 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found city location: Nashville (normalized: NASHVILLE)
2026-01-22 11:01:21,893 - shipping_chatbot - INFO - [get_upcoming_arrivals] Applying location filter for 'NASHVILLE'. Rows before filter: 2095, Matching rows: 1715
2026-01-22 11:01:21,893 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample ports after filter: ['SAVANNAH, GA(USSAV)']
2026-01-22 11:01:21,908 - shipping_chatbot - INFO - [get_upcoming_arrivals] Returning 17 containers. Unique discharge ports in result: ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 11:01:21,908 - shipping_chatbot - WARNING - [get_upcoming_arrivals] WARNING: Multiple ports in result when filtering for 'NASHVILLE': ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 11:01:32,000 - shipping_chatbot - INFO - User_Query: Which containers will arrive in the next 10days at Nashville, c_codes: ['0000866']
2026-01-22 11:01:32,000 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers will arrive in the next 10days at Nashville', length: 60
2026-01-22 11:01:32,000 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers will arrive in the next 10days at nashville'
2026-01-22 11:01:34,357 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 10 days, Dates: 2026-01-22 to 2026-01-31, is_past=False
2026-01-22 11:01:34,462 - shipping_chatbot - INFO - [get_upcoming_arrivals] Extracted 48 known port codes from dataset
2026-01-22 11:01:34,462 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample known codes: ['CAVAN', 'USORD', 'USIND', 'USSPX', 'USCMH', 'USFBX', 'USWAS', 'USSAV', 'USSEA', 'USPDX', 'USWOS', 'USHIB', 'USIAD', 'USMJB', 'HKHKG', 'USEWR', 'USJFK', 'USUXE', 'USLAX', 'CAPRR']
2026-01-22 11:01:34,462 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found port code after preposition: USBNA
2026-01-22 11:01:34,463 - shipping_chatbot - INFO - [get_upcoming_arrivals] Is USBNA in known_codes? True
2026-01-22 11:01:34,465 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 112 matches in column 'discharge_port'
2026-01-22 11:01:34,466 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 101 matches in column 'vehicle_arrival_lcn'
2026-01-22 11:01:34,469 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 1548 matches in column 'final_destination'
2026-01-22 11:01:34,471 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 1526 matches in column 'place_of_delivery'
2026-01-22 11:01:34,471 - shipping_chatbot - INFO - [get_upcoming_arrivals] Successfully detected port code 'USBNA' after preposition. Matched 1715 rows.
2026-01-22 11:01:34,471 - shipping_chatbot - ERROR - Agent failed: cannot access local variable 'candidate_tokens' where it is not associated with a value
Traceback (most recent call last):
  File "D:\chatbot16012026\StlnkWebNprdChatV2\api\main.py", line 342, in ask
    result = AGENT.invoke({"input": q})
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\chains\base.py", line 166, in invoke
    raise e
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\chains\base.py", line 156, in invoke
    self._call(inputs, run_manager=run_manager)
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1433, in _call
    next_step_output = self._take_next_step(
                       ^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1139, in _take_next_step
    [
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1139, in <listcomp>
    [
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1224, in _iter_next_step
    yield self._perform_agent_action(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1246, in _perform_agent_action
    observation = tool.run(
                  ^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\base.py", line 586, in run
    raise error_to_raise
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\base.py", line 555, in run
    response = context.run(self._run, *tool_args, **tool_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\simple.py", line 84, in _run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot16012026\StlnkWebNprdChatV2\agents\tools.py", line 3966, in get_upcoming_arrivals
    for t in candidate_tokens
             ^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'candidate_tokens' where it is not associated with a value
2026-01-22 11:01:34,473 - shipping_chatbot - INFO - Router: Set consignee codes ['0000866'] for query: Which containers will arrive in the next 10days at Nashville
2026-01-22 11:01:34,543 - shipping_chatbot - INFO - Consignee filtering validated: 2095 rows for codes ['0000866']
2026-01-22 11:01:34,543 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 7 days (default), Dates: 2026-01-22 to 2026-01-28, is_past=False
2026-01-22 11:01:34,651 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found city location: Nashville (normalized: NASHVILLE)
2026-01-22 11:01:34,651 - shipping_chatbot - INFO - [get_upcoming_arrivals] Applying location filter for 'NASHVILLE'. Rows before filter: 2095, Matching rows: 1715
2026-01-22 11:01:34,655 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample ports after filter: ['SAVANNAH, GA(USSAV)']
2026-01-22 11:01:34,661 - shipping_chatbot - INFO - [get_upcoming_arrivals] Returning 17 containers. Unique discharge ports in result: ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 11:01:34,661 - shipping_chatbot - WARNING - [get_upcoming_arrivals] WARNING: Multiple ports in result when filtering for 'NASHVILLE': ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 11:01:59,332 - shipping_chatbot - INFO - User_Query: Which containers will arrive in the next 10days at Nashville, c_codes: ['0000866']
2026-01-22 11:01:59,332 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers will arrive in the next 10days at Nashville', length: 60
2026-01-22 11:01:59,332 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers will arrive in the next 10days at nashville'
2026-01-22 11:02:01,787 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 10 days, Dates: 2026-01-22 to 2026-01-31, is_past=False
2026-01-22 11:02:01,900 - shipping_chatbot - INFO - [get_upcoming_arrivals] Extracted 48 known port codes from dataset
2026-01-22 11:02:01,900 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample known codes: ['CAVAN', 'USORD', 'USIND', 'USSPX', 'USCMH', 'USFBX', 'USWAS', 'USSAV', 'USSEA', 'USPDX', 'USWOS', 'USHIB', 'USIAD', 'USMJB', 'HKHKG', 'USEWR', 'USJFK', 'USUXE', 'USLAX', 'CAPRR']
2026-01-22 11:02:01,900 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found port code after preposition: USBNA
2026-01-22 11:02:01,901 - shipping_chatbot - INFO - [get_upcoming_arrivals] Is USBNA in known_codes? True
2026-01-22 11:02:01,902 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 112 matches in column 'discharge_port'
2026-01-22 11:02:01,903 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 101 matches in column 'vehicle_arrival_lcn'
2026-01-22 11:02:01,904 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 1548 matches in column 'final_destination'
2026-01-22 11:02:01,905 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 1526 matches in column 'place_of_delivery'
2026-01-22 11:02:01,905 - shipping_chatbot - INFO - [get_upcoming_arrivals] Successfully detected port code 'USBNA' after preposition. Matched 1715 rows.
2026-01-22 11:02:01,905 - shipping_chatbot - ERROR - Agent failed: cannot access local variable 'candidate_tokens' where it is not associated with a value
Traceback (most recent call last):
  File "D:\chatbot16012026\StlnkWebNprdChatV2\api\main.py", line 342, in ask
    result = AGENT.invoke({"input": q})
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\chains\base.py", line 166, in invoke
    raise e
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\chains\base.py", line 156, in invoke
    self._call(inputs, run_manager=run_manager)
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1433, in _call
    next_step_output = self._take_next_step(
                       ^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1139, in _take_next_step
    [
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1139, in <listcomp>
    [
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1224, in _iter_next_step
    yield self._perform_agent_action(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1246, in _perform_agent_action
    observation = tool.run(
                  ^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\base.py", line 586, in run
    raise error_to_raise
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\base.py", line 555, in run
    response = context.run(self._run, *tool_args, **tool_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\simple.py", line 84, in _run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot16012026\StlnkWebNprdChatV2\agents\tools.py", line 3966, in get_upcoming_arrivals
    for t in candidate_tokens
             ^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'candidate_tokens' where it is not associated with a value
2026-01-22 11:02:01,908 - shipping_chatbot - INFO - Router: Set consignee codes ['0000866'] for query: Which containers will arrive in the next 10days at Nashville
2026-01-22 11:02:01,978 - shipping_chatbot - INFO - Consignee filtering validated: 2095 rows for codes ['0000866']
2026-01-22 11:02:01,980 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 7 days (default), Dates: 2026-01-22 to 2026-01-28, is_past=False
2026-01-22 11:02:02,073 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found city location: Nashville (normalized: NASHVILLE)
2026-01-22 11:02:02,074 - shipping_chatbot - INFO - [get_upcoming_arrivals] Applying location filter for 'NASHVILLE'. Rows before filter: 2095, Matching rows: 1715
2026-01-22 11:02:02,078 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample ports after filter: ['SAVANNAH, GA(USSAV)']
2026-01-22 11:02:02,086 - shipping_chatbot - INFO - [get_upcoming_arrivals] Returning 17 containers. Unique discharge ports in result: ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 11:02:02,086 - shipping_chatbot - WARNING - [get_upcoming_arrivals] WARNING: Multiple ports in result when filtering for 'NASHVILLE': ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 11:08:26,823 - shipping_chatbot - INFO - User_Query: Which containers will arrive in the next 10days at Nashville, c_codes: ['0000866']
2026-01-22 11:08:26,823 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers will arrive in the next 10days at Nashville', length: 60
2026-01-22 11:08:26,823 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers will arrive in the next 10days at nashville'
2026-01-22 11:08:29,260 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 10 days, Dates: 2026-01-22 to 2026-01-31, is_past=False
2026-01-22 11:08:29,364 - shipping_chatbot - INFO - [get_upcoming_arrivals] Extracted 48 known port codes from dataset
2026-01-22 11:08:29,364 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample known codes: ['CAVAN', 'USORD', 'USIND', 'USSPX', 'USCMH', 'USFBX', 'USWAS', 'USSAV', 'USSEA', 'USPDX', 'USWOS', 'USHIB', 'USIAD', 'USMJB', 'HKHKG', 'USEWR', 'USJFK', 'USUXE', 'USLAX', 'CAPRR']
2026-01-22 11:08:29,364 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found port code after preposition: USBNA
2026-01-22 11:08:29,364 - shipping_chatbot - INFO - [get_upcoming_arrivals] Is USBNA in known_codes? True
2026-01-22 11:08:29,369 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 112 matches in column 'discharge_port'
2026-01-22 11:08:29,369 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 101 matches in column 'vehicle_arrival_lcn'
2026-01-22 11:08:29,372 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 1548 matches in column 'final_destination'
2026-01-22 11:08:29,374 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 1526 matches in column 'place_of_delivery'
2026-01-22 11:08:29,374 - shipping_chatbot - INFO - [get_upcoming_arrivals] Successfully detected port code 'USBNA' after preposition. Matched 1715 rows.
2026-01-22 11:08:29,375 - shipping_chatbot - ERROR - Agent failed: cannot access local variable 'candidate_tokens' where it is not associated with a value
Traceback (most recent call last):
  File "D:\chatbot16012026\StlnkWebNprdChatV2\api\main.py", line 342, in ask
    result = AGENT.invoke({"input": q})
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\chains\base.py", line 166, in invoke
    raise e
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\chains\base.py", line 156, in invoke
    self._call(inputs, run_manager=run_manager)
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1433, in _call
    next_step_output = self._take_next_step(
                       ^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1139, in _take_next_step
    [
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1139, in <listcomp>
    [
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1224, in _iter_next_step
    yield self._perform_agent_action(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain\agents\agent.py", line 1246, in _perform_agent_action
    observation = tool.run(
                  ^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\base.py", line 586, in run
    raise error_to_raise
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\base.py", line 555, in run
    response = context.run(self._run, *tool_args, **tool_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot15102025\StlnkWebNprdChatV2-main\venv\Lib\site-packages\langchain_core\tools\simple.py", line 84, in _run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\chatbot16012026\StlnkWebNprdChatV2\agents\tools.py", line 3966, in get_upcoming_arrivals
    for t in candidate_tokens
             ^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'candidate_tokens' where it is not associated with a value
2026-01-22 11:08:29,378 - shipping_chatbot - INFO - Router: Set consignee codes ['0000866'] for query: Which containers will arrive in the next 10days at Nashville
2026-01-22 11:08:29,451 - shipping_chatbot - INFO - Consignee filtering validated: 2095 rows for codes ['0000866']
2026-01-22 11:08:29,452 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 7 days (default), Dates: 2026-01-22 to 2026-01-28, is_past=False
2026-01-22 11:08:29,550 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found city location: Nashville (normalized: NASHVILLE)
2026-01-22 11:08:29,550 - shipping_chatbot - INFO - [get_upcoming_arrivals] Applying location filter for 'NASHVILLE'. Rows before filter: 2095, Matching rows: 1715
2026-01-22 11:08:29,552 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample ports after filter: ['SAVANNAH, GA(USSAV)']
2026-01-22 11:08:29,559 - shipping_chatbot - INFO - [get_upcoming_arrivals] Returning 17 containers. Unique discharge ports in result: ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 11:08:29,559 - shipping_chatbot - WARNING - [get_upcoming_arrivals] WARNING: Multiple ports in result when filtering for 'NASHVILLE': ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 11:10:08,182 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 11:10:08,186 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 11:10:08,186 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 11:10:13,097 - shipping_chatbot - INFO - User_Query: Which containers will arrive in the next 10days at Nashville, c_codes: ['0000866']
2026-01-22 11:10:13,097 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers will arrive in the next 10days at Nashville', length: 60
2026-01-22 11:10:13,097 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers will arrive in the next 10days at nashville'
2026-01-22 11:10:13,097 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-22 11:10:48,754 - shipping_chatbot - INFO - Fetched 19114 rows
2026-01-22 11:10:48,759 - shipping_chatbot - INFO - Starting preprocessing on 19114 rows
2026-01-22 11:10:48,825 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-22 11:10:49,350 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-22 11:10:49,516 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-22 11:10:50,075 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-22 11:10:50,078 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-22 11:10:50,078 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-22 11:10:50,104 - shipping_chatbot - INFO - Pre-processing finished - 19114 rows remain
2026-01-22 11:10:52,741 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 10 days, Dates: 2026-01-22 to 2026-01-31, is_past=False
2026-01-22 11:10:52,799 - shipping_chatbot - INFO - [get_upcoming_arrivals] Extracted 48 known port codes from dataset
2026-01-22 11:10:52,799 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample known codes: ['USUXE', 'CNXMN', 'USSPX', 'CNTXG', 'USNYC', 'USSEA', 'CNPVG', 'USIAD', 'CAVAN', 'USWOS', 'USJFK', 'HKHKG', 'USLBA', 'USEWR', 'USCVG', 'DEHAM', 'USORD', 'USHIB', 'USBNA', 'USIND']
2026-01-22 11:10:52,799 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found port code after preposition: USBNA
2026-01-22 11:10:52,799 - shipping_chatbot - INFO - [get_upcoming_arrivals] Is USBNA in known_codes? True
2026-01-22 11:10:52,799 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 112 matches in column 'discharge_port'
2026-01-22 11:10:52,799 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 101 matches in column 'vehicle_arrival_lcn'
2026-01-22 11:10:52,799 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 1548 matches in column 'final_destination'
2026-01-22 11:10:52,814 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 1526 matches in column 'place_of_delivery'
2026-01-22 11:10:52,815 - shipping_chatbot - INFO - [get_upcoming_arrivals] Successfully detected port code 'USBNA' after preposition. Matched 1715 rows.
2026-01-22 11:10:52,815 - shipping_chatbot - INFO - [get_upcoming_arrivals] Applying location filter for 'USBNA'. Rows before filter: 2095, Matching rows: 1715
2026-01-22 11:10:52,819 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample ports after filter: ['SAVANNAH, GA(USSAV)']
2026-01-22 11:10:52,821 - shipping_chatbot - INFO - [get_upcoming_arrivals] Returning 18 containers. Unique discharge ports in result: ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 11:10:52,821 - shipping_chatbot - WARNING - [get_upcoming_arrivals] WARNING: Multiple ports in result when filtering for 'USBNA': ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 11:21:23,524 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 11:21:23,524 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 11:21:23,524 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 11:21:28,159 - shipping_chatbot - INFO - User_Query: Which containers will arrive in the next 10days at Nashville, c_codes: ['0000866']
2026-01-22 11:21:28,159 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers will arrive in the next 10days at Nashville', length: 60
2026-01-22 11:21:28,159 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers will arrive in the next 10days at nashville'
2026-01-22 11:21:28,159 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-22 11:21:58,751 - shipping_chatbot - INFO - Fetched 19114 rows
2026-01-22 11:21:58,751 - shipping_chatbot - INFO - Starting preprocessing on 19114 rows
2026-01-22 11:21:58,853 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-22 11:21:59,573 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-22 11:21:59,857 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-22 11:22:00,806 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-22 11:22:00,806 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-22 11:22:00,822 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-22 11:22:00,863 - shipping_chatbot - INFO - Pre-processing finished - 19114 rows remain
2026-01-22 11:22:03,384 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 10 days, Dates: 2026-01-22 to 2026-01-31, is_past=False
2026-01-22 11:22:03,482 - shipping_chatbot - INFO - [get_upcoming_arrivals] Extracted 48 known port codes from dataset
2026-01-22 11:22:03,482 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample known codes: ['USBNA', 'USATL', 'USUXE', 'USDFW', 'USHIB', 'USTCN', 'DENSS', 'USCHS', 'USTIW', 'USLGB', 'USCMH', 'USNYC', 'CAYVR', 'USMJB', 'DEHAM', 'USSAV', 'USCVG', 'CNXMN', 'USIAH', 'USDAL']
2026-01-22 11:22:03,483 - shipping_chatbot - INFO - [get_upcoming_arrivals] Checking for port code after preposition in query: 'CONTAINERS ARRIVING AT USBNA IN NEXT 10 DAYS'
2026-01-22 11:22:03,484 - shipping_chatbot - INFO - [get_upcoming_arrivals] prep_code_match found: True
2026-01-22 11:22:03,484 - shipping_chatbot - INFO - [get_upcoming_arrivals] Matched port code: USBNA
2026-01-22 11:22:03,485 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found port code after preposition: USBNA
2026-01-22 11:22:03,485 - shipping_chatbot - INFO - [get_upcoming_arrivals] Is USBNA in known_codes? True
2026-01-22 11:22:03,488 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 112 matches in column 'discharge_port'
2026-01-22 11:22:03,489 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 101 matches in column 'vehicle_arrival_lcn'
2026-01-22 11:22:03,492 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 1548 matches in column 'final_destination'
2026-01-22 11:22:03,494 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 1526 matches in column 'place_of_delivery'
2026-01-22 11:22:03,494 - shipping_chatbot - INFO - [get_upcoming_arrivals]  Successfully detected port code 'USBNA' after preposition. Matched 1715 rows. location_found=True
2026-01-22 11:22:03,495 - shipping_chatbot - INFO - [get_upcoming_arrivals] Applying location filter for 'USBNA'. Rows before filter: 2095, Matching rows: 1715
2026-01-22 11:22:03,496 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample ports after filter: ['SAVANNAH, GA(USSAV)']
2026-01-22 11:22:03,507 - shipping_chatbot - INFO - [get_upcoming_arrivals] Returning 18 containers. Unique discharge ports in result: ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 11:22:03,507 - shipping_chatbot - ERROR - [get_upcoming_arrivals] *** CRITICAL ERROR ***: Multiple ports in result when filtering for 'USBNA': ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 11:22:03,508 - shipping_chatbot - ERROR - [get_upcoming_arrivals] This indicates the port filter was NOT applied correctly!
2026-01-22 11:22:03,508 - shipping_chatbot - ERROR - [get_upcoming_arrivals] location_found=True, location_name=USBNA
2026-01-22 11:22:03,510 - shipping_chatbot - INFO - [get_upcoming_arrivals] Emergency filter applied. Now returning 2 containers from USBNA only.
2026-01-22 11:28:51,797 - shipping_chatbot - INFO - User_Query: how many containers departed from CNSHA day before yesterday, c_codes: ['0000866']
2026-01-22 11:28:51,797 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'how many containers departed from CNSHA day before yesterday', length: 60
2026-01-22 11:28:51,798 - shipping_chatbot - INFO - [DEBUG] q_lower: 'how many containers departed from cnsha day before yesterday'
2026-01-22 11:28:54,706 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted: container=None, po=None, obl=None
2026-01-22 11:28:54,708 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted load_port: 'CNSHA'
2026-01-22 11:28:54,709 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Time window: 2026-01-20 00:00:00 to 2026-01-20 00:00:00 (day before yesterday)
2026-01-22 11:28:54,840 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Port variants to match: {'SHANGHAI', 'CNSHA'}
2026-01-22 11:28:54,884 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After port filter: 106 rows matched
2026-01-22 11:28:54,886 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Sample matched ports: ['SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)']
2026-01-22 11:28:54,892 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After date filter: 0 rows matched
2026-01-22 11:30:13,942 - shipping_chatbot - INFO - User_Query: how many containers departed from CNSHA last week, c_codes: ['0000866']
2026-01-22 11:30:13,943 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'how many containers departed from CNSHA last week', length: 49
2026-01-22 11:30:13,943 - shipping_chatbot - INFO - [DEBUG] q_lower: 'how many containers departed from cnsha last week'
2026-01-22 11:30:16,582 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted: container=None, po=None, obl=None
2026-01-22 11:30:16,583 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted load_port: 'CNSHA'
2026-01-22 11:30:16,587 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Time window: 2026-01-12 00:00:00 to 2026-01-18 00:00:00 (last week)
2026-01-22 11:30:16,736 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Port variants to match: {'SHANGHAI', 'CNSHA'}
2026-01-22 11:30:16,784 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After port filter: 106 rows matched
2026-01-22 11:30:16,785 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Sample matched ports: ['SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)']
2026-01-22 11:30:16,792 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After date filter: 2 rows matched
2026-01-22 11:30:16,809 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Sample filtered results:
      container_number dep_for_filter departure_source
17383      MRSU5742890     2026-01-14              ATD
18696      13105381456     2026-01-16              ATD
2026-01-22 11:30:16,817 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Returning 2 records
2026-01-22 11:32:22,453 - shipping_chatbot - INFO - User_Query: Which containers will arrive in the next 10days at Nashville, c_codes: ['0000866']
2026-01-22 11:32:22,454 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers will arrive in the next 10days at Nashville', length: 60
2026-01-22 11:32:22,455 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers will arrive in the next 10days at nashville'
2026-01-22 11:32:24,978 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 10 days, Dates: 2026-01-22 to 2026-01-31, is_past=False
2026-01-22 11:32:25,193 - shipping_chatbot - INFO - [get_upcoming_arrivals] Extracted 48 known port codes from dataset
2026-01-22 11:32:25,193 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample known codes: ['USBNA', 'USATL', 'USUXE', 'USDFW', 'USHIB', 'USTCN', 'DENSS', 'USCHS', 'USTIW', 'USLGB', 'USCMH', 'USNYC', 'CAYVR', 'USMJB', 'DEHAM', 'USSAV', 'USCVG', 'CNXMN', 'USIAH', 'USDAL']
2026-01-22 11:32:25,194 - shipping_chatbot - INFO - [get_upcoming_arrivals] Checking for port code after preposition in query: 'CONTAINERS ARRIVING AT USBNA IN NEXT 10 DAYS'
2026-01-22 11:32:25,194 - shipping_chatbot - INFO - [get_upcoming_arrivals] prep_code_match found: True
2026-01-22 11:32:25,195 - shipping_chatbot - INFO - [get_upcoming_arrivals] Matched port code: USBNA
2026-01-22 11:32:25,195 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found port code after preposition: USBNA
2026-01-22 11:32:25,195 - shipping_chatbot - INFO - [get_upcoming_arrivals] Is USBNA in known_codes? True
2026-01-22 11:32:25,199 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 112 matches in column 'discharge_port'
2026-01-22 11:32:25,202 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 101 matches in column 'vehicle_arrival_lcn'
2026-01-22 11:32:25,204 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 1548 matches in column 'final_destination'
2026-01-22 11:32:25,206 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 1526 matches in column 'place_of_delivery'
2026-01-22 11:32:25,207 - shipping_chatbot - INFO - [get_upcoming_arrivals]  Successfully detected port code 'USBNA' after preposition. Matched 1715 rows. location_found=True
2026-01-22 11:32:25,207 - shipping_chatbot - INFO - [get_upcoming_arrivals] Applying location filter for 'USBNA'. Rows before filter: 2095, Matching rows: 1715
2026-01-22 11:32:25,212 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample ports after filter: ['SAVANNAH, GA(USSAV)']
2026-01-22 11:32:25,225 - shipping_chatbot - INFO - [get_upcoming_arrivals] Returning 18 containers. Unique discharge ports in result: ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 11:32:25,226 - shipping_chatbot - ERROR - [get_upcoming_arrivals] *** CRITICAL ERROR ***: Multiple ports in result when filtering for 'USBNA': ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 11:32:25,226 - shipping_chatbot - ERROR - [get_upcoming_arrivals] This indicates the port filter was NOT applied correctly!
2026-01-22 11:32:25,226 - shipping_chatbot - ERROR - [get_upcoming_arrivals] location_found=True, location_name=USBNA
2026-01-22 11:32:25,227 - shipping_chatbot - INFO - [get_upcoming_arrivals] Emergency filter applied. Now returning 2 containers from USBNA only.
2026-01-22 11:38:14,263 - shipping_chatbot - INFO - User_Query: Can you please let me know the containers arriving at Nashville in next 5 days, c_codes: ['0000866']
2026-01-22 11:38:14,263 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Can you please let me know the containers arriving at Nashville in next 5 days', length: 78
2026-01-22 11:38:14,263 - shipping_chatbot - INFO - [DEBUG] q_lower: 'can you please let me know the containers arriving at nashville in next 5 days'
2026-01-22 11:38:17,011 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 5 days, Dates: 2026-01-22 to 2026-01-26, is_past=False
2026-01-22 11:38:17,077 - shipping_chatbot - INFO - [get_upcoming_arrivals] Extracted 48 known port codes from dataset
2026-01-22 11:38:17,077 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample known codes: ['USBNA', 'USATL', 'USUXE', 'USDFW', 'USHIB', 'USTCN', 'DENSS', 'USCHS', 'USTIW', 'USLGB', 'USCMH', 'USNYC', 'CAYVR', 'USMJB', 'DEHAM', 'USSAV', 'USCVG', 'CNXMN', 'USIAH', 'USDAL']
2026-01-22 11:38:17,077 - shipping_chatbot - INFO - [get_upcoming_arrivals] Checking for port code after preposition in query: 'CONTAINERS ARRIVING AT USBNA IN NEXT 5 DAYS'
2026-01-22 11:38:17,077 - shipping_chatbot - INFO - [get_upcoming_arrivals] prep_code_match found: True
2026-01-22 11:38:17,077 - shipping_chatbot - INFO - [get_upcoming_arrivals] Matched port code: USBNA
2026-01-22 11:38:17,077 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found port code after preposition: USBNA
2026-01-22 11:38:17,077 - shipping_chatbot - INFO - [get_upcoming_arrivals] Is USBNA in known_codes? True
2026-01-22 11:38:17,077 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 112 matches in column 'discharge_port'
2026-01-22 11:38:17,077 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 101 matches in column 'vehicle_arrival_lcn'
2026-01-22 11:38:17,094 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 1548 matches in column 'final_destination'
2026-01-22 11:38:17,096 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found 1526 matches in column 'place_of_delivery'
2026-01-22 11:38:17,096 - shipping_chatbot - INFO - [get_upcoming_arrivals]  Successfully detected port code 'USBNA' after preposition. Matched 1715 rows. location_found=True
2026-01-22 11:38:17,097 - shipping_chatbot - INFO - [get_upcoming_arrivals] Applying location filter for 'USBNA'. Rows before filter: 2095, Matching rows: 1715
2026-01-22 11:38:17,099 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample ports after filter: ['SAVANNAH, GA(USSAV)']
2026-01-22 11:38:17,106 - shipping_chatbot - INFO - [get_upcoming_arrivals] Returning 8 containers. Unique discharge ports in result: ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 11:38:17,106 - shipping_chatbot - ERROR - [get_upcoming_arrivals] *** CRITICAL ERROR ***: Multiple ports in result when filtering for 'USBNA': ['HONG KONG(HKHKG)', 'LOS ANGELES, CA(USLAX)', 'NASHVILLE, TN(USBNA)']
2026-01-22 11:38:17,106 - shipping_chatbot - ERROR - [get_upcoming_arrivals] This indicates the port filter was NOT applied correctly!
2026-01-22 11:38:17,106 - shipping_chatbot - ERROR - [get_upcoming_arrivals] location_found=True, location_name=USBNA
2026-01-22 11:38:17,107 - shipping_chatbot - INFO - [get_upcoming_arrivals] Emergency filter applied. Now returning 1 containers from USBNA only.
2026-01-22 11:42:26,288 - shipping_chatbot - INFO - User_Query: Can you please let me know the Hot containers arriving at Los Angeles, c_codes: ['0000866']
2026-01-22 11:42:26,288 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Can you please let me know the Hot containers arriving at Los Angeles', length: 69
2026-01-22 11:42:26,288 - shipping_chatbot - INFO - [DEBUG] q_lower: 'can you please let me know the hot containers arriving at los angeles'
2026-01-22 11:42:28,616 - shipping_chatbot - INFO - [get_hot_upcoming_arrivals] Query: hot containers arriving at USLAX
2026-01-22 11:42:28,616 - shipping_chatbot - INFO - [get_hot_upcoming_arrivals] Time window: 2026-01-22 00:00:00..2026-01-28 00:00:00 (next 7 days (default))
2026-01-22 11:42:28,675 - shipping_chatbot - INFO - [get_hot_upcoming_arrivals] Initial dataset: 2095 rows
2026-01-22 11:42:28,675 - shipping_chatbot - INFO - [get_hot_upcoming_arrivals] Location filter: code=USLAX, name=None
2026-01-22 11:42:28,675 - shipping_chatbot - INFO - [get_hot_upcoming_arrivals] After location filter: 1064 rows
2026-01-22 11:42:28,684 - shipping_chatbot - INFO - [get_hot_upcoming_arrivals] After hot_container_flag filter: 346 rows
2026-01-22 11:42:28,687 - shipping_chatbot - INFO - [get_hot_upcoming_arrivals] After date/upcoming filter (start=2026-01-22 00:00:00, end=2026-01-28 00:00:00): 9 rows
2026-01-22 11:42:28,689 - shipping_chatbot - INFO - [get_hot_upcoming_arrivals] Returning 9 hot container records
2026-01-22 11:55:55,545 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 11:55:55,547 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 11:55:55,548 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 13:59:14,781 - shipping_chatbot - INFO - User_Query: Which containers are going to ENFIELD, CT in Oct, c_codes: ['0042485']
2026-01-22 13:59:14,781 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers are going to ENFIELD, CT in Oct', length: 48
2026-01-22 13:59:14,781 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers are going to enfield, ct in oct'
2026-01-22 13:59:14,781 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-22 14:02:44,783 - shipping_chatbot - INFO - Fetched 19114 rows
2026-01-22 14:02:44,791 - shipping_chatbot - INFO - Starting preprocessing on 19114 rows
2026-01-22 14:02:44,953 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-22 14:02:45,979 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-22 14:02:46,246 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-22 14:02:47,218 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-22 14:02:47,218 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-22 14:02:47,218 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-22 14:02:47,275 - shipping_chatbot - INFO - Pre-processing finished - 19114 rows remain
2026-01-22 14:02:50,801 - shipping_chatbot - INFO - [get_containers_by_final_destination] Processing query: containers going to ENFIELD, CT in October 2025
2026-01-22 14:02:50,813 - shipping_chatbot - INFO - [get_containers_by_final_destination] Time window: 2025-10-01 00:00:00 to 2025-10-31 00:00:00 (October 2025)
2026-01-22 14:02:50,930 - shipping_chatbot - INFO - [get_containers_by_final_destination] Initial dataset: 650 rows
2026-01-22 14:02:50,932 - shipping_chatbot - INFO - [get_containers_by_final_destination] Using eta_fd column only
2026-01-22 14:02:50,934 - shipping_chatbot - INFO - [get_containers_by_final_destination] Extracted FD location: 'ENFIELD', code: 'None'
2026-01-22 14:02:50,947 - shipping_chatbot - INFO - [get_containers_by_final_destination] Exact name match: 0 matches
2026-01-22 14:02:50,958 - shipping_chatbot - INFO - [get_containers_by_final_destination] Word-based match: 546 matches
2026-01-22 14:02:50,966 - shipping_chatbot - INFO - [get_containers_by_final_destination] Found 546 containers after FD filter
2026-01-22 14:02:50,974 - shipping_chatbot - INFO - [get_containers_by_final_destination] Found 38 containers after date filter (using eta_fd only)
2026-01-22 14:02:50,979 - shipping_chatbot - INFO - [get_containers_by_final_destination] Returning 38 containers
2026-01-22 14:16:26,085 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 14:16:26,085 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 14:16:26,085 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 14:16:58,963 - shipping_chatbot - INFO - User_Query: Which containers are going to ENFIELD, CT in Oct, c_codes: ['0042485']
2026-01-22 14:16:58,966 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers are going to ENFIELD, CT in Oct', length: 48
2026-01-22 14:16:58,966 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers are going to enfield, ct in oct'
2026-01-22 14:16:58,966 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-22 14:21:26,170 - shipping_chatbot - INFO - Fetched 19114 rows
2026-01-22 14:21:26,170 - shipping_chatbot - INFO - Starting preprocessing on 19114 rows
2026-01-22 14:21:26,289 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-22 14:21:26,967 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-22 14:21:27,203 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-22 14:21:28,021 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-22 14:21:28,023 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-22 14:21:28,025 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-22 14:21:28,069 - shipping_chatbot - INFO - Pre-processing finished - 19114 rows remain
2026-01-22 14:21:31,701 - shipping_chatbot - INFO - [get_containers_by_final_destination] Processing query: containers going to ENFIELD, CT in October 2025
2026-01-22 14:21:31,703 - shipping_chatbot - INFO - [get_containers_by_final_destination] Time window: 2025-10-01 00:00:00 to 2025-10-31 00:00:00 (October 2025)
2026-01-22 14:21:31,818 - shipping_chatbot - INFO - [get_containers_by_final_destination] Initial dataset: 650 rows
2026-01-22 14:21:31,818 - shipping_chatbot - INFO - [get_containers_by_final_destination] Using eta_fd column only
2026-01-22 14:21:31,833 - shipping_chatbot - INFO - [get_containers_by_final_destination] Extracted FD location: 'ENFIELD', code: 'None'
2026-01-22 14:21:31,835 - shipping_chatbot - INFO - [get_containers_by_final_destination] Exact name match: 0 matches
2026-01-22 14:21:31,844 - shipping_chatbot - INFO - [get_containers_by_final_destination] Word-based match: 546 matches
2026-01-22 14:21:31,852 - shipping_chatbot - INFO - [get_containers_by_final_destination] Found 546 containers after FD filter
2026-01-22 14:21:31,859 - shipping_chatbot - INFO - [get_containers_by_final_destination] Found 38 containers after date filter (using eta_fd only)
2026-01-22 14:21:31,862 - shipping_chatbot - INFO - [get_containers_by_final_destination] Returning 38 containers
2026-01-22 14:22:01,175 - shipping_chatbot - INFO - User_Query: Which containers are going to ENFIELD, CT in Oct, c_codes: ['0042485']
2026-01-22 14:22:01,175 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers are going to ENFIELD, CT in Oct', length: 48
2026-01-22 14:22:01,177 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers are going to enfield, ct in oct'
2026-01-22 14:22:04,572 - shipping_chatbot - INFO - [get_containers_by_final_destination] Processing query: containers arriving at ENFIELD, CT in October 2025
2026-01-22 14:22:04,574 - shipping_chatbot - INFO - [get_containers_by_final_destination] Time window: 2025-10-01 00:00:00 to 2025-10-31 00:00:00 (October 2025)
2026-01-22 14:22:04,709 - shipping_chatbot - INFO - [get_containers_by_final_destination] Initial dataset: 650 rows
2026-01-22 14:22:04,709 - shipping_chatbot - INFO - [get_containers_by_final_destination] Using eta_fd column only
2026-01-22 14:22:04,709 - shipping_chatbot - INFO - [get_containers_by_final_destination] Extracted FD location: 'ENFIELD', code: 'None'
2026-01-22 14:22:04,726 - shipping_chatbot - INFO - [get_containers_by_final_destination] Exact name match: 0 matches
2026-01-22 14:22:04,736 - shipping_chatbot - INFO - [get_containers_by_final_destination] Word-based match: 546 matches
2026-01-22 14:22:04,743 - shipping_chatbot - INFO - [get_containers_by_final_destination] Found 546 containers after FD filter
2026-01-22 14:22:04,749 - shipping_chatbot - INFO - [get_containers_by_final_destination] Found 38 containers after date filter (using eta_fd only)
2026-01-22 14:22:04,751 - shipping_chatbot - INFO - [get_containers_by_final_destination] Returning 38 containers
2026-01-22 14:29:21,446 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 14:29:21,446 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 14:29:21,446 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 14:29:26,696 - shipping_chatbot - INFO - User_Query: Which containers are going to ENFIELD, CT in Oct, c_codes: ['0042485']
2026-01-22 14:29:26,700 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers are going to ENFIELD, CT in Oct', length: 48
2026-01-22 14:29:26,700 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers are going to enfield, ct in oct'
2026-01-22 14:29:26,700 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-22 14:33:25,498 - shipping_chatbot - INFO - Fetched 19114 rows
2026-01-22 14:33:25,502 - shipping_chatbot - INFO - Starting preprocessing on 19114 rows
2026-01-22 14:33:25,718 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-22 14:33:27,002 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-22 14:33:27,387 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-22 14:33:28,115 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-22 14:33:28,131 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-22 14:33:28,132 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-22 14:33:28,163 - shipping_chatbot - INFO - Pre-processing finished - 19114 rows remain
2026-01-22 14:33:31,102 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: Oct 2026, Dates: 2026-10-01 to 2026-10-31, is_past=False
2026-01-22 14:33:31,248 - shipping_chatbot - INFO - [get_upcoming_arrivals] Found city location: ENFIELD (normalized: ENFIELD)
2026-01-22 14:33:31,250 - shipping_chatbot - INFO - [get_upcoming_arrivals] Applying location filter for 'ENFIELD'. Rows before filter: 650, Matching rows: 546
2026-01-22 14:33:31,250 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample ports after filter: ['NEW YORK, NY(USNYC)', 'NEWARK, NJ(USEWR)']
2026-01-22 14:43:29,785 - shipping_chatbot - INFO - User_Query: Which containers arrived to ENFIELD, CT in Oct, c_codes: ['0042485']
2026-01-22 14:43:29,785 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers arrived to ENFIELD, CT in Oct', length: 46
2026-01-22 14:43:29,785 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers arrived to enfield, ct in oct'
2026-01-22 14:43:33,393 - shipping_chatbot - INFO - [get_arrivals_by_port] Period: Oct 2025, Dates: 2025-10-01 to 2025-10-31
2026-01-22 14:44:00,313 - shipping_chatbot - INFO - User_Query: Which containers arrived to ENFIELD, CT in Oct, c_codes: ['0042485']
2026-01-22 14:44:00,313 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers arrived to ENFIELD, CT in Oct', length: 46
2026-01-22 14:44:00,313 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers arrived to enfield, ct in oct'
2026-01-22 14:44:03,012 - shipping_chatbot - INFO - [get_arrivals_by_port] Period: Oct 2025, Dates: 2025-10-01 to 2025-10-31
2026-01-22 14:44:32,812 - shipping_chatbot - INFO - User_Query: Which containers arrived to ENFIELD, CT in Oct, c_codes: ['0042485']
2026-01-22 14:44:32,812 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers arrived to ENFIELD, CT in Oct', length: 46
2026-01-22 14:44:32,813 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers arrived to enfield, ct in oct'
2026-01-22 14:44:35,788 - shipping_chatbot - INFO - [get_arrivals_by_port] Period: Oct 2025, Dates: 2025-10-01 to 2025-10-31
2026-01-22 14:46:37,330 - shipping_chatbot - INFO - User_Query: Which containers have ETD in next 7 days, c_codes: ['0000866']
2026-01-22 14:46:37,332 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers have ETD in next 7 days', length: 40
2026-01-22 14:46:37,332 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers have etd in next 7 days'
2026-01-22 14:46:40,261 - shipping_chatbot - INFO - [get_containers_by_etd_window] Processing query: containers with ETD in next 7 days
2026-01-22 14:46:40,263 - shipping_chatbot - INFO - [get_containers_by_etd_window] Parsed time window: 2026-01-22 00:00:00 to 2026-01-28 00:00:00 (next 7 days)
2026-01-22 14:46:40,378 - shipping_chatbot - INFO - [get_containers_by_etd_window] Initial dataset size: 2095 rows
2026-01-22 14:46:40,387 - shipping_chatbot - INFO - [get_containers_by_etd_window] Port extraction: code=None, name=None
2026-01-22 15:06:27,772 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 15:06:27,773 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 15:06:27,773 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 15:10:36,742 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 15:10:36,742 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 15:10:36,742 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 15:15:52,858 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 15:15:52,859 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 15:15:52,859 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 15:20:39,171 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 15:20:39,171 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 15:20:39,171 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 15:45:10,005 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 15:45:10,005 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 15:45:10,005 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 15:47:17,214 - shipping_chatbot - INFO - User_Query: Which containers have ETD in the next 7 days?, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-22 15:47:17,214 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers have ETD in the next 7 days?', length: 45
2026-01-22 15:47:17,214 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers have etd in the next 7 days?'
2026-01-22 15:47:17,214 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-22 15:48:07,794 - shipping_chatbot - INFO - Fetched 19183 rows
2026-01-22 15:48:07,797 - shipping_chatbot - INFO - Starting preprocessing on 19183 rows
2026-01-22 15:48:07,898 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-22 15:48:08,413 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-22 15:48:08,587 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-22 15:48:09,134 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-22 15:48:09,134 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-22 15:48:09,134 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-22 15:48:09,167 - shipping_chatbot - INFO - Pre-processing finished - 19183 rows remain
2026-01-22 15:48:12,045 - shipping_chatbot - INFO - [get_containers_by_etd_window] Processing query: containers with ETD in the next 7 days
2026-01-22 15:48:12,045 - shipping_chatbot - INFO - [get_containers_by_etd_window] Parsed time window: 2026-01-22 00:00:00 to 2026-01-28 00:00:00 (next 7 days)
2026-01-22 15:48:12,115 - shipping_chatbot - INFO - [get_containers_by_etd_window] Initial dataset size: 12699 rows
2026-01-22 15:48:12,115 - shipping_chatbot - INFO - [get_containers_by_etd_window] Port extraction: code=None, name=THE
2026-01-22 15:48:12,157 - shipping_chatbot - INFO - [get_containers_by_etd_window] After port filter: 0 rows matched
2026-01-22 15:48:13,127 - shipping_chatbot - INFO - [get_containers_by_etd_window] Processing query: containers with ETD in the next 7 days
2026-01-22 15:48:13,128 - shipping_chatbot - INFO - [get_containers_by_etd_window] Parsed time window: 2026-01-22 00:00:00 to 2026-01-28 00:00:00 (next 7 days)
2026-01-22 15:48:13,196 - shipping_chatbot - INFO - [get_containers_by_etd_window] Initial dataset size: 12699 rows
2026-01-22 15:48:13,196 - shipping_chatbot - INFO - [get_containers_by_etd_window] Port extraction: code=None, name=THE
2026-01-22 15:48:13,234 - shipping_chatbot - INFO - [get_containers_by_etd_window] After port filter: 0 rows matched
2026-01-22 15:48:14,195 - shipping_chatbot - INFO - [get_containers_by_etd_window] Processing query: containers with ETD in the next 7 days
2026-01-22 15:48:14,195 - shipping_chatbot - INFO - [get_containers_by_etd_window] Parsed time window: 2026-01-22 00:00:00 to 2026-01-28 00:00:00 (next 7 days)
2026-01-22 15:48:14,265 - shipping_chatbot - INFO - [get_containers_by_etd_window] Initial dataset size: 12699 rows
2026-01-22 15:48:14,265 - shipping_chatbot - INFO - [get_containers_by_etd_window] Port extraction: code=None, name=THE
2026-01-22 15:48:14,305 - shipping_chatbot - INFO - [get_containers_by_etd_window] After port filter: 0 rows matched
2026-01-22 15:48:38,464 - shipping_chatbot - INFO - User_Query: Which containers have ETD in next 7 days?, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-22 15:48:38,464 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers have ETD in next 7 days?', length: 41
2026-01-22 15:48:38,464 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers have etd in next 7 days?'
2026-01-22 15:48:41,062 - shipping_chatbot - INFO - [get_containers_by_etd_window] Processing query: containers with ETD in next 7 days
2026-01-22 15:48:41,062 - shipping_chatbot - INFO - [get_containers_by_etd_window] Parsed time window: 2026-01-22 00:00:00 to 2026-01-28 00:00:00 (next 7 days)
2026-01-22 15:48:41,136 - shipping_chatbot - INFO - [get_containers_by_etd_window] Initial dataset size: 12699 rows
2026-01-22 15:48:41,153 - shipping_chatbot - INFO - [get_containers_by_etd_window] Port extraction: code=None, name=None
2026-01-22 15:53:10,525 - shipping_chatbot - INFO - User_Query: how many containers departed from CNSHA day before yesterday?, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-22 15:53:10,525 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'how many containers departed from CNSHA day before yesterday?', length: 61
2026-01-22 15:53:10,525 - shipping_chatbot - INFO - [DEBUG] q_lower: 'how many containers departed from cnsha day before yesterday?'
2026-01-22 15:53:13,193 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted: container=None, po=None, obl=None
2026-01-22 15:53:13,194 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Extracted load_port: 'CNSHA'
2026-01-22 15:53:13,195 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Time window: 2026-01-20 00:00:00 to 2026-01-20 00:00:00 (day before yesterday)
2026-01-22 15:53:13,299 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Port variants to match: {'CNSHA', 'SHANGHAI'}
2026-01-22 15:53:13,353 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After port filter: 783 rows matched
2026-01-22 15:53:13,353 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Sample matched ports: ['SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)', 'SHANGHAI(CNSHA)']
2026-01-22 15:53:13,353 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] After date filter: 5 rows matched
2026-01-22 15:53:13,364 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Sample filtered results:
      container_number dep_for_filter departure_source
17988      KOCU5257132     2026-01-20              ATD
18545      CSNU2536395     2026-01-20              ATD
18548      CSLU2226113     2026-01-20              ATD
18634      HAMU1559889     2026-01-20              ATD
18635      FCIU7615671     2026-01-20              ATD
2026-01-22 15:53:13,366 - shipping_chatbot - INFO - [get_containers_departed_from_load_port] Returning 5 records
2026-01-22 15:55:07,901 - shipping_chatbot - INFO - User_Query: Which containers have ETD in the next 7 days?, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-22 15:55:07,902 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers have ETD in the next 7 days?', length: 45
2026-01-22 15:55:07,902 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers have etd in the next 7 days?'
2026-01-22 15:55:10,430 - shipping_chatbot - INFO - [get_containers_by_etd_window] Processing query: containers with ETD in the next 7 days
2026-01-22 15:55:10,430 - shipping_chatbot - INFO - [get_containers_by_etd_window] Parsed time window: 2026-01-22 00:00:00 to 2026-01-28 00:00:00 (next 7 days)
2026-01-22 15:55:10,507 - shipping_chatbot - INFO - [get_containers_by_etd_window] Initial dataset size: 12699 rows
2026-01-22 15:55:10,507 - shipping_chatbot - INFO - [get_containers_by_etd_window] Port extraction: code=None, name=THE
2026-01-22 15:55:10,556 - shipping_chatbot - INFO - [get_containers_by_etd_window] After port filter: 0 rows matched
2026-01-22 15:56:19,536 - shipping_chatbot - INFO - User_Query: Which containers have ETD in next 7 days?, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-22 15:56:19,536 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers have ETD in next 7 days?', length: 41
2026-01-22 15:56:19,536 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers have etd in next 7 days?'
2026-01-22 15:56:22,342 - shipping_chatbot - INFO - [get_containers_by_etd_window] Processing query: containers with ETD in next 7 days
2026-01-22 15:56:22,346 - shipping_chatbot - INFO - [get_containers_by_etd_window] Parsed time window: 2026-01-22 00:00:00 to 2026-01-28 00:00:00 (next 7 days)
2026-01-22 15:56:22,438 - shipping_chatbot - INFO - [get_containers_by_etd_window] Initial dataset size: 12699 rows
2026-01-22 15:56:22,441 - shipping_chatbot - INFO - [get_containers_by_etd_window] Port extraction: code=None, name=None
2026-01-22 15:58:49,518 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 15:58:49,518 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 15:58:49,518 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 15:58:54,843 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 15:58:54,843 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 15:58:54,843 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 15:59:05,616 - shipping_chatbot - INFO - User_Query: Which containers have ETD in next 7 days?, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-22 15:59:05,616 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers have ETD in next 7 days?', length: 41
2026-01-22 15:59:05,616 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers have etd in next 7 days?'
2026-01-22 15:59:05,616 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-22 15:59:21,786 - shipping_chatbot - INFO - Fetched 19183 rows
2026-01-22 15:59:21,786 - shipping_chatbot - INFO - Starting preprocessing on 19183 rows
2026-01-22 15:59:21,908 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-22 15:59:22,579 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-22 15:59:22,788 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-22 15:59:23,452 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-22 15:59:23,452 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-22 15:59:23,452 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-22 15:59:23,494 - shipping_chatbot - INFO - Pre-processing finished - 19183 rows remain
2026-01-22 15:59:26,167 - shipping_chatbot - INFO - [get_containers_by_etd_window] Processing query: containers with ETD in next 7 days
2026-01-22 15:59:26,169 - shipping_chatbot - INFO - [get_containers_by_etd_window] Parsed time window: 2026-01-22 00:00:00 to 2026-01-28 00:00:00 (next 7 days)
2026-01-22 15:59:26,235 - shipping_chatbot - INFO - [get_containers_by_etd_window] Initial dataset size: 12699 rows
2026-01-22 15:59:26,235 - shipping_chatbot - INFO - [get_containers_by_etd_window] Port extraction: code=None, name=None
2026-01-22 15:59:52,523 - shipping_chatbot - INFO - User_Query: Which containers have ETD in the next 7 days?, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-22 15:59:52,524 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'Which containers have ETD in the next 7 days?', length: 45
2026-01-22 15:59:52,524 - shipping_chatbot - INFO - [DEBUG] q_lower: 'which containers have etd in the next 7 days?'
2026-01-22 15:59:55,542 - shipping_chatbot - INFO - [get_containers_by_etd_window] Processing query: containers with ETD in next 7 days
2026-01-22 15:59:55,542 - shipping_chatbot - INFO - [get_containers_by_etd_window] Parsed time window: 2026-01-22 00:00:00 to 2026-01-28 00:00:00 (next 7 days)
2026-01-22 15:59:55,612 - shipping_chatbot - INFO - [get_containers_by_etd_window] Initial dataset size: 12699 rows
2026-01-22 15:59:55,612 - shipping_chatbot - INFO - [get_containers_by_etd_window] Port extraction: code=None, name=None
2026-01-22 16:08:27,054 - shipping_chatbot - INFO - User_Query: What shipments are scheduled for this week?, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-22 16:08:27,054 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'What shipments are scheduled for this week?', length: 43
2026-01-22 16:08:27,054 - shipping_chatbot - INFO - [DEBUG] q_lower: 'what shipments are scheduled for this week?'
2026-01-22 16:08:29,787 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: next 7 days, Dates: 2026-01-22 to 2026-01-28, is_past=False
2026-01-22 16:08:29,905 - shipping_chatbot - INFO - [get_upcoming_arrivals] Extracted 171 known port codes from dataset
2026-01-22 16:08:29,905 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample known codes: ['JPOSA', 'CHZRH', 'SEGOT', 'IDJKT', 'USIAH', 'CNBJS', 'USLGB', 'DKCPH', 'DELGG', 'JPSTM', 'NLRTM', 'FRLEH', 'USLUI', 'USOAK', 'GBLGP', 'BEANR', 'DEWVN', 'CZPRG', 'THBKK', 'USMJB']
2026-01-22 16:08:29,905 - shipping_chatbot - INFO - [get_upcoming_arrivals] Checking for port code after preposition in query: 'CONTAINERS ARRIVING IN NEXT 7 DAYS'
2026-01-22 16:08:29,905 - shipping_chatbot - INFO - [get_upcoming_arrivals] prep_code_match found: False
2026-01-22 16:24:47,610 - shipping_chatbot - INFO - User_Query: What shipments are scheduled for this week?, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-22 16:24:47,611 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'What shipments are scheduled for this week?', length: 43
2026-01-22 16:24:47,611 - shipping_chatbot - INFO - [DEBUG] q_lower: 'what shipments are scheduled for this week?'
2026-01-22 16:24:52,409 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Extracted: container=None, po=None, obl=None, is_booking_query=False
2026-01-22 16:24:52,409 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Extracted load_port: 'None'
2026-01-22 16:24:52,409 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Time window: 2026-01-22 00:00:00 to 2026-01-28 00:00:00 (next 7 days), is_booking_query=False
2026-01-22 16:24:52,489 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] After _df() consignee filter: 12699 rows
2026-01-22 16:24:52,490 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Thread consignee codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-22 16:24:52,510 - shipping_chatbot - INFO - [get_containers_departing_from_load_port] Returning 177 records (is_booking_query=False)
2026-01-22 16:31:28,826 - shipping_chatbot - INFO - AzureChatOpenAI ready
2026-01-22 16:31:28,826 - shipping_chatbot - INFO - Agent created with 54 tools
2026-01-22 16:31:28,826 - shipping_chatbot - INFO - Agent ready for HTTP requests
2026-01-22 16:32:38,874 - shipping_chatbot - INFO - User_Query: What shipments are scheduled for this week?, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-22 16:32:38,874 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'What shipments are scheduled for this week?', length: 43
2026-01-22 16:32:38,874 - shipping_chatbot - INFO - [DEBUG] q_lower: 'what shipments are scheduled for this week?'
2026-01-22 16:32:38,874 - shipping_chatbot - INFO - Downloading shipment CSV from Azure Blob Storage
2026-01-22 16:33:06,059 - shipping_chatbot - INFO - Fetched 19183 rows
2026-01-22 16:33:06,069 - shipping_chatbot - INFO - Starting preprocessing on 19183 rows
2026-01-22 16:33:06,236 - shipping_chatbot - INFO - Removed 0 duplicate rows
2026-01-22 16:33:06,885 - shipping_chatbot - INFO - Converted 31 date columns to datetime format
2026-01-22 16:33:07,185 - shipping_chatbot - INFO - Normalized 6 'multiple' columns
2026-01-22 16:33:08,118 - shipping_chatbot - INFO - Added `delay_days` column with FIXED logic
2026-01-22 16:33:08,124 - shipping_chatbot - INFO - Added `actual_transit_days` column
2026-01-22 16:33:08,124 - shipping_chatbot - INFO - Added `estimated_transit_days` column
2026-01-22 16:33:08,178 - shipping_chatbot - INFO - Pre-processing finished - 19183 rows remain
2026-01-22 16:33:11,468 - shipping_chatbot - INFO - [get_upcoming_arrivals] Period: this week, Dates: 2026-01-19 to 2026-01-25, is_past=False
2026-01-22 16:33:11,613 - shipping_chatbot - INFO - [get_upcoming_arrivals] Extracted 171 known port codes from dataset
2026-01-22 16:33:11,613 - shipping_chatbot - INFO - [get_upcoming_arrivals] Sample known codes: ['USCHI', 'USTCN', 'CNXMG', 'USMSY', 'CNNGB', 'KRPUS', 'SEMMA', 'GBSOU', 'CAYYZ', 'CNLFZ', 'JPNRT', 'KRICN', 'USWOS', 'SEGOT', 'VNSGN', 'CNXAM', 'GBGRG', 'CAVAN', 'USCMH', 'GBFXT']
2026-01-22 16:33:11,613 - shipping_chatbot - INFO - [get_upcoming_arrivals] Checking for port code after preposition in query: 'CONTAINERS SCHEDULED FOR THIS WEEK'
2026-01-22 16:33:11,615 - shipping_chatbot - INFO - [get_upcoming_arrivals] prep_code_match found: False
2026-01-22 16:34:16,902 - shipping_chatbot - INFO - User_Query: What containers are delayed by 4 days?, c_codes: ['0000866', '0001363', '0001389', '0001540', '0001615', '0001660', '0001665', '0002565', '0002566', '0002569', '0002679', '0002907', '0002990', '0003235', '0003427', '0003717', '0003905', '0004932', '0004991', '0005052', '0005053', '0005056', '0005171', '0005172', '0005176', '0005177', '0005178', '0005179', '0005180', '0006360', '0006804', '0008579', '0008756', '0009633', '0012041', '0013505', '0015526', '0021103', '0021472', '0023453', '0025833', '0027113', '0028662', '0028664', '0029594', '0030961', '0030962', '0033522', '0033523', '0037359', '0037360', '0037361', '0037364', '0046854', '0047055', '0047302', '0047650', '0048392']
2026-01-22 16:34:16,902 - shipping_chatbot - INFO - [DEBUG] Received question type: <class 'str'>, value: 'What containers are delayed by 4 days?', length: 38
2026-01-22 16:34:16,903 - shipping_chatbot - INFO - [DEBUG] q_lower: 'what containers are delayed by 4 days?'
2026-01-22 16:34:19,539 - shipping_chatbot - INFO - [get_delayed_containers] Query: 'delayed by 4 days', consignee_code: None
